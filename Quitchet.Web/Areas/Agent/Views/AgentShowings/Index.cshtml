@*AgentShowings/  Agent Showings Index*@
@{
    Layout = "~/Views/Shared/_Layout_Customer.cshtml";
    ViewBag.Title = "Index";
}
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">
<!-- Latest compiled and minified JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>
<link href="~/AgentStyles/AgentStyles.css" rel="stylesheet" />
<link href="~/AgentStyles/AgentShowingsStyles.css" rel="stylesheet" />
  <style>
    .buyer1 {
        background: #ebbcab;
    }

    .dropclass {
        top: -12px !important;
        width: 371px !important;
    }
    /*date picker styles*/

    .ui-datepicker-header {
        text-transform: uppercase !important;
        background-color: transparent;
        color: #ff5d26;
        font-weight: normal;
        border: none !important;
        font-size: 15px;
        font-weight: bold;
        /*-webkit-box-shadow: inset 0px 1px 1px 0px rgba(250, 250, 250, 2);
                    -moz-box-shadow: inset 0px 1px 1px 0px rgba(250, 250, 250, .2);
                    box-shadow: inset 0px 1px 1px 0px rgba(250, 250, 250, .2);
                    text-shadow: 1px -1px 0px #000;
                    filter: dropshadow(color=#000, offx=1, offy=-1);
                    line-height: 30px;*/
    }

    .ui-datepicker table {
        color: gray !important;
    }

    .ui-datepicker-prev, .ui-datepicker-next {
        display: inline-block;
        width: 30px;
        height: 30px;
        text-align: center;
        cursor: pointer;
        /*background-image: url('../img/arrow.png');*/
        background-repeat: no-repeat;
        line-height: 600%;
        overflow: hidden;
    }

    .ui-datepicker tbody td:last-child {
        border-right: 0px;
    }

    .ui-state-default, .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default, .ui-button, html .ui-button.ui-state-disabled:hover, html .ui-button.ui-state-disabled:active {
        border: none !important;
    }

    .ui-datepicker tbody tr:last-child {
        border-bottom: 0px;
    }

    .ui-state-default, .ui-widget-content .ui-state-default {
        background: none !important;
        text-align: center;
    }

    .ui-state-active, .ui-widget-content .ui-state-active, .ui-widget-header .ui-state-active, a.ui-button:active, .ui-button:active, .ui-button.ui-state-active:hover {
        background-color: #ff5d26 !important;
    }
    /*End ::after *date picjer styles*/

    /*Tooltip css*/
    .tooltiptailred:before {
        content: "";
        position: absolute;
        right: 36%;
        bottom: 20px;
        width: 0;
        height: 0;
        border-right: 13px solid transparent;
        border-bottom: 13px solid red;
        border-left: 13px solid transparent;
    }

    .tooltiptailgreen:before {
        content: "";
        position: absolute;
        right: 36%;
        bottom: 20px;
        width: 0;
        height: 0;
        border-right: 13px solid transparent;
        border-bottom: 13px solid green;
        border-left: 13px solid transparent;
    }

    .highlightbackground {
        background-color: #f9d3c6 !important;
    }

    .displaynone {
        display: none;
    }

    .btndisble {
        /*cursor: not-allowed;*/
        /*pointer-events: none;*/
        background-color: gray;
        color: #fff;
    }

    .btnenable {
        cursor: pointer;
        pointer-events: auto;
        background-color: #ff5d26;
        color: #fff;
    }

    .ui-widget-content {
        /*border: 1px solid #bdc3c7;
            background: #e1e1e1;*/
        /*height:4px;*/
        color: #222222;
        margin-top: 4px;
    }

    .ui-slider .ui-slider-handle {
        top: -5px;
        position: absolute !important;
        z-index: 2 !important;
        width: 1.5em !important;
        height: 1.5em !important;
        cursor: default !important;
        text-align: center !important;
        line-height: 30px !important;
        color: #FFFFFF !important;
        border-radius: 10px;
    }

    .ui-corner-all {
        /*border-radius: 20px;*/
    }
    
    .ui-state-default,
    .ui-widget-content .ui-state-default {
        background: #ff5d26 !important;
        border: 2px solid #fff !important;
    }


    .ui-slider .ui-slider-handle {
        cursor: pointer;
    }


    .ui-slider-range-min {
        background: #ff5d26;
    }
    /****** jQuery Autocomplete CSS *************/
    .ui-autocomplete-input {
        z-index: 5000 !important;
    }


    .ui-menu {
        border: 1px solid lightgray;
        font-family: 'Inder', sans-serif;
        font-size: 15px;
    }

        .ui-menu .ui-menu-item a {
            color: gray;
        }

        .ui-menu .ui-menu-item:hover {
            display: block;
            text-decoration: none;
            color: #fff;
            cursor: pointer;
            background-color: #ff5d26;
            border: 1px solid lightgray;
        }

    .ui-autocomplete {
        position: absolute;
    }

    /****** jQuery Autocomplete CSS END*************/
    .modal {
        overflow: auto !important;
    }

    .labels {
        text-align: center;
        font-weight: bold;
        font-size: 15px;
        color: #fff;
    }

    [type="checkbox"]:not(:checked) + label,
    [type="checkbox"]:checked + label {
        position: relative;
        padding-left: 0.5em;
        top: -6px;
        cursor: pointer;
    }

    .commentsdiv {
        background-color: rgba(255, 87, 34, 0.14);
        color: #ff5722f2;
    }

    .editdivclass {
        background-color: #ff5d26;
        color: #fff;
    }
    /* style glyph */
    .inner-addon .glyphicon {
        position: absolute;
        padding: 6px;
        color: gray;
        pointer-events: none;
    }

    /* align glyph */
    .right-addon .glyphicon {
        right: 0px;
    }

    /* add padding  */
    .right-addon input {
        padding-right: 30px;
    }
     input[type='radio']:after {
        width: 17px;
        height: 17px;
        border-radius: 15px;
        top: -2px;
        left: -1px;
        position: relative;
        background-color: #d1d3d1;
        content: '';
        display: inline-block;
        visibility: visible;
        border: 2px solid white;
    }

    input[type='radio']:checked:after {
        /*width: 10px;
        height: 10px;*/
        border-radius: 54px;
        /*top: 1px!important;
        left: 1px;*/
        position: relative;
        background-color: #f56331;
        content: '';
        display: inline-block;
        visibility: visible;
        border: 3px solid #e5e8e5;
    }
    /*input[type='radio'] {
        -webkit-appearance: none;
        width: 15px;
        height: 15px;
        border-radius: 50%;
        outline: none;
        border: 1px solid gray;
    }

    input[type='radio']:before {
        content: '';
        display: block;
        width: 60%;
        height: 60%;
        margin: 20% auto;
        border-radius: 50%;
    }

 input[type="radio"]:checked:before {
        background: #ff5d26;
        
    }
    
    input[type="radio"]:checked {
      border-color:#ff5d26;
    }*/
    /*For feedback nav pills*/
        .nav-tabs{
        text-align: center;
    }
  .textonpopup {
  display: block;
  width: 160px;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}
</style>

@*Showings Header*@
<div class="col-sm-12" style="background-color:#484848;padding:10px">
    <div class="col-sm-3"><a href="/Agent/MyQuitchet/Index" class="btn btn-default btn-sm backbtninHeader_orange">Back</a></div>
    <div class="col-sm-5" style="text-align:center"><label style="font-size:16px;color:#fff;">Showings</label></div>
    <div class="col-sm-4"></div>
</div>
@*Tabs Menu Div*@
<div class="col-sm-12" style="padding:0">
    <div class="col-sm-9" style="background-color:darkgray;padding:0">
        <div class="col-sm-12" id="exTab3" style="border-bottom:none;background-color:darkgray;">
            <ul class="nav nav-pills">
                <li class="" id="tab1">
                    <a href="#1b" data-toggle="tab" id="Requestedtab_btn" onclick="getAgentBuyers('Requested')">
                        <img src="/img/Union_1190@2x.png" class="iconsin_Tab" />
                        Requested
                    </a>
                </li>
                <li id="tab2">
                    <a href="#2b" data-toggle="tab" id="Pendingtab_btn" onclick="getAgentBuyers('Pending')">
                        <img src="/img/pendingicon_showingsdashboard_2.png" class="iconsin_Tab" />
                        Pending
                    </a>
                </li>
                <li class="" id="tab3">
                    <a href="#3b" data-toggle="tab" id="Scheduledtab_btn" onclick="getAgentBuyers('Scheduled')">
                        <img src="/img/ScheduleShowings_menu_icon@2x.png" class="iconsin_Tab" />
                        Scheduled
                    </a>
                </li>
                <li class="" id="tab4">
                    <a href="#4b" data-toggle="tab" id="Completedtab_btn" onclick="getAgentBuyers('Completed')">
                        <img src="/img/compare_Homes.png" class="iconsin_Tab" />
                        Completed
                    </a>
                </li>

            </ul>
        </div>

    </div>
    <div class="col-sm-3" style="background-color:#ff5d26;color:#fff;padding:11px;font-size:17px;padding-left: 20px !important;">
        Select a buyer
    </div>
</div>
@*Data Div elements for Listings and Buyers*@
<div class="col-sm-12" style="padding:0">
    <div class="col-sm-9 scrolls_divs" style="padding:0;height:73vh;border-right:1px solid lightgray;overflow:auto;background-color:#fff" id="Tab_Listings_Data_Div">
        <div class="col-sm-12" style="padding:0">
            <div class="col-sm-12" id="buyerdivinlistings" style="padding:0px;border-bottom:1px solid #fff">

            </div>
        </div>
    </div>
    <div class="col-sm-3 scrolls_divs" style="height:73vh;overflow:auto;padding:0;background-color:#fff" id="BuyersList_Div">

    </div>
</div>
@* Phone Call Popup*@
<div class="modal fade" id="PhoneCallModel" style="padding-left: 206px; z-index: 1500;">
    <div class="modal-dialog" role="document" style="padding-top: 15%; width: 25%">
        <div class="modal-content">
            <div class="modal-header" style="text-align: center; border-bottom: none; padding-bottom: 0px;">
                <h5 style="color: #FF6937; margin-top: -2%; font-weight: 600;">Phone Call</h5>
                <img src="~/img/phone_icon_brand-1.png" />&nbsp; <span id="span_name_phonecall" style="font-size: 12px; color: black; font-weight: bold; margin-top: 0px">Phone Call</span>
                <hr style="border: 0 ! important; margin-top: 2%; margin-bottom: 5%; border-top: 1px solid  #FF6937 !important;" />
            </div>
            <div class="col-sm-12">
                <div class="col-sm-6">
                    <img style="margin-right: 1px;" src="~/img/mb.png" />&nbsp;  <span style="font-size: 11px; color: #FF6937;">Mobile</span>
                </div>
                <div class="col-sm-6">
                    <span id="customer_phone_label" style="font-size: 11px;">987654321</span>
                </div>
            </div>

            <div class="col-sm-12">&nbsp;</div>
            <div class="col-sm-12">
                <hr style="margin-bottom: 2%; margin-top: 2%;" />
            </div>
            <div class="modal-footer">
                <div class="col-sm-12" style="text-align: center">
                    <a href="#" class="btn" id="phonecall_popup_cancel" data-dismiss="modal" style="border-radius: 5px !important; background-color: gray; color: white; font-weight: 500; font-size: 11px;">Cancel</a>
                </div>
            </div>
        </div>
    </div>
</div>
@*Shcedule showing popup design *@
<div class="modal fade" id="ScheduleShowings_Popup" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header" style="background-color:#ff5d26;color:#fff;text-align:center;border-radius: 4px 4px 0px 0px;padding:10px">
                <img src="~/img/close_Popup_icon.png" data-dismiss="modal" style="float:right;cursor:pointer" id="close_SchedulePopup"/>
                <label class="modal-title" style="font-size:18px">Schedule Showings</label>
            </div>
            <div class="modal-body" style="">
                <div class="col-sm-12" style="padding-bottom:10px;border-bottom:2px solid #ff5d26">
                    <div class="col-sm-1" style="line-height:45px"><img src="/img/addphotopic.png" class="" style="border-radius:50px;height:50px;width:50px" id="buyerPhoto_schedulePopup"></div>
                    <div class="col-sm-9" style="top:5px">
                        <table>
                            <tr><td><label class="labelorange" style="font-weight:bold">Buyer</label></td></tr>
                            <tr><td><label style="font-weight:bold;font-size:14px;" id="buyerName_schedulePopup">Sam Broyles</label></td></tr>
                        </table>
                    </div>
                    <div class="col-sm-1" style="line-height:50px">
                        <img src="~/img/phoneicon_mycustomer.png" id="call_schedulePopup" style="cursor:pointer;" class="call" />
                    </div>
                    <div class="col-sm-1" style="line-height:50px">
                        <img src="~/img/messages_icon.png" id="chat_schedulePopup" style="cursor:pointer;" class="chat" />
                    </div>
                </div>
                <div class="col-sm-12" style="">&nbsp;</div>
                <div class="col-sm-12" style="padding:14px;background-color:#fccab9;border-radius:5px">
                    <div class="col-sm-7" style="">
                        <select class="selectpicker form-control" id="requestedDateTime"></select>
                    </div>
                    <div class="col-sm-1" style="width:4%;text-align:center;">
                        <label style="margin-top:10px;margin-left: -23px;">Or</label>
                    </div>
                    <div class="col-sm-4" style="padding:0;width:37%">
                        <button class="form-control btn-sm backbtninHeader_orange" id="chooseCustomDateBtn" data-toggle="modal" data-target="#ChooseDateTimePopup">
                            Choose Custom Date and Time
                        </button>
                        <div class='input-group' id='selecteddatediv' style="display:none;">
                            <input type="text" class="form-control" id="choosenDate" style="background-color: #fb7f55;border:0;color:#fff" readonly />
                            <span class="input-group-addon" style="padding:0;background-color:#fb7f55;border:0">
                                <button class="form-control btn-xs" data-toggle="modal" data-target="#ChooseDateTimePopup" style="width: 60px;background-color: #ff5d26;border: 0;border-radius: 0px 5px 5px 0;color: #fff;font-size: 16px;">Edit</button>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="col-sm-12" style="padding:5px;background-color:#ece9e9;border-radius:5px;margin-top:3px;">
                    <div class="col-sm-12" style="text-align:center;margin-top: 7px;">
                        <label class="labelorange" style="font-size:15px;font-weight:bold">Select a dwell time for each showing.</label>&nbsp;
                        <label style="font-size:14px;font-weight:bold;color:gray">05 - 60 Minutes</label>
                    </div>
                    <div class="col-sm-1" style="">&nbsp;</div>
                    <div class="col-sm-10" style="text-align:center;margin-top:7px">
                        <div class="col-sm-12" style="">
                            <div id="slider">
                            </div>
                            <label id="dewelltimeval" hidden="hidden"></label>
                        </div>
                    </div>

                    <div class="col-sm-1" style="">&nbsp;</div>
                </div>
                <div class="col-sm-12">
                    <hr style="border-top:2px solid #ff5d26" />
                </div>
                <div class="col-sm-12">
                    <span style="font-size:15px">Search MLS# or Address</span>
                </div>
                <div class="col-sm-12" style="padding-right: 20px;margin-top:10px">
                    <label id="errorMessageforMLSID" style="color:red"></label>
                    <div class='input-group' id='selecteddatediv' style="">
                        <input type="text" class="form-control" id="search_MLSID_Address" placeholder="MLS# or Address" />
                        <span class="input-group-addon" style="padding:0;background-color:#fb7f55;border:0">
                            <button class="form-control btn-xs" id="AddMLSIDBtn_SchedulePopup"
                                    style="width: 70px;background-color: #ff5d26;border: 0;border-radius: 0px 5px 5px 0;color: #fff;font-size: 16px;">
                                @*<i class="fa fa-plus-circle" style="color:#fb7f55;"></i>*@
                                <img src="~/img/plus_circle_icon.png" style="margin-bottom:3px" /> &nbsp;Add
                            </button>
                        </span>
                    </div>
                </div>
                <div class="col-sm-12">&nbsp;</div>
                <div class="col-sm-12">
                    <label class="labelorange" style="font-size:18px">Listings to be shown:</label>
                </div>
                <div class="col-sm-12 scrolls_divs" style="max-height:22vh;overflow:auto;border-radius:5px;border-color:#ff5d26;margin-top:2px" id="SchedulePopup_Listingsdiv">
                    @*<div class="col-sm-12" style="padding:0 0 0 0;margin-top:10px" id="1">
                            <div class="col-sm-10" id="" style="padding:0;border:1px solid #ff5d26;border-radius:5px;height:52px;box-shadow: #d6d3d3 1px 4px 9px 2px;">
                                <div class="col-sm-2" style="height:50px;width:100px;line-height:15px;border-radius: 4px 0 0 4px;background: url(../../../../img/picture001.png); background-size: 100% 100%;"></div>'
                                <div class="col-sm-8" style="line-height:2">
                                    <table>
                                        <tr><td style="padding-left:10px;color:gray">MLS#123456789</td></tr>

                                        <tr><td style="padding-left:10px;color:gray">10 Braeburn Drive, Greenville,Sc 20369</td></tr>
                                    </table>
                                </div>
                            </div>
                            <div class="col-sm-1" style="border-radius:5px;border:1px solid #ff5d26;height:52px;text-align: center;margin-left: 10px;width: 15%;box-shadow: #d6d3d3 1px 4px 9px 2px;">
                                <div class="col-sm-12" style="padding:15px;">
                                    <a href="#" onclick="removeListing(1)" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListingPopup" data-toggle="modal">Remove</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12" style="padding:0 0 0 0;margin-top:10px">
                            <div class="col-sm-10" id="" style="padding:0;border:1px solid #ff5d26;border-radius:5px;height:52px;box-shadow: #d6d3d3 1px 4px 9px 2px;">
                                <div class="col-sm-2" style="height:50px;width:100px;line-height:15px;border-radius: 4px 0 0 4px;background: url(../../../../img/picture001.png); background-size: 100% 100%;"></div>'
                                <div class="col-sm-8" style="line-height:2">
                                    <table>
                                        <tr><td style="padding-left:10px;color:gray">MLS#123456789</td></tr>

                                        <tr><td style="padding-left:10px;color:gray">10 Braeburn Drive, Greenville,Sc 20369</td></tr>
                                    </table>
                                </div>
                            </div>
                            <div class="col-sm-1" style="border-radius:5px;border:1px solid #ff5d26;height:52px;text-align: center;margin-left: 10px;width: 15%;box-shadow: #d6d3d3 1px 4px 9px 2px;">
                                <div class="col-sm-12" style="padding:15px;">
                                    <a href="#" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListingPopup" data-toggle="modal">Remove</a>
                                </div>
                            </div>
                        </div>*@
                </div>
                <div class="col-sm-12" style="">
                    <hr style="border-top:2px solid gray" />
                </div>
            </div>
            <div class="modal-footer">
                <div class="col-sm-6" style="text-align:left">
                    <button type="button" class="btn btngray" data-dismiss="modal">Cancel</button>
                </div>
                <div class="col-sm-6" style="">
                    <button type="button" class="btn btndisble" id="SaveContinueBtn_ScheduledPopup" disabled="disabled" @*data-target="#ScheduledSuccessPopup" data-toggle="modal"*@>Save & Continue</button>
                </div>

            </div>
        </div>
    </div>
</div>
@*Cofirm Map showing popup design *@
<div class="modal fade" id="Confirm_MapShowingPopup" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header" style="background-color:#ff5d26;color:#fff;text-align:center;border-radius: 4px 4px 0px 0px;padding:10px">
                <img src="~/img/close_Popup_icon.png" data-dismiss="modal" style="float:right;cursor:pointer" />
                <label class="modal-title" style="font-size:18px">Confirm and Map Showing</label>
            </div>
            <div class="modal-body">
                <div class="col-sm-6">
                    <div class="col-sm-12" style="padding:5px;border-bottom:2px solid gray">
                        <div class="col-sm-2" style="line-height:45px"><img id="buyerPhoto_ConfirmPopup" src="/img/addphotopic.png" class="" style="border-radius:50px;height:50px;width:50px"></div>
                        <div class="col-sm-6" style="line-height:50px">
                            <label style="font-weight:bold;font-size:14px;padding-left:10px" id="buyerName_ConfirmPopup">Sam Broyles</label>
                        </div>
                        <div class="col-sm-2" style="line-height:50px">
                            <img src="~/img/phoneicon_mycustomer.png" id="call_ConfirmPopup" class="call" style="cursor:pointer;" />
                        </div>
                        <div class="col-sm-2" style="line-height:50px">
                            <img src="~/img/messages_icon.png" id="chat_ConfirmPopup" class="chat" style="cursor:pointer;" />
                        </div>
                    </div>
                    <div class="col-sm-12" style="margin-top:20px">
                        &nbsp;
                    </div>
                    <div class="col-sm-12" style="margin-top:20px">
                        <div class="col-sm-9">
                            <label class="labelorange" style="font-size:15px;font-weight:bold">Select the first listing to be shown.</label>

                        </div>
                        <div class="col-sm-3">
                            <label>Start Time</label>
                        </div>
                    </div>

                    <div class="col-sm-12" style="padding-left:5px;">
                        <div class="col-sm-9 destdiv"  id="dummydiv" style="background-image:url(/img/slector_dragger.png);background-position:left;background-repeat: no-repeat;border:1px solid gray;height:52px;border-radius:5px">
                            @*<i class="fa fa-long-arrow-up" style="float:left;line-height:2;margin-left: 10px;font-size:22px;"></i> <p>Select a listing below</p>*@
                        </div>
                        <div class="col-sm-9 destdiv" id="destination_div" style="display:none;padding:0;background-color:#fff;height:52px;border-radius:5px">
                            <div class="col-sm-1" style="cursor:pointer;line-height:45px;text-align:center;padding:0"><label style="color:#fff;cursor:pointer;"><span class="badge" style="font-size:18px;border-radius:15px;padding:6px 11px;background-color:#ff5d26;color:#fff">1</span></label></div>
                            <div class="col-sm-11" id="" style="height:52px;padding-right:0">
                                <div class="col-sm-2" id="firstListingPhoto_ConfirmPopup" style="height:52px;width:70px;line-height:15px;background: url(../../../../img/NoImage.png); background-size: 100% 100%;"></div>
                                <div class="col-sm-8" style="height:52px;color:gray;border:1px solid #ff5d26;width:70%;border-radius:0 5px 5px 0">
                                    <div id="firstMLSID_ConfirmPopup" style="margin-top:5px">MLS#13456789</div>
                                    <div id="firstAddress_ConfirmPopup" style="margin-top: 5px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">10 Braeburn Drive, Greenville,Sc 20369</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3 destdiv" id="starttime_div" style="height:50px;border-radius:5px;padding-right:0">
                            <div style="background-color:#f5cec1;text-align:center;border-radius:5px 5px 0px 0px">
                                <img src="~/img/watchh.png" style="margin-bottom:0" />
                            </div>
                            <div style="background-color:#ff5d26;text-align:center;color:#fff;border-radius:0px 0px 5px 5px">
                                <span id="time">
                                    <span id="fromtime_ConfirmPopup">10.00</span>
                                    <br /><span id="timeformat_ConfirmPopup">AM</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12" style="margin-top:20px">
                        &nbsp;
                    </div>
                    <div class="col-sm-12 scrolls_divs sourcediv" id="sourcelistings" style="height:30vh;overflow-y:auto;overflow-x:hidden; padding:0;">

                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="col-sm-12" style="padding:0px;height:450px;border:1px solid gray;border-radius:5px">
                        <div class="col-sm-12" style="background-color:#646464;text-align:center">
                            <label class="labelorange">Showings for:</label>
                            <label class="labelwhite" id="scheduled_date_ConfirmPopup">Monday, Dec. 20</label>
                        </div>
                        <div class="col-sm-12" style="background-color:#ff5d26;text-align:center">
                            <label class="labelwhite">Dwell time is set for <span id="dewelltime_ConfirmPopup"></span> minutes</label>
                        </div>
                        <div class="col-sm-12" id="map_in_popup" style="height:405px;padding:0"></div>
                    </div>
                </div>
                <div class="col-sm-12">
                    <hr style="border-top:2px solid #ff5d26" />
                </div>
            </div>
            <div class="modal-footer">
                <div class="col-sm-6" style="text-align:left">
                    <button type="button" class="btn prev_btn" id="PreviusBtn_ConfirmPopup">Previous</button>
                </div>
                <div class="col-sm-6" style="">
                    <div class="col-sm-6" style="">
                        <button type="button" class="btn btndisble" disabled="disabled" style="width:100%;" id="save_exit_btn_ConfirmPopup">Save & Exit</button>
                    </div>
                    <div class="col-sm-6" style="">
                        <button type="button" class="btn btndisble" disabled="disabled" style="width:100%;" id="create_route_btn_ConfirmPopup">Create Route</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
@*Routing and Schedule Popup*@
<div class="modal fade" id="RoutingPopup" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header" style="background-color:#ff5d26;color:#fff;text-align:center;border-radius: 4px 4px 0px 0px;padding:10px">
                <img src="~/img/close_Popup_icon.png" data-dismiss="modal" style="float:right;cursor:pointer" />
                <label class="modal-title" style="font-size:18px">Schedule Showings</label>
            </div>
            <div class="modal-body">
                <div class="col-sm-6">
                    <div class="col-sm-12" style="padding:5px;border-bottom:2px solid gray">
                        <div class="col-sm-2" style="line-height:45px"><img id="buyerPhoto_RoutingPopup" src="/img/addphotopic.png" class="" style="border-radius:50px;height:50px;width:50px"></div>
                        <div class="col-sm-6" style="line-height:50px">
                            <label style="font-weight:bold;font-size:14px;padding-left:10px" id="buyerName_RoutingPopup">ABC</label>
                        </div>
                        <div class="col-sm-2" style="line-height:50px">
                            <img src="~/img/phoneicon_mycustomer.png" id="call_RoutingPopup" class="call" style="cursor:pointer;" />
                        </div>
                        <div class="col-sm-2" style="line-height:50px">
                            <img src="~/img/messages_icon.png" id="chat_RoutingPopup" class="chat" style="cursor:pointer;" />
                        </div>
                    </div>
                    <div class="col-sm-12 scrolls_divs" style="margin-top:20px;padding:0;overflow:auto;max-height:50vh" id="RoutedListings_div">
                        <div class="col-sm-12" style="text-align:right;font-weight:bold">
                            <label class="labelorange">Routed Arrival Time:</label>
                            <span style="margin-left:10px;">10.00 AM</span>
                        </div>
                        <div clas="col-sm-12">
                            <div class="col-sm-1" style="line-height:50px;text-align:center">
                                <span class="badge" style="font-size:18px;border-radius:15px;padding:6px 11px;background-color:#ff5d26;color:#fff">1</span>
                            </div>
                            <div class="col-sm-11">
                                <div class="col-sm-2" style="height:53px;width:80px;line-height:15px;border-radius: 4px 0 0 4px;background: url('/img/NoImage.png'); background-size: 100% 100%;">

                                </div>
                                <div class="col-sm-9" style="border:1px solid #ff5d26;border-radius: 0 4px 4px 0;">
                                    <table>
                                        <tr><td style="color:gray">MLS#123456789</td></tr>
                                        <tr><td style="color:gray">116 Gascony Drive Greenville, SC 29609</td></tr>
                                    </table>
                                </div>
                                <div class="col-sm-3" style="display:none;border:1px solid #ff5d26;line-height: 50px;text-align: center;border-radius: 0 4px 4px 0;cursor:pointer">
                                    <a href="#" onclick="removeListing('2')" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListingPopup" data-toggle="modal">Remove</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-1">&nbsp;</div>
                        <div class="col-sm-10" style="background-color:lightgray;font-weight:bold;margin-left:15px;border-radius: 0 0 5px 5px;height: 25px;padding-top:3px">
                            Set Appointment time for:&nbsp;&nbsp;<img src="~/img/watchh.png" style="margin-bottom:0" />&nbsp;<label id="fromtime_RoutingPopup" style="font-weight:bold">10.00 AM</label>
                            &nbsp;<lable class="labelorange">to</lable>&nbsp;<label id="totime_RoutingPopup" style="font-weight:bold">10.35 AM</label>
                        </div>
                        <div class="col-sm-12" style="text-align:center;padding:10px">
                            <input type="checkbox" class="orange" style="height:20px;width:30px;" /><label>Call Made</label>&nbsp;&nbsp;
                            <input type="checkbox" class="orange" style="height:20px;width:30px;" /><label>Confirm</label>
                        </div>
                        <div class="col-sm-1">&nbsp;</div>
                        <div class="col-sm-10" style="background-color:#ff5d26;color:#fff;font-size:15px;margin-left:15px;border-radius: 5px;height: 30px;padding-top:5px;text-align:center;cursor:pointer">
                            Shedule this Showing
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="col-sm-12" style="padding:0px;height:450px;border:1px solid gray;border-radius:5px">
                        <div class="col-sm-12" style="background-color:#646464;text-align:center">
                            <label class="labelorange">Showigns for:</label>
                            <label class="labelwhite" id="scheduled_date_RoutingPopup">Day, MM Date Year</label>
                        </div>
                        <div class="col-sm-12" style="background-color:#ff5d26;text-align:center">
                            <label class="labelwhite">Dwell time is set for <span id="dewelltime_RoutingPopup"></span> minutes</label>
                        </div>
                        <div class="col-sm-12" id="map_in_RoutingPopup" style="height:405px;padding:0"></div>
                    </div>
                </div>
                <div class="col-sm-12">
                    <hr style="border-top:2px solid #ff5d26" />
                </div>
            </div>
            <div class="modal-footer">
                <div class="col-sm-6" style="text-align:left">
                    <button type="button" class="btn prev_btn" id="PreviusBtn_RoutingPopupp">Previous</button>
                </div>
                <div class="col-sm-6" style="">
                    <div class="col-sm-6" style="">
                        <button type="button" class="btn btnenable" style="width:100%;" id="save_exit_btn_RoutingPopup" onclick="Save_Exit_Notify('save_exit')">Save & Exit</button>
                    </div>
                    <div class="col-sm-6" style="">
                        <button type="button" class="btn btndisble" disabled="disabled" style="width:100%;" id="create_route_btn_RoutingPopup" onclick="Save_Exit_Notify('save_notify')">Save & Notify Client</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
@*Choose Date time popup*@
<div class="modal fade" id="ChooseDateTimePopup" tabindex="-1" role="dialog" aria-labelledby="MessageLabel" aria-hidden="true" style="padding-left: 206px">
    <div class="modal-dialog" role="document" style="padding-top: 10%; width: 27%">
        <div class="modal-content">
            <div class="modal-header" style="text-align: center;color:#ff6937;height:45px;padding-top:13px;padding-left:10px!important;padding-right:10px!important">
                <label id="" style="font-weight:bold;font-size:18px!important">
                    Custom Date & Time
                </label>
                <hr style="color:#f89d7f;border: 1px solid;margin-top:5px;margin-bottom:10px" />
            </div>
            <div class="col-sm-12">&nbsp;</div>
            <div class="modal-body" style="padding-bottom:5px!important;padding-top:5px!important">
                <div class="col-md-12" style="text-align: center;padding-top:10px!important">
                    <form class="form-horizontal">
                        <div class="col-sm-12" style="text-align:center;display:none" id="date_ErrorMsg_div">
                            <label id="validationerrorMessage" class="form-control" style="background-color:rgb(249, 210, 196);color:#ff5d36;font-size:10px">
                                Please Select First Date
                            </label>
                        </div>
                        <div class="col-xs-4">
                            <label for="inputEmail" class="control-label">Select Date</label>
                            <label id="dataErrorMsg" style="color:red"></label>
                        </div>
                        <div class="col-xs-8" style="padding-right:0">

                            <div class="inner-addon right-addon">
                                <i class="glyphicon glyphicon-calendar" style="right: 8px;top:4px"></i>
                                @*<input type="text" placeholder="/      /" required id="customdate" class="form-control" style="position: relative; border-color:rgba(0,0,0,0.3) !important;">*@
                                @Html.TextBox("customdate", "", new { @class = "form-control", style = "cursor-color:#ff5d26;rgba(0,0,0,0.3) !important;", placeholder = "  /      / " })
                            </div>
                            @*<input type="text" placeholder="/      /" required id="customdate" class="form-control" style="position: relative; border-color:rgba(0,0,0,0.3) !important;">
                            <span class="input-group-addon" id="date11icon" style="top: -34px; right: -150px;width:10px; position: relative;border-color:rgba(0,0,0,0.3) !important;height:34px">
                                <span class="glyphicon glyphicon-calendar">
                                </span>
                            </span>*@
                        </div>
                        <div class="form-group">
                            <div class="col-sm-12" style="position:relative;top:5px;" id="timings22">
                                <div class="col-xs-4">
                                    <label for="inputEmail" class="control-label">From</label>
                                </div>
                                <div class="col-xs-8" style="padding-right:0">
                                    <div class="col-xs-5" style="padding:0;width:39%">

                                        @*<input id="txt_SecondFirst_From" type="text" class="form-control" data-toggle="collapse" data-target="#TimePicker7" onclick="OpenTimepicker('TimePicker7','txt_SecondFirst_From')" style=" border-color:rgba(0,0,0,0.3) !important; height:26px; font-size:11px" value="ANY" readonly /><i class="fa fa-caret-down" aria-hidden="true" style="left: 98px; font-size: 17px; position: relative;"></i>*@
                                        <button class="form-control btn btn-xs" id="fromtimebtn" style="border: 1px solid lightgray;text-align: left;" data-toggle="collapse" data-target="#TimePicker1" onclick="OpenTimepicker('TimePicker1', 'fromtimebtn')">
                                            <span id="customFromTime">12:00 PM</span>  <i class="fa fa-caret-down" style="float:right;margin-top:5px"></i>
                                        </button>
                                        <div id="TimePicker1" class="collapse" style="width:92px; background-color:white; position:absolute;box-shadow: 4px 5px 8px 0px rgba(0,0,0,0.2);border-radius:5px;padding:0px 0px 0px 0px;z-index:1048;">
                                        </div>
                                    </div>
                                    <div class="col-xs-2" style="left:-5px;top:6px">
                                        <span style="top: -3px;position:relative;">to</span>
                                    </div>
                                    <div class="col-xs-5" style="padding:0">
                                        @*<input id="txt_SecondSecond_to" type="text" class="form-control" data-toggle="collapse" data-target="#TimePicker8" onclick="OpenTimepicker('TimePicker8','txt_SecondSecond_to')" style="left: 100px; top: -5px; width: 85px; position: relative; float: right; border-radius:6px; border-color:rgba(0,0,0,0.3) !important; height:26px; font-size:11px" value="ANY" readonly /><i class="fa fa-caret-down" aria-hidden="true" style="left: 185px; font-size: 17px; position: relative;"></i>*@
                                        <button class="form-control btn btn-xs" id="totimebtn" style="border: 1px solid lightgray;text-align: left;" data-toggle="collapse" data-target="#TimePicker2" onclick="OpenTimepicker('TimePicker2', 'totimebtn')">
                                            <span id="customToTime">12:00 PM</span>  <i class="fa fa-caret-down" style="float:right;margin-top:5px"></i>
                                        </button>
                                        <div id="TimePicker2" class="collapse" style="width:92px; background-color:white; position:absolute;box-shadow: 4px 5px 8px 0px rgba(0,0,0,0.2);border-radius:5px;padding:0px 0px 0px 0px;z-index:1048;">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12"><hr style="color:#f89d7f;border: 1px solid;margin-top:5px;margin-bottom:10px" /></div>
                        <div class="col-sm-12">
                            <button type="button" class="btn btn-sm" data-dismiss="modal" id="btnNotRemoveAgent" style="width:75px;float:left;border: 1px solid#fff;background-color: gray; color: white;">Cancel</button>
                            <button type="button" id="SaveDateBtn" disabled class="btn btn-sm" style="width:75px;float:right;border: 1px solid#fff;background-color: #FF6937; color: white;">Save</button>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>
</div>
@* REmove Listing popup in Shedule Popup*@
<div class="modal fade" id="RemoveListingPopup" tabindex="-1" role="dialog" aria-labelledby="MessageLabel" aria-hidden="true" style="padding-left: 206px">
    <div class="modal-dialog" role="document" style="padding-top: 10%; width: 26%">
        <div class="modal-content">
            <div class="modal-header" style="text-align: center;color:#ff6937;height:45px;padding-top:13px;padding-left:10px!important;padding-right:10px!important">
                <label id="" style="font-weight:bold;font-size:18px!important">
                    <b>Remove Listing?</b>
                </label>
                <hr style="color:#ff6937;border: 1px solid;margin-top:5px;margin-bottom:10px" />
            </div>
            <div class="col-sm-12">&nbsp;</div>
            <div class="modal-body" style="padding-bottom:5px!important;padding-top:5px!important">
                <div class="col-md-12" style="text-align: center;padding-top:10px!important">
                    <label id="" style="word-wrap: break-word;font-size:14px;">
                        Are you sure want to remove <b id="removinglistingaddress"></b> from<br />
                        the showings schedule?
                    </label>
                </div>

                <div class="col-sm-12">&nbsp;</div>
                <div class="modal-footer">
                    <div class="col-sm-1"></div>
                    <div class="col-sm-10">
                        <div class="btn-group btn-group-sm" style="width:100%">
                            <button type="button" class="mypopupbtncls btn" data-dismiss="modal" id="btnNotRemoveAgent" style="width:50%;border-radius: 5px 0px 0px 5px;border: 1px solid#fff;background-color: gray; color: white;font-size: 15px;">No</button>
                            <button type="button" id="RemoveListingYesBtn" class="mypopupbtncls btn" style="width:50%;border: 1px solid#fff;border-radius: 0px 5px 5px 0px;background-color: #FF6937; color: white;font-size: 15px;">Yes</button>
                        </div>
                    </div>
                    <div class="col-sm-1"></div>
                </div>
            </div>
        </div>
    </div>
</div>
@* REmove Listing popup in Routing Popup*@
<div class="modal fade" id="RemoveListing_RoutingPopup" tabindex="-1" role="dialog" aria-labelledby="MessageLabel" aria-hidden="true" style="padding-left: 206px">
    <div class="modal-dialog" role="document" style="padding-top: 10%; width: 26%">
        <div class="modal-content">
            <div class="modal-header" style="text-align: center;color:#ff6937;height:45px;padding-top:13px;padding-left:10px!important;padding-right:10px!important">
                <label id="" style="font-weight:bold;font-size:18px!important">
                    <b>Remove Listing?</b>
                </label>
                <hr style="color:#ff6937;border: 1px solid;margin-top:5px;margin-bottom:10px" />
            </div>
            <div class="col-sm-12">&nbsp;</div>
            <div class="modal-body" style="padding-bottom:5px!important;padding-top:5px!important">
                <div class="col-md-12" style="text-align: center;padding-top:10px!important">
                    <label id="" style="word-wrap: break-word;font-size:14px;">
                        Are you sure want to remove {insert address} from<br />
                        the showings schedule?
                    </label>
                </div>

                <div class="col-sm-12">&nbsp;</div>
                <div class="modal-footer">
                    <div class="col-sm-1"></div>
                    <div class="col-sm-10">
                        <div class="btn-group btn-group-sm" style="width:100%">
                            <button type="button" class="mypopupbtncls btn" data-dismiss="modal" id="btnNotRemoveAgent" style="width:50%;border-radius: 5px 0px 0px 5px;border: 1px solid#fff;background-color: gray; color: white;font-size: 15px;">No</button>
                            <button type="button" id="RemoveListingYesBtn_RoutingPopup" class="mypopupbtncls btn" style="width:50%;border: 1px solid#fff;border-radius: 0px 5px 5px 0px;background-color: #FF6937; color: white;font-size: 15px;">Yes</button>
                        </div>
                    </div>
                    <div class="col-sm-1"></div>
                </div>
            </div>
        </div>
    </div>
</div>
@*Success scheduled Sent Alert Popup*@
<div class="modal fade" id="ScheduledSuccessPopup" tabindex="-1" role="dialog" aria-labelledby="MessageLabel" aria-hidden="true" style="padding-left: 206px">
    <div class="modal-dialog" role="document" style="padding-top: 10%; width: 26%">
        <div class="modal-content">
            <div class="modal-header" style="text-align: center;color:#ff6937;height:45px;padding-top:13px;padding-left:10px!important;padding-right:10px!important">
                <label id="" style="font-weight:bold;font-size:18px!important">

                    <img src="~/img/ScheduleShowings_menu_icon.png" />&nbsp;<b>Sent</b>
                </label>
                <hr style="color:#ff6937;border: 1px solid;margin-top:5px;margin-bottom:10px" />
            </div>
            <div class="col-sm-12">&nbsp;</div>
            <div class="modal-body" style="padding-bottom:5px!important;padding-top:5px!important">
                <div class="col-md-12" style="text-align: center;padding-top:10px!important">
                    <label id="" style="word-wrap: break-word;font-size:14px;">
                        Your showing schedule has been saved,<br />
                        and your buyer will notified!
                    </label>
                </div>
                <div class="col-sm-12">&nbsp;</div>
                <div class="modal-footer">
                    <div class="col-sm-3"></div>
                    <div class="col-sm-6">
                        <button type="button" id="DenyUserRequestbtn" data-dismiss="modal" class="form-control btn" style="border: 1px solid#fff;background-color: #FF6937; color: white;font-size: 15px;">OK</button>
                    </div>
                    <div class="col-sm-3"></div>
                </div>
            </div>
        </div>
    </div>
</div>
@*Shcedule showing popup design *@
<div class="modal fade" id="ShowingScheduleInstructions_Popup" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="width:65%;left:16%;margin-top:15%">
            <div class="modal-header" style="text-align:center;border-radius: 4px 4px 0px 0px;padding:15px;">
                @*<button type="button" class="close" data-dismiss="modal">&times;</button>*@
                <label class="modal-title" style="font-size:18px;color:#ff5d26;font-weight:bold">Showing Schedule Instructions</label>

            </div>
            <div class="modal-body" style="padding-top:0">
                <hr style="border-top:1px solid #ff5d26;margin-top:0" />
                <div class="col-sm-12">
                    <div class="col-sm-3" id="listing_image_in_Instructions" style="background: url(/img/NoImage.png); background-size: 100% 100%;background-repeat: no-repeat;height:100px;"></div>
                    <div class="col-sm-5" style="top:25px">
                        <div class="col-sm-12" style="padding:0"><label id="listingAddress_in_Instructions" style="font-size:16px;font-weight:bold">126 Wayward Lane</label></div>
                        <div class="col-sm-12" style="padding:0"><label id="mlsid_in_Instructions" style="font-size:14px">MLS#123456789</label></div>
                    </div>
                    <div class="col-sm-4" style="top:25px;padding:0">
                        <div class="col-sm-12" style="background-color:#ff5d26;color:#fff;border-radius:5px 5px 0px 0px;text-align:center">
                            Set Appointment for
                        </div>
                        <div class="col-sm-12" style="background-color:#fac3b1;text-align:center;line-height:35px">

                            <img src="~/img/watchh.png" style="margin-bottom:0" /> <span id="listing_setappointment_fromtime"></span>&nbsp;to&nbsp;<span id="listing_setappointment_totime"></span>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12">
                    <hr style="border-top:1px solid #4f4949;" />
                </div>
                <div class="col-sm-3">
                </div>
                <div class="col-sm-9">
                    <label class="labelorange" style="font-size:18px">Contact Instructions:</label>
                </div>
                <div class="col-sm-4">
                </div>
                <div class="col-sm-8">
                    <label class="" style="font-size:18px" id="instructions">Call Listing Office</label>
                </div>
                <div class="col-sm-3">
                </div>
                <div class="col-sm-6" style="border-bottom:1px solid #ff5d26">
                    <label class="labelorange" style="font-size:18px">Phone Number:</label>
                </div>
                <div class="col-sm-4">
                </div>
                <div class="col-sm-8" style="margin-top:10px">
                    <label class="" style="font-size:18px" id="whomtocontact">(888) 800- 1234</label>
                </div>
                <div class="col-sm-12">
                    <hr style="border-top:1px solid #ff5d26;" />
                </div>
            </div>
            <div class="modal-footer">
                <div class="col-sm-12" style="text-align:center">
                    <button type="button" class="btn btnorange" id="OK_ScheduledInctructions_Popup" style="width:50%" data-target="#ShowingScheduleInstructions_Popup" data-toggle="modal">Ok</button>
                </div>

            </div>
        </div>
    </div>
</div>
@*------------Feedback Popup of AGent to Post and View Byer and his Feedback------------------------*@
<div class="modal fade" id="AgentPost_Feedback_Popup" style="z-index:1500;height:100%; ">
    <div class="modal-dialog" role="document" style="padding-top: 2%; width: 30%; height:640px; border-radius:5px !important;">
        <div class="modal-content" style="border-radius:5px !important; height:650px; width:115%">
            <div class="modal-header" style="text-align: center;border-bottom: none;padding-bottom: 0px;height: 46px;">
                <img src="/img/close_orange.png" class="close" data-dismiss="modal" style="opacity:2"/>
                <label class="modal-title" style="font-size:18px;color:#ff5d26;">Showing Feedback</label>
            </div>
            <div class="modal-body" style="height:520px;">
                <div class="col-sm-12" style="text-align:center;padding-bottom:10px;font-size:12px;border-bottom:1px solid #ff5d26;display:none" id="buyer_date_div">
                    <span style="color:#FF6937">Feedback Received: </span><span id="Buyer_feedback_date">Wednesday 1/30/2017</span> <span id="Buyer_feedback_time"></span>
                </div>
                <div class="col-sm-12" style="text-align:center;padding-bottom:10px;font-size:12px;border-bottom:1px solid #ff5d26" id="agent_date_div">
                    <span style="color:#FF6937">Feedback Received: </span><span id="Agent_feedback_date">Wednesday 1/30/2017</span> <span id="Agent_feedback_time"></span>
                </div>
                <div class="row col-sm-12" style="text-align:center;font-size:12px;padding:10px">
                    <div class="col-sm-1">&nbsp;</div>
                    <div class="col-sm-5">
                        <img id="FB_Popup_Image" src="~/img/NoImage.png" height="87" width="140" />
                    </div>
                    <div class="col-sm-5" style="position:relative;text-align:left;display:table;line-height: 2.5;">
                        @*<span style="vertical-align:middle;display:table-cell">*@
                            <div class="col-sm-12 " style="padding:0"><span id="FB_Popup_AddressLineOne" class="textonpopup" style="font-weight:bold;font-size:15px;">10 Braeburn Drive</span></div>
                            <div class="col-sm-12" style="padding:0"><span id="FB_Popup_AddressLineTwo" style="font-size:13px; line-height:1;">Simpsonville SC, 29681</span></div>
                            <div class="col-sm-12" style="padding:0">#MLS<span id="FB_Popup_MLSID" style="font-size:12px; font-weight:normal; color:grey;"></span></div>
                            <span id="hidden_requestshowing_Id" style="display:none"></span>
                        @*</span>*@
                    </div>
                    <div class="col-sm-1">&nbsp;</div>
                </div>
                <div class="contactdiv" style="background-color:#fff !important; border-bottom:1px solid #ff5d26">
                    <ul class="nav nav-tabs">
                        <li class="" id="buyer_feedback_tab">
                            <a href="#buyer_view_feedback_tab" data-toggle="tab" id="buyer_feedback_a" style="width:150px;border: 1px solid lightgray;border-radius: 5px 0px 0px 0px !important;text-decoration:none;font-weight:bold;background-color:#fff;color:black">
                                Buyer Feedback
                            </a>
                        </li>
                        <li style="margin-left:-6px;" id="agent_feedback_tab">
                            <a href="#agent_feedback_div" data-toggle="tab" id="agent_feedback_a" style="width:150px;border: 1px solid lightgray;border-radius: 0px 5px 0px 0px !important;text-decoration:none;color:#fff;font-weight:bold;background-color:#FF6937">
                                Agent Feedback
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="tab-content" id="tabs">
                    <div class="tab-pane" id="buyer_view_feedback_tab" style="margin-top:10px">
                        <div id="buyers_feedback_div_data" style="padding:11px">
                            <div class="col-sm-12 scrolls_divs" id="div_inPOPup0" style="font-size: 14px; position: relative;  min-height:315px; max-height:315px; overflow-y:auto">
                                <div class="col-sm-12" style="text-align:center;font-weight: bold;">
                                    What are your general observations / comments on this home?
                                </div>
                                <div class="col-sm-12" id="buyercomments_div">
                                    <div id="Buyer_Comments" class="col-sm-10 scrolls_divs" style="width:86%;overflow-x: hidden;overflow-y: auto;font-size:12px;text-overflow: ellipsis;margin-top:10px;border:1px solid #ff572299; border-radius: 5px 0 0 5px;max-height:50px;min-height:50px;text-align: center;  position: relative;">
                                        @*<span style="font-size: 11px; position: relative;" id="View_comment">*@
                                        We really like the fenced backyard and updated kitchen. We wish the master bath had more updates.

                                        @*</span>*@
                                    </div>
                                    <div class="col-sm-2" style="line-height:24px;color:#ff5d26;padding:0;width:14%;float:right;margin-top:10px;border:1px solid #ff572299;border-radius:0px 5px 5px 0;height:50px">
                                        <div class="col-sm-12" id="editDiv" style="border-bottom:1px solid #ff572299;cursor:pointer;" onclick="editComments()">Edit</div>
                                        <div class="col-sm-12" id="saveDiv" style="pointer-events:none;cursor:pointer;padding:0px;text-align:center" onclick="saveComments()">Save</div>
                                    </div>
                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="padding-top:5px;">
                                    <div>
                                        <span style="position:relative; left:20px;font-weight: bold;">Is this home currently in your top 3?</span><br />
                                        <span style="position:relative; left:26px">
                                            <img src="/img/Star_empty.png" id="Buyer_View_ratingImage1" />
                                            <img src="/img/Star_empty.png" id="Buyer_View_ratingImage2" />
                                            <img src="/img/Star_empty.png" id="Buyer_View_ratingImage3" />
                                        </span>
                                        <span style="float:right">
                                            <span class="glyphicon glyphicon-ok" id="Buyer_tom31" style="color:#FF6937;font-weight:bold" hidden="hidden"></span>&nbsp;
                                            <span id="Buyer_tom3_1">Yes</span>&nbsp;
                                            <span class="glyphicon glyphicon-ok" id="Buyer_tom32" style="color:#FF6937;font-weight:bold" hidden="hidden"></span>&nbsp;
                                            <span id="Buyer_tom3_2">No</span>
                                        </span>
                                    </div>
                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">How does the price compare to similar properties?</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Buyer_PriceCompare1_1">
                                            At Market value
                                            <span id="Buyer_PriceCompare1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden="hidden"></span>
                                        </div>
                                        <div id="Buyer_PriceCompare1_2">
                                            Above Similar Homes
                                            <span id="Buyer_PriceCompare2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden="hidden">
                                            </span>
                                        </div>
                                        <div id="Buyer_PriceCompare1_3">
                                            Far Above Similar Homes
                                            <span id="Buyer_PriceCompare3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden="hidden">
                                            </span>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">Exterior</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Buyer_Exterior1_1">
                                            Excellent
                                            <span id="Buyer_Exterior1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden>
                                            </span>
                                        </div>
                                        <div id="Buyer_Exterior1_2">
                                            Average
                                            <span id="Buyer_Exterior2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden>
                                            </span>
                                        </div>
                                        <div id="Buyer_Exterior1_3">
                                            Needs Improvement
                                            <span id="Buyer_Exterior3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">Interior</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Buyer_Interr1_1">Clean and Well kept <span id="Buyer_Interr1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Buyer_Interr1_2">Average<span id="Buyer_Interr2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Buyer_Interr1_3">Needs Improvement<span id="Buyer_Interr3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                    </div>
                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">Landscaping</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Buyer_Landscapping1_1">Excellent <span id="Buyer_Landscapping1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Buyer_Landscapping1_2">Average<span id="Buyer_Landscapping2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Buyer_Landscapping1_3">Needs Improvement<span id="Buyer_Landscapping3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                    </div>
                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">Considering an offer</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Buyer_ConsidiringOffer1_1">Yes <span id="Buyer_ConsidiringOffer1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Buyer_ConsidiringOffer1_2">Possibly/Just started search<span id="Buyer_ConsidiringOffer2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Buyer_ConsidiringOffer1_3">No, not in consideration<span id="Buyer_ConsidiringOffer3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                    </div>

                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">Features that need improvement or updating?</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Buyer_FeatureToImprove1_1">Paint <span id="Buyer_FeatureToImprove1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Buyer_FeatureToImprove1_2">Cleaning<span id="Buyer_FeatureToImprove2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Buyer_FeatureToImprove1_3">Carpet<span id="Buyer_FeatureToImprove3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Buyer_FeatureToImprove1_4">Other<span id="Buyer_FeatureToImprove4" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                    </div>

                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                            </div>
                        </div>
                        <div class="col-sm-12" id="buyer_errormessage_div_Feedbackpopup" style="display:none">
                            <div class="col-sm-2">&nbsp;</div>
                            <div class="col-sm-8" style="border:1px solid #ff0000; border-radius:5px;background-color:#fb9292;color:#fb091f;text-align:center;margin-top:3%;padding:10px;font-size:15px;font-weight:bold">
                                <img src="~/img/red_alert.png" style="float:left;margin-bottom:0;height:20px" />Buyer chose to not send feedback.
                            </div>
                            <div class="col-sm-2">&nbsp;</div>
                        </div>
                    </div>
                    <div class="tab-pane active" id="agent_feedback_div" style="margin-top:10px">
                        <div id="agent_post_feedback_div_data" style="padding:11px;">
                            <div class="col-sm-12 scrolls_divs" id="div_inPOPup" style="font-size: 14px; position: relative;  min-height:350px; max-height:350px; overflow-y:auto">
                                <div class="col-sm-12" style="position: relative;padding-right:0">
                                    <span style="position:relative;font-weight:bold">
                                        What are your general observations / comments on this home?
                                    </span>
                                </div>
                                <div class="col-sm-12" style="text-align: center; position: relative;top:5px">
                                    <input style="border: 1px solid #ea927a;height:55px" type="text" class="form-control" placeholder="Enter comments…" id="Showings_feddback_comments">
                                 
                                </div>
                                <div class="col-sm-12" style="margin-top:12px">
                                    <span style="position:relative;font-weight:bold">Is this home currently in your top 3?</span><br />
                                    <span style="position:relative; left:26px">
                                        <a class="rating" href="#">
                                            <img src="/img/Star_empty.png" id="ratingImage1" onclick="rating('1','ratingImage1')" />
                                        </a>
                                        <a class="rating" href="#"><img src="/img/Star_empty.png" id="ratingImage2" onclick="rating('2','ratingImage2')" /></a>
                                        <a class="rating" href="#"><img src="/img/Star_empty.png" id="ratingImage3" onclick="rating('3','ratingImage3')" /></a>
                                    </span>
                                    <span style="float:right">
                                        <input type="radio" name="HoemRating" value="1" checked />&nbsp;<span style="font-weight:bold">Yes</span> &nbsp;
                                        <input type="radio" name="HoemRating" value="2" />&nbsp;<span style="font-weight:bold">No</span>
                                    </span>
                                </div>
                                <div class="col-sm-12" style="position: relative;margin-top:12px">
                                    <span style="position:relative;font-weight:bold; color:#ff5d26">How does the price compare to similar properties?</span>
                                    <div class="col-sm-12" style="position:relative; top:3px; padding:0">
                                        <div class="col-sm-12">At Market value<span style="float:right; text-align:right"><input type="radio" name="PriceCompare" value="1" checked /></span></div>
                                        <div class="col-sm-12">Above Similar Homes<span style="float:right; text-align:right"><input type="radio" name="PriceCompare" value="2" /></span></div>
                                        <div class="col-sm-12">Far Above Similar Homes<span style="float:right; text-align:right"><input type="radio" name="PriceCompare" value="3" /></span></div>
                                    </div>
                                </div>
                                <div class="col-sm-12" style="position: relative;margin-top:12px">
                                    <span style="position:relative;font-weight:bold; color:#ff5d26">Exterior</span>
                                    <div class="col-sm-12" style="position:relative; top:3px;padding:0">
                                        <div class="col-sm-12">Excellent<span style="float:right; text-align:right"><input type="radio" name="Exterior" value="1" checked /></span></div>
                                        <div class="col-sm-12">Average<span style="float:right; text-align:right"><input type="radio" name="Exterior" value="2" /></span></div>
                                        <div class="col-sm-12">Needs Improvement<span style="float:right; text-align:right"><input type="radio" name="Exterior" value="3" /></span></div>
                                    </div>
                                </div>
                                <div class="col-sm-12" style="position: relative;margin-top:12px">
                                    <span style="position:relative;font-weight:bold; color:#ff5d26">Interior</span>
                                    <div class="col-sm-12" style="position:relative; top:3px; padding:0">
                                        <div class="col-sm-12">Clean and Well kept<span style="float:right; text-align:right"><input type="radio" name="Interior" value="1" checked /></span></div>
                                        <div class="col-sm-12">Average<span style="float:right; text-align:right"><input type="radio" name="Interior" value="2" /></span></div>
                                        <div class="col-sm-12">Needs Improvement<span style="float:right; text-align:right"><input type="radio" name="Interior" value="3" /></span>s</div>
                                    </div>
                                </div>
                                <div class="col-sm-12" style="position: relative;margin-top:12px">
                                    <span style="position:relative;font-weight:bold; color:#ff5d26">Landscaping</span>
                                    <div class="col-sm-12" style="position:relative; top:3px;padding:0">
                                        <div class="col-sm-12">Excellent<span style="float:right; text-align:right"><input type="radio" name="Land_Scaping" value="1" checked /></span></div>
                                        <div class="col-sm-12">Average<span style="float:right; text-align:right"><input type="radio" name="Land_Scaping" value="2" /></span></div>
                                        <div class="col-sm-12">Needs Improvement<span style="float:right; text-align:right"><input type="radio" name="Land_Scaping" value="3" /></span></div>
                                    </div>
                                </div>
                                <div class="col-sm-12" style="position: relative;margin-top:12px">
                                    <span style="position:relative;font-weight:bold; color:#ff5d26">Considering an offer</span>
                                    <div class="col-sm-12" style="position:relative; top:3px;padding:0">
                                        <div class="col-sm-12">Yes<span style="float:right; text-align:right"><input type="radio" name="Offer" value="1" checked /></span></div>
                                        <div class="col-sm-12">Possibly/Just started search<span style="float:right; text-align:right"><input type="radio" name="Offer" value="2" /></span></div>
                                        <div class="col-sm-12">No, not in consideration<span style="float:right; text-align:right"><input type="radio" name="Offer" value="3" /></span></div>
                                    </div>

                                </div>
                                <div class="col-sm-12" style="position: relative;margin-top:12px">
                                    <span style="position:relative;font-weight:bold; color:#ff5d26">Features that need improvement or updating?</span>
                                    <div class="col-sm-12" style="position:relative; top:3px;padding:0">
                                        <div class="col-sm-12">paint<span style="float:right; text-align:right"><input type="radio" name="Features" value="1" checked /></span></div>
                                        <div class="col-sm-12">Cleaning<span style="float:right; text-align:right"><input type="radio" name="Features" value="2" /></span></div>
                                        <div class="col-sm-12">Carpet<span style="float:right; text-align:right"><input type="radio" name="Features" value="3" /></span></div>
                                        <div class="col-sm-12">Other<span style="float:right; text-align:right"><input type="radio" name="Features" value="4" /></span></div>
                                    </div>
                                </div>
                                <div class="col-sm-12"><hr style="margin: 3% 0 1%;  border-top-color: #ff5d26; border-top-width: 2px; border-top-style: solid; position: relative;" /></div>
                                <div class="col-sm-12" style="text-align: center; position: relative;">
                                    <input type="checkbox" id="check_prefer" /> <span>I would prefer not to save or send feedback.</span>
                                </div>
                                <div class="col-sm-12"><hr style="margin: 2% 0 0; border-top-color: #ff5d26; border-top-width: 1px; border-top-style: solid; position: relative;" /></div>

                            </div>
                        </div>
                        <div id="agent_view_feedback_div_data" style="padding:11px;display:none">
                            <div class="col-sm-12 scrolls_divs" id="div_inPOPup2" style="font-size: 14px; position: relative;  min-height:315px; max-height:315px; overflow-y:auto">
                                <div class="col-sm-12" style="text-align:center;">
                                    What are your general observations / comments on this home?
                                </div>
                                <div id="Agent_Comments" class="col-sm-12 scrolls_divs" style="overflow-y: auto;font-size:12px;text-overflow: ellipsis;margin-top:10px;border:1px solid #ff572299; border-radius: 5px;max-height:50px;min-height:50px;text-align: center;  position: relative;">
                                    @*<span style="font-size: 11px; position: relative;" id="View_comment">*@
                                    We really like the fenced backyard and updated kitchen. We wish the master bath had more updates.
                                    @*</span>*@

                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="padding-top:5px;">
                                    <div>
                                        <span style="position:relative; left:20px;">Is this home currently in your top 3?</span><br />
                                        <span style="position:relative; left:26px">
                                            <img src="/img/Star_empty.png" id="Agent_View_ratingImage1" />
                                            <img src="/img/Star_empty.png" id="Agent_View_ratingImage2" />
                                            <img src="/img/Star_empty.png" id="Agent_View_ratingImage3" />
                                        </span>
                                        <span style="float:right">
                                            <span class="glyphicon glyphicon-ok" id="Agent_tom31" style="color:#FF6937;font-weight:bold" hidden="hidden"></span>&nbsp;
                                            <span id="Agent_tom3_1">Yes</span>&nbsp;
                                            <span class="glyphicon glyphicon-ok" id="Agent_tom32" style="color:#FF6937;font-weight:bold" hidden="hidden"></span>&nbsp;
                                            <span id="Agent_tom3_2">No</span>
                                        </span>
                                    </div>
                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">How does the price compare to similar properties?</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Agent_PriceCompare1_1">
                                            At Market value
                                            <span id="Agent_PriceCompare1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden="hidden"></span>
                                        </div>
                                        <div id="Agent_PriceCompare1_2">
                                            Above Similar Homes
                                            <span id="Agent_PriceCompare2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden="hidden">
                                            </span>
                                        </div>
                                        <div id="Agent_PriceCompare1_3">
                                            Far Above Similar Homes
                                            <span id="Agent_PriceCompare3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden="hidden">
                                            </span>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">Exterior</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Agent_Exterior1_1">
                                            Excellent
                                            <span id="Agent_Exterior1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden>
                                            </span>
                                        </div>
                                        <div id="Agent_Exterior1_2">
                                            Average
                                            <span id="Agent_Exterior2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden>
                                            </span>
                                        </div>
                                        <div id="Agent_Exterior1_3">
                                            Needs Improvement
                                            <span id="Agent_Exterior3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">Interior</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Agent_Interr1_1">Clean and Well kept <span id="Agent_Interr1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Agent_Interr1_2">Average<span id="Agent_Interr2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Agent_Interr1_3">Needs Improvement<span id="Agent_Interr3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                    </div>
                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">Landscaping</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Agent_Landscapping1_1">Excellent <span id="Agent_Landscapping1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Agent_Landscapping1_2">Average<span id="Agent_Landscapping2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Agent_Landscapping1_3">Needs Improvement<span id="Agent_Landscapping3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                    </div>
                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">Considering an offer</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Agent_ConsidiringOffer1_1">Yes <span id="Agent_ConsidiringOffer1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Agent_ConsidiringOffer1_2">Possibly/Just started search<span id="Agent_ConsidiringOffer2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Agent_ConsidiringOffer1_3">No, not in consideration<span id="Agent_ConsidiringOffer3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                    </div>

                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                                <div class="col-sm-12" style="position: relative;">
                                    <span style="position:relative; left:15px;font-weight:bold; color:#ff5d26">Features that need improvement or updating?</span>
                                    <div class="col-sm-12" style="position:relative; top:10px; left:10px">
                                        <div id="Agent_FeatureToImprove1_1">Paint <span id="Agent_FeatureToImprove1" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Agent_FeatureToImprove1_2">Cleaning<span id="Agent_FeatureToImprove2" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Agent_FeatureToImprove1_3">Carpet<span id="Agent_FeatureToImprove3" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                        <div id="Agent_FeatureToImprove1_4">Other<span id="Agent_FeatureToImprove4" style="float:right; text-align:right;color:#ff5d26;font-size:15px;" class="glyphicon glyphicon-ok" hidden></span></div>
                                    </div>

                                </div>
                                <div class="col-sm-12">&nbsp;</div>
                            </div>
                        </div>
                        <div class="col-sm-12" id="agent_errormessage_div_Feedbackpopup" style="display:none">
                            <div class="col-sm-2">&nbsp;</div>
                            <div class="col-sm-8" style="border:1px solid #ff0000; border-radius:5px;background-color:#fb9292;color:#fb091f;text-align:center;margin-top:3%;padding:10px;font-size:15px;font-weight:bold">
                                <img src="~/img/red_alert.png" style="float:left;margin-bottom:0;height:20px" />Agent chose to not send feedback.
                            </div>
                            <div class="col-sm-2">&nbsp;</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border-radius: 5px;background-color:#fff">
                <div class="col-sm-12" style="text-align:center;display:none" id="done_div">
                    <hr style="border-top-color: #ff5d26; border-top-width: 2px; border-top-style: solid; position: relative;" />
                    <a href="#" class="btn" data-dismiss="modal" style="border-radius: 3px !important;width: 90px; height: 24px; color: white; padding-top: 3px; font-size: 11px; font-weight: 500; position: relative; background-color: rgb(255, 93, 38);">Done</a>
                </div>
                <div class="col-sm-12" style="text-align: center; position: relative;margin-top:15px" id="save_div">
                    <a href="#" class="btn" id="btn_NotNow" data-dismiss="modal" style="border-radius: 3px !important;  width: 90px; height: 24px; color: white; padding-top: 3px; font-size: 11px; font-weight: 500; position: relative;  background-color: gray;">Not Now</a>
                    <a href="#" class="btn" id="btn_Post_Feedback" style="border-radius: 3px !important;  width: 90px; height: 24px; color: white; padding-top: 3px; font-size: 11px; font-weight: 500; position: relative;  background-color: #ff5d26;">Save</a>
                </div>
            </div>
        </div>
    </div>
</div>
@*------------Feedback Popup of AGent to Post and View Byer and his Feedback  End------------------------*@
@*Thnak you Pop-UP after post Feedbackt*@
<div class="modal fade" id="ThankyouAlertPopup_Feedback" style="z-index: 2500;"  tabindex="-1" role="dialog" aria-labelledby="MessageLabel" aria-hidden="true" style="padding-left: 206px">
    <div class="modal-dialog" role="document" style="padding-top: 12%; width: 22%">
        <div class="modal-content">
            <div class="modal-header" style="text-align: center;color:#ff6937;height:45px;padding-top:13px;">
                <label id="" style="font-size:18px">
                    Thank you!
                </label>
                <hr style="color:#ff6937;border: 0.5px solid;margin-top:7px;" />
            </div>
            <div class="col-sm-12">&nbsp;</div>
            <div class="modal-body">
                <div class="col-md-12" style="text-align: center">
                    <label id="" style="word-wrap: break-word;">
                        Your feedback has been submitted to the Listing Agent and Seller.
                    </label>
                </div>
                <div class="col-sm-12">&nbsp;</div>
                <div class="modal-footer">
                    <div class="col-md-3">&nbsp;</div>
                    <div class="col-md-6" style="text-align: center">
                        <button type="button" id="thanksalertOKbtn" data-dismiss="modal" class="btn btn-primary closeorangebtn" style="border-radius: 5px 5px 5px 5px  !important; background-color: #ff6937!important; color: white;font-size: 15px;width:100%">OK</button>
                    </div>
                    <div class="col-md-3">&nbsp;</div>
                </div>
            </div>
        </div>
    </div>
</div>
@*Comments Saved Pop-UP afterAgent Edit Comments*@
<div class="modal fade" id="CommentsSaved_Popup" tabindex="-1" style="z-index: 2500;" role="dialog" aria-labelledby="MessageLabel" aria-hidden="true" style="padding-left: 206px">
    <div class="modal-dialog" role="document" style="padding-top: 12%; width: 22%">
        <div class="modal-content">
            <div class="modal-header" style="text-align: center;color:#ff6937;height:45px;padding-top:13px;">
                <label id="" style="font-size:18px">
                    Comments Saved
                </label>
                <hr style="color:#ff6937;border: 0.5px solid;margin-top:7px;" />
            </div>
            <div class="col-sm-12">&nbsp;</div>
            <div class="modal-body">
                <div class="col-md-12" style="text-align: center">
                    <label id="" style="word-wrap: break-word;">
                        Your edits to the buyer's showing feedback comments have been successfully <b style="color:#ff5d26">Saved.</b>
                    </label>
                </div>
                <div class="col-sm-12">&nbsp;</div>
                <div class="modal-footer">
                    <div class="col-md-3">&nbsp;</div>
                    <div class="col-md-6" style="text-align: center">
                        <button type="button" id="commentsSavedOKbtn" data-dismiss="modal" class="btn btn-primary closeorangebtn" style="border-radius: 5px 5px 5px 5px  !important; background-color: #ff6937!important; color: white;font-size: 15px;width:100%">OK</button>
                    </div>
                    <div class="col-md-3">&nbsp;</div>
                </div>
            </div>
        </div>
    </div>
</div>
<style>
    .mytooltip {
    position: absolute;
    display: block;
    /*padding: 5px;
   
    font-size: 13px;*/
    visibility: visible;
   /*border-radius: 10px;*/
    bottom:140%;
    margin-left: -2.5em;
}

.mytooltip .tooltip-arrow {
    bottom: -8px;
    left: 48%;
    margin-left: -5px;
    border-top: 7px solid #fff;
    border-right: 7px solid transparent;
    border-left: 7px solid transparent;
    position: absolute;
    width: 0;
    height: 0;
    
}

.tooltip-inner {
     border:0.5px solid gray;
    height:25px;
    border-radius:20px;
     /*max-width: 200px;
    padding: 0px 9px;*/
    color: #000000;
    padding: 0px 10px 0px;
    text-align: center;
    text-decoration: none;
    background-color: #fff;
    /*-webkit-border-radius: 4px;
       -moz-border-radius: 4px;
            border-radius: 4px;*/
}
.ui-state-default,a .ui-state-default {
    background: #fff !important;
    border: 2px solid #fff !important;
}
</style>
<script>
    var sliderTooltip = function (event, ui) {
        var curValue = ui.value || 5;
        var tooltip = '<div class="mytooltip"><div class="tooltip-inner"><b id="dewelltimeval">' + curValue + '</b>&nbsp;Minutes</div><div class="tooltip-arrow"></div></div>';
        $("#dewelltimeval").text(ui.value);
        $('.ui-slider-handle').html(tooltip);
    }
    $("#dewelltimeval").text('5');
    $("#slider").slider({
        range: "min",
        animate: true,
        value: 1,
        min: 5,
        max: 60,
        step: 5,
        create: sliderTooltip,
        slide: sliderTooltip
        //slide: function (event, ui) {
        //    $("#dewelltimeval").text(ui.value);
        //    // update(1, ui.value); //changed
        //}
    });
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>
<script src="https://cdn.rawgit.com/googlemaps/v3-utility-library/master/markerwithlabel/src/markerwithlabel.js"></script>
<script>
  
    $('#fromtimebtn,#totimebtn').on('click', function (e) {
        e.preventDefault();
       
    });
    var watermark = '<div id="aaa" style="background-image:url(/img/sellertools_watermark_bg.png);background-position:center;background-repeat: no-repeat; background-color:white;min-height:72vh;max-height:72vh;overflow-y:auto;text-align:center">'
                + '</div>'
    $(document).ready(function () {

        $('#mymenuli').addClass('menuactive');
         //$("#AlertMessagePopup").modal('show')
        $('#buyerdivinlistings').append(watermark);
        var stab = '1';
        window.location.search
          .replace(/[?&]+([^=&]+)=([^&]*)/gi, function (str, key, value) {
            stab = value;
          }
        );
        if (stab == "1") {
            $('#tab1').addClass('active')
            getAgentBuyers('Requested');
        }
        else if (stab == "2") {
            getAgentBuyers('Scheduled');
            $('#tab3').addClass('active')
        }
        else if (stab == "3") {
            $('#tab4').addClass('active')
            getAgentBuyers('Completed');
        }
     
    });
    //Date Script
    $("#date11icon").click(function () {
        $("#customdate")[0].focus();
    })
    $("#customdate").datepicker({
        beforeShow: function (input, inst) {
            inst.dpDiv.css({ marginLeft: '-75px' });
        },
        onSelect: function () {
            $('#date_ErrorMsg_div').hide();
            $('#validationerrorMessage').text('');
        },
        dateFormat: 'mm/dd/yy',
        dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
        minDate: 0,
    })
    //Time Picker Start
    var PrevID = "";
    function OpenTimepicker(id, id2) {
        $(document).mouseup(function (e) {
            var container = $("#TimePicker1");
            var container2 = $("#TimePicker2");
            // if the target of the click isn't the container nor a descendant of the container
            if (!container.is(e.target) && container.has(e.target).length === 0) {
                container.removeClass('collaspe in');
            }
            // if the target of the click isn't the container nor a descendant of the container
            if (!container2.is(e.target) && container2.has(e.target).length === 0) {
                container2.removeClass('collaspe in');
            }

        });
        if (PrevID != "") {
            $('#' + PrevID).empty();
            //$('#'+PrevID).removeClass('collaspe in');
        }
        var timepickerhtml = "<div class='col-sm-12' style='background-color: white; border-radius:7px;padding:5px 0px 3px 0px;z-index:1048'>"
            + "<div class='col-sm-4'><div><i class='glyphicon glyphicon-menu-up' aria-hidden='true' style='font-size:12px; font-weight:bold;color:#ff6a00' id='HoursUp'>"
             + "</i></div><div><span id='Hours' style='color:black'></span></div><div><i class='glyphicon glyphicon-menu-down' aria-hidden='true' style='font-size:12px; font-weight:bold;color:#ff6a00' id='HoursDown'></i></div></div>"
             + "<div class='col-sm-4' style='padding-left:10px'><div><i class='glyphicon glyphicon-menu-up' aria-hidden='true' style='font-size:12px; font-weight:bold;color:#ff6a00' id='MinUp'></i></div>"
             + "<div><span id='Minutes'  style='color:black'></span></div><div><i class='glyphicon glyphicon-menu-down' aria-hidden='true' style='font-size:12px; font-weight:bold;color:#ff6a00' id='MinDown'></i></div>"
             + "</div><div class='col-sm-4' style='padding-left:5px'><div><i class='glyphicon glyphicon-menu-up' aria-hidden='true' style='font-size:12px; font-weight:bold;color:#ff6a00' id='AP_UP'></i></div>"
             + "<div style='text-align:center'><span id='AM_PM' style='font-size:10px;color:black;font-weight:bold'></span></div><div><i class='glyphicon glyphicon-menu-down' aria-hidden='true' style='font-size:12px; font-weight:bold;color:#ff6a00' id='AP_Down'></i></div></div></div>";
        $('#' + id).html(timepickerhtml);
        // TimePickerEvents();
        PrevID = id;

        $('#Hours').html(hours);
        if ($('#Hours').html().length == 1) {
            $('#Hours').html('0' + $('#Hours').html());
        }
        $('#Minutes').html(minutes);
        if ($('#Minutes').html().length == 1) {
            $('#Minutes').html('0' + $('#Minutes').html());
        }
        $('#AM_PM').html(ampm);
        TimePickerEvents(id2);
    }
    //-------Time Picker Functionality-------------
    var date = new Date();
    var hours = '12';
    var minutes = '0';
    var ampm = 'PM';
    //hours = date.getHours();
    //minutes = date.getMinutes();
    ampm = hours >= 12 ? 'PM' : 'AM';
    //hours = hours % 12;
    hours = hours < 10 ? '0' + hours : hours; // the hour '0' should be '12'
    minutes = minutes < 10 ? '0' + minutes : minutes;
    $('#customFromTime').val(hours + ':' + minutes + ' ' + ampm);
    $('#customToTime').val(hours + ':' + minutes + ' ' + ampm);
    function TimePickerEvents(TPID) {
        //----------AM UP Change functionality
        $('#AP_UP,#AP_Down').click(function () {
            var String = $('#AM_PM').html();
            if ($('#AM_PM').html() == 'PM') {
                $('#AM_PM').html('AM');
            }
            else {
                $('#AM_PM').html('PM');
            }
        })
        ///------Minutes Management
        $('#MinUp').click(function () {
            if (parseInt($('#Minutes').html()) > 0) {
                var Min = parseInt($('#Minutes').html()) - 1;
                $('#Minutes').html(Min);
            }
            else {
                var Min = 59;
                $('#Minutes').html(Min);
            }
            if ($('#Minutes').html().length == 1) {
                $('#Minutes').html('0' + $('#Minutes').html());
            }
        })
        $('#MinDown').click(function () {
            if (parseInt($('#Minutes').html()) < 59) {
                var Min = parseInt($('#Minutes').html()) + 1;
                $('#Minutes').html(Min);
            }
            else {
                var Min = 00;
                $('#Minutes').html(Min);
            }

            if ($('#Minutes').html().length == 1) {
                $('#Minutes').html('0' + $('#Minutes').html());
            }
        })
        //-----Hours Management-------
        $('#HoursUp').click(function () {
            if (parseInt($('#Hours').html()) > 1) {
                var Hours = parseInt($('#Hours').html()) - 1;
                $('#Hours').html(Hours);
            }
            else {
                var Hours = 12;
                $('#Hours').html(Hours);
            }
            if ($('#Hours').html().length == 1) {
                $('#Hours').html('0' + $('#Hours').html());
            }
        })
        $('#HoursDown').click(function () {
            if (parseInt($('#Hours').html()) < 12) {
                var Hours = parseInt($('#Hours').html()) + 1;
                $('#Hours').html(Hours);
            }
            else {
                var Hours = 01;
                $('#Hours').html(Hours);
            }
            if ($('#Hours').html().length == 1) {
                $('#Hours').html('0' + $('#Hours').html());
            }
        })
        $('#HoursUp,#HoursDown,#MinUp,#MinDown,#AP_UP,#AP_Down').click(function () {
            $('#' + TPID).text();
            var Time = $('#Hours').html() + ':' + $('#Minutes').html() + ' ' + $('#AM_PM').html();
            $('#' + TPID).text(Time);
            var timediff;
            if (TPID == "totimebtn") {
                timediff = calculateTime($('#fromtimebtn').text(), $('#totimebtn').text());
                TimeDifferanceComparision(timediff);

            }
        })
    }//Time Picker Events

    function TimeDifferanceComparision(timediff) {
         console.log(timediff);
        if (timediff < 60) {
            $('#date_ErrorMsg_div').show();
            $('#validationerrorMessage').text('Time duration should be one hour');
            $('#SaveDateBtn').attr('disabled', true)
        }
        else {
            $('#SaveDateBtn').removeAttr('disabled')
            $('#date_ErrorMsg_div').hide();
            $('#validationerrorMessage').text('');
        }
    }
    function calculateTime(fromtime, totime) {
        var day = '1 1 1970 ',  // 1st January 1970
           // start = $('#Txt_FirstFrom').val(),   //eg "09:20 PM"
           // end = $('#txt_First_To').val(),   //eg "10:00 PM"
            diff_in_min = (Date.parse(day + totime) - Date.parse(day + fromtime)) / 1000 / 60;
        //console.log(diff_in_min);
        return diff_in_min;
    };
    $("#SaveDateBtn ").click(function () {
        event.preventDefault();
        var cdate, cfromtime = "Any", ctotime = "Any";
        cdate = $("#customdate").val();
        if (cdate != "") {
            $('#date_ErrorMsg_div').hide();
            $('#validationerrorMessage').text('');
            if ($("#fromtimebtn").text() != "")
                cfromtime = $("#fromtimebtn").text();
            if ($("#totimebtn").text() != "")
                ctotime = $("#totimebtn").text();

            $("#choosenDate").val(cdate + ", " + cfromtime.trim() + " to " + ctotime.trim());
            // alert(cdate + ", " + cfromtime.trim() + " to " + ctotime.trim())
            $("#selecteddatediv").show();
            $("#chooseCustomDateBtn").hide();
            $("#ChooseDateTimePopup").modal('hide');
            $('select[id=requestedDateTime]').val(0);
            $("#requestedDateTime").selectpicker("refresh");
            $("#SaveContinueBtn_ScheduledPopup").removeClass('btndisble').addClass('btnenable');
            $('#SaveContinueBtn_ScheduledPopup').prop("disabled", false);
        }
        else {
            $('#date_ErrorMsg_div').show();
            $('#validationerrorMessage').text('Please Select Date');
        }
    });
    $('#ChooseDateTimePopup').on('shown.bs.modal', function () {
        $('#customdate').val('');
        $('#date_ErrorMsg_div').hide();
        $('#validationerrorMessage').text('');
        $('#fromtimebtn').text('12:00 PM'); $('#totimebtn').text('12:00 PM')
        $('#SaveDateBtn').prop("disabled", true);
    });
    //Get Formatted Date into TExhBox After Add From CooseCustom Date And Tim Popup
    //Time Picker End
    $("#requestedDateTime").change(function () {
        if ($(this).val() != 0) {
            $("#SaveContinueBtn_ScheduledPopup").addClass('btnenable')
            $('#SaveContinueBtn_ScheduledPopup').prop("disabled", false);
            $("#selecteddatediv").hide();
            $("#choosenDate").val('');
            $("#chooseCustomDateBtn").show();
        }

        else {
            $("#SaveContinueBtn_ScheduledPopup").removeClass('btnenable').addClass('btndisble');
            //  $("#SaveContinueBtn_ScheduledPopup").addClass('btndisable');
            $('#SaveContinueBtn_ScheduledPopup').prop("disabled", true);
        }

    });//Change Event of Dropdown for REquested Date Times by User
    $("#ScheduleShowings_Popup").on('shown.bs.modal', function () {
        if ($("#requestedDateTime").val() == 0) {
            $("#SaveContinueBtn_ScheduledPopup").removeClass('btnenable').addClass('btndisble');
            //  $("#SaveContinueBtn_ScheduledPopup").addClass('btndisable');
            $('#SaveContinueBtn_ScheduledPopup').prop("disabled", true);
        }
        else {
            $("#SaveContinueBtn_ScheduledPopup").addClass('btnenable')
            $('#SaveContinueBtn_ScheduledPopup').prop("disabled", false);
        }
        $('#selecteddatediv').hide();
        $('#chooseCustomDateBtn').show();
    })
    $('#close_SchedulePopup').click(function () {
        $('#slider').slider('value', 05);
        $('#dewelltimeval').text('5');
    })
    var mybuyer = "", buyerid = "", Status = "";
    function getAgentBuyers(status) {
        Status = status;
        $('#buyerdivinlistings').empty();
        $('#buyerdivinlistings').append(watermark);
        $.ajax({
            url: "/Agent/AgentShowings/GetAgentBuyers_Requested",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { AgentID: AgentId, Status: status },
            success: function (data) {
                if (data.length > 0) {
                    bindBuyers(data);
                    //var custphoto = "/img/addphotopic.png";
                    //if (data[0].Image != "")
                    //    custphoto = data[0].Image;
                    //selectedBuyer(data[0].PK_UserID, data[0].First_Name, data[0].Last_Name, custphoto, data[0].MobileNo);
                }
                else {
                    $('#buyerdivinlistings').empty();
                    $('#buyerdivinlistings').append(watermark);
                    $('#BuyersList_Div').empty();
                    //$("#heading").text("Alert!");
                    //$("#content_text").text("You don't have any buyer for " + status + " Listings");
                    //$("#AlertPopup").modal("show");
                }
            }
        });
    }//Function to get Buyers list on slected Tab(Status)
    function bindBuyers(data) {
        $('#BuyersList_Div').empty();
        $.each(data, function (i, item) {
            var custphoto = "/img/addphotopic.png";
            if (data[i].Image != "" && data[i].Image != null)
                custphoto = data[i].Image;
            var CompleredData = ''
                + '<div class="col-sm-12" id="' + data[i].PK_UserID + '"  style="padding:5px;border-bottom:1px solid lightgray;cursor:pointer" onclick="return selectedBuyer(\'' + data[i].PK_UserID + '\',\'' + data[i].First_Name + '\',\'' + data[i].Last_Name + '\',\'' + custphoto + '\',\'' + data[i].MobileNo + '\')"><div class="col-sm-2">'
                + '<img src="' + custphoto + '" class="" style="border-radius:50px;height:50px;width:50px;margin-bottom:0"></div>'
                + '<div class="col-sm-10" style=""><label style="margin-top:15px;font-weight:bold;font-size:14px;padding-left:18px;cursor:pointer">' + data[i].First_Name + ' ' + data[i].Last_Name + '</label></div></div>';
            $('#BuyersList_Div').append(CompleredData);
        });
    }//Function to bind Buyers to Div based on selected tab
    function selectedBuyer(userid, fname, lname, photourl, mobileno) {
        //alert(Status)
        buyerid = userid;
        $("#BuyersList_Div div").parent().find('div').removeClass("highlightbackground");
        $("#BuyersList_Div div").parent().find("#" + userid).addClass("highlightbackground");
        $("#" + userid).addClass('highlightbackground')
        $('#buyerdivinlistings').empty();
        //$("#buyerphotoinlistings").attr('src', photourl);
        //$("#buyernameinlistings").text(fname + " " + lname);
        //$("#buyerdivinlistings").show();
        mybuyer = '<div class="col-sm-12" style="padding:10px"><div class="col-sm-1" style=""><img src="' + photourl + '" id="buyerphotoinlistings" class="" style="border-radius:50px;height:50px;width:50px"></div>'
                       + '<div class="col-sm-8" style="margin-top:3px"><label class="labelorange" style="font-weight:bold">Buyer</label><br />'
                       + '<label style="font-weight:bold;font-size:14px;" id="buyernameinlistings">' + fname + ' ' + lname + '</label></div>'
                       + '<div class="col-sm-1" style="width:6%"></div><div class="col-sm-1" style="line-height:45px;text-align:right"><a class="btn" onclick="return PhoneDetails(\'' + mobileno + '\',\'' + fname + '\',\'' + lname + '\')"><img src="/img/phoneicon_mycustomer.png" /></a></div>'
                       + '<div class="col-sm-1" style="line-height:45px;text-align:center"><a class="btn" onclick="return creatConnection(\'' + userid + '\',\'' + fname + '\',\' 1 \',\'0\')"><img src="/img/messages_icon.png" /></a></div></div>'

        $('#buyerdivinlistings').append(mybuyer);
        GetAgentListings(userid, Status);
        // GetAgentListings();
        $("#buyerdivinlistings").css('border-bottom', '1px solid lightgray')
        //$("#ShowingScheduleInstructions_Popup").modal('show')
        //var mapOptions = {
        //    center: new google.maps.LatLng(19.0606917, 72.83624970000005),
        //    zoom: 18,
        //    mapTypeId: google.maps.MapTypeId.ROADMAP
        //}
        //var map = new google.maps.Map($("#map_in_popup")[0], mapOptions);
        //sourceListings()
    }//Function to get Listings based on selected buyer from Buyers List in RH side
    function GetAgentListings(RequestedUserID, Status) {
        $.ajax({
            url: "/Agent/AgentShowings/GetAgentListings_byStatus",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { AgentID: AgentId, RequestedUserID: RequestedUserID, Status: Status },
            success: function (data) {
                //if (str == "r")
                if (data.length > 0) {
                    if (Status == "Requested")
                        bindRequestedLists(data);
                    else if (Status == "Pending")
                        bindPendingLists(data);
                    else if (Status == "Scheduled")
                        bindScheduledLists(data);
                    else if (Status == "Completed")
                        bindCompletedListings(data);
                }
                else {
                    // alert('no listings')
                }
                //else if (str == "p")
                //    bindPendingLists(data);
                //else if (str == "s")
                //    bindScheduledLists(data);
                //else
                // bindCompletedLists(data);

            }
        });
    }//Funtion to get Requests based on User selected on DivList
    function bindRequestedLists(data) {
        $('#buyerdivinlistings').empty();
        $('#buyerdivinlistings').append(mybuyer);
        var d1 = "", d2 = "", pkey = [];
        $.each(data, function (i, item) {
            var listings = "";
            if (data[i].UserChoice2 != "")
                var dates = '<span style="color:white;position:relative;top:5px; font-size:12px">&nbsp;' + data[i].UserChoice1 + '<label style="color:rgb(255, 159, 128)">&nbsp;or&nbsp;</label>' + data[i].UserChoice2 + '</span>';
            else
                var dates = '<span style="color:white;position:relative;top:5px; font-size:12px">&nbsp;' + data[i].UserChoice1 + '<label style="color:rgb(255, 159, 128)"></span>';
            var d = '<div class="col-sm-10" style="height:30px;background-color:#686868"><span style="top: 5px; color: rgb(255, 159, 128); position: relative;">Requested For: </span>' + dates + '</div><div class="col-sm-2" style="text-align:center;line-height:30px;background-color:#ff5d26;color:#fff;"><a href="#" style="text-decoration:none;" id="div" onclick="return VieworScheduleRequestTimings(\'' + data[i].pk + '\')">View & Schedule</div>';
            $.each(data[i].AllListt, function (j, exp) {
                if (j == 0)
                    $('#buyerdivinlistings').append(d);
                if (j == data[i].AllListt.length - 1)
                    var startdiv = '<div class="col-sm-12" style="padding: 15px;">'
                else
                    var startdiv = '<div class="col-sm-12" style="padding: 15px;border-bottom: 2px solid #ff5d26;">'
                pkey.push(data[i].AllListt[j].PK_RequestShowingID)
                var imagepin = "", price = "";
                var bedrooms, bathrooms, sqftAcres;
                var BtnPrevImgId = "Prev" + data[i].AllListt[j].MLSID;
                var BtnNextImgId = "Next" + data[i].AllListt[j].MLSID;
                var PrpImagesArray = []
                var DivImgId = "div_" + data[i].AllListt[j].MLSID;
                var PhotosURL = [], TotalImages = [];
                PrpImagesArray = [];
                debugger
                if (data[i].AllListt[j].PRP_IMAGES != null && data[i].AllListt[j].PRP_IMAGES != '' && data[i].AllListt[j].PRP_IMAGES != ',') {
                    var c = data[i].AllListt[j].PHOTO_COUNT;
                    PrpImagesArray = data[i].AllListt[j].PRP_IMAGES.split(',');
                    TotalImages.push(data[i].AllListt[j].PRP_IMAGES);
                    if (TotalImages.length > 0)
                        PhotosURL = data[i].AllListt[j].PRP_IMAGES.split(',');
                    else
                        PhotosURL[0] = data[i].AllListt[j].PRP_IMAGES;
                }
                else
                    PhotosURL[0] = '/img/NoImage.png';
                if (TotalImages.length > 0) {
                    photosdiv = '<div class="col-sm-2"  style="height: 90px; position: relative; background-image: url(' + PhotosURL[0] + '); background-size: 100% 100%;" id="' + DivImgId + '">'
                                     + '<div class="col-sm-12" style="margin-top: 18%;padding: 7px;"><a href="#"><img src="/img/SliderBackArrow.png" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "-1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" width="21" height="29" alt="" style="margin-left: -20%;" id="' + BtnPrevImgId + '" hidden="hidden"/></a>'
                                     + '<a href="#"><img src="/img/SliderNextArrow.png" width="21" height="29" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" alt="" style="float: right;margin-right: -20%;" id="' + BtnNextImgId + '"   /></a></div></div>';
                }
                else {
                    photosdiv = '<div class="col-sm-2"  style="height: 90px; position: relative; background-image: url(' + PhotosURL[0] + '); background-size: 100% 100%;" id="' + DivImgId + '">'
                                    + '<div class="col-sm-12" style="margin-top: 18%;padding: 7px;"><a href="#"><img src="/img/SliderBackArrow.png" onclick="PrpImageSlider(\'' + i + '\',\'' + "-1" + '\',\'' + DivImgId + '\',\'' + data[i].AllListt[j].MLSID + '\')" width="21" height="29" alt="" style="margin-left: -20%;" id="' + BtnPrevImgId + '" hidden="hidden"/></a>'
                                    + '<a href="#"><img src="/img/SliderNextArrow.png" width="21" height="29" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" alt="" style="float: right;margin-right: -20%;" id="' + BtnNextImgId + '" hidden="hidden"/></a></div></div>';
                }
                if (data[i].AllListt[j].Class == "Rental") {
                    price = "$ " + (data[i].AllListt[j].PRP_PRICE + "").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,") + "/mo";
                    if (data[i].AllListt[j].Is_Viewd == "YES")
                        imagepin = '<img src="/img/viewed_graypin.png" height="20" style="position:relative; top:-2px" />'
                    else
                        imagepin = '<img src="/img/gray_legendMenu.png" height="20" style="position:relative; top:-2px" />'

                }
                else {
                    price = "$ " + (data[i].AllListt[j].PRP_PRICE + "").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,");
                    if (data[i].AllListt[j].Status == "Active") {
                        if (data[i].AllListt[j].Is_Viewd == "YES")
                            imagepin = '<img src="/img/viewed_greenpin.png" height="20" style="position:relative; top:-2px" />'
                        else
                            imagepin = '<img src="/img/Green_legend_Menu.png" height="20" style="position:relative; top:-2px" />'
                    }
                    else if (data[i].AllListt[j].Status == "Pending") {
                        if (data[i].AllListt[j].Is_Viewd == "YES")
                            imagepin = '<img src="/img/yellow_legendMenu.png" height="20" style="position:relative; top:-2px;margin-left: -3px;" />'
                        else
                            imagepin = '<img src="/img/viewed_yellowpin.png" height="20" style="position:relative; top:-2px" />'
                    }
                }
                if (data[i].AllListt[j].Class == "Lots/Land") {
                    sqftAcres = data[i].AllListt[j].SQFT + ' acres';
                    bedrooms = "--";
                    bathrooms = "--";
                }
                else {
                    bedrooms = data[i].AllListt[j].BEDROOMS;
                    bathrooms = data[i].AllListt[j].BATHROOMS;
                    sqftAcres = data[i].AllListt[j].SQFT + ' sqft';
                }
                var addr11 = data[i].AllListt[j].PRP_ADDRESS.split(',')[1];
                var addr12 = (data[i].AllListt[j].PRP_ADDRESS.split(',')[2] != undefined) ? "," + data[i].AllListt[j].PRP_ADDRESS.split(',')[2] : "";
                //'<div class="col-sm-12" style="padding: 15px;border-bottom: 2px solid #ff5d26;">'
                listings = startdiv + photosdiv
                                    + '<div class="col-sm-3" style="padding-left:25px;top:5px;"><table style="line-height:15px;border-right: 1px solid lightgray;width:100%">'
                                    + '<tr><td style="">' + imagepin + '<span id="Rate" style="color:#ff5d26;font-size:16px; font-weight:bold; position:relative; "><span style="position: relative;padding-left:5px">' + price + '</span></span></td></tr>'
                                    + '<tr><td style="padding-top:10px"><span id="AddLineOne" style="font-weight:bold">' + data[i].AllListt[j].PRP_ADDRESS.split(',')[0] + '</span></td></tr><tr><td style=""><span style="font-size:12px; font-weight:bold">' + addr11 + '' + addr12 + '</span></td></tr></tr>'
                                    + '<tr><td style="padding-top:5px"><span id="MLSID" style="font-size:12px; font-weight:normal; color:grey">MLS#' + data[i].AllListt[j].MLSID + '</span></td></tr></table></div>'
                                     + '<div class="col-sm-5"><table style="top: 15px; position: relative;">'
                                    + '<tr><td><span style="color:#ff5d26;font-weight:bold">' + bedrooms + '</span><span>  Bedrooms</span></td></tr>'
                                    + '<tr><td><span style="color:#ff5d26;font-weight:bold">' + bathrooms + '</span><span>  Bathrooms</span></td></tr>'
                                    + '<tr><td style="color:#ff5d26;font-weight:bold"><span>' + sqftAcres + '</span><span></span></td></tr>'
                                    + '</table></div>'
                                      + '<div class="col-sm-2"><img class="sideArrow" style="top:28px;float: right; position: relative;cursor:pointer; height:26px;" src="/img/lit_icon_btn.png" onclick="AgentFullDetailsView(\'' + AgentId + '\', \'' + data[i].AllListt[j].MLSID + '\')"></div>'
                                      + '</div>';
                $('#buyerdivinlistings').append(listings);
            });
        });
    }//Bind Pending Requests to Div afetr getting Data from GetAgentListings(userid) Method
    function VieworScheduleRequestTimings(pklists) {
        PK_ReqID = pklists;
        $.ajax({
            url: "/Agent/AgentShowings/GeTimingsbyPKeyList",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { PK_RequestShowingIDs: pklists },
            success: function (data) {
                getListingsOfRequests(pklists);
                $('#requestedDateTime').find('option').remove().end();
                $('#requestedDateTime').append('<option value="' + 0 + '">Select Date and Time</option>');
                $.each(data, function (i, item) {
                    $('#requestedDateTime').append($("<option></option>").attr("value", data[i].DATES).text(data[i].DATES));
                });
                $("#requestedDateTime").selectpicker("refresh");

                $("#ScheduleShowings_Popup").modal('show');
            }
        });
    }//Function to Get Scheduled timings requested by user based on sent Pkey_Requested ID's List with commas
    function getListingsOfRequests(pklists) {
        $.ajax({
            url: "/Agent/AgentShowings/GeListignsbyPKeyList",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { PK_RequestShowingIDs: pklists },
            success: function (data) {
                bindListingsforScheduledPopup(data);
            }
        });
    }//Function to get Listings based on Pkey_Requested to show them in ScheduleListing Popup
    var buyerfname, buyerlname, buyerphoto, buyerphoneno, buyerid;
    function bindListingsforScheduledPopup(data) {
        $("#SchedulePopup_Listingsdiv").empty();
        var PhotosURL = [], TotalImages = [];
        buyerfname = data[0].BuyerFirstName;
        buyerlname = data[0].BuyerLastName;
        buyerphoneno = data[0].BuyerPhoneNo;
        buyerphoto = '/img/addphotopic.png';
        $("#buyerName_schedulePopup").text(data[0].BuyerFirstName + ' ' + data[0].BuyerLastName)
        if (data[0].BuyerImage != null && data[0].BuyerImage != '') {
            buyerphoto = data[0].BuyerImage;
            $("#buyerPhoto_schedulePopup").attr('src', data[0].BuyerImage)
        }
        else {
            $("#buyerPhoto_schedulePopup").attr('src', buyerphoto)
        }
        $.each(data, function (i, item) {
            if (item.PRP_IMAGES != null) {
                TotalImages.push(item.PRP_IMAGES);
                if (TotalImages.length > 0)
                    PhotosURL = item.PRP_IMAGES.split(',');
                else
                    PhotosURL = item.PhotoLocation;
            }
            else{
                PhotosURL[0] = '/img/NoImage.png';
            }
            var ListingDetails = '<div class="col-sm-12" style="padding:0 0 0 0;margin-top:10px" id="' + item.MLSID + '">'
                                + '<div class="col-sm-10" id="" style="padding:0;border:1px solid #ff5d26;border-radius:5px;height:70px;box-shadow: #d6d3d3 1px 4px 9px 2px;">'
                                + '<div class="col-sm-2" style="height:68px;width:100px;line-height:15px;border-radius: 4px 0 0 4px;background: url(' + PhotosURL[0] + '); background-size: 100% 100%;"></div>'
                                + '<div class="col-sm-8" style="line-height:2;padding:10px;"><table><tr><td style="padding-left:10px;color:gray">MLS#' + item.MLSID + '</td></tr>'
                               + '<tr><td style="padding-left:10px;color:gray">' + item.PRP_ADDRESS + '</td></tr></table></div></div>'
                               + '<div class="col-sm-1" style="border-radius:5px;border:1px solid #ff5d26;height:70px;text-align: center;margin-left: 10px;width: 15%;box-shadow: #d6d3d3 1px 4px 9px 2px;">'
                               + '<div class="col-sm-12" style="padding:25px;"><a href="#" onclick="removeListing(' + item.MLSID + ',\'' +item.PRP_ADDRESS + '\')" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListingPopup" data-toggle="modal">Remove</a>'
                                + '</div></div></div>'
            $("#SchedulePopup_Listingsdiv").append(ListingDetails);
        });
    }//Function to bind Listings based on Pkeys in Schedule Popup(Step-1)
    $("#call_schedulePopup,#call_ConfirmPopup,#call_RoutingPopup").click(function () {
        PhoneDetails(buyerphoneno, buyerfname, buyerlname)
    })
    $("#chat_schedulePopup,#chat_ConfirmPopup,#chat_RoutingPopup").click(function () {
        creatConnection(buyerid, buyerfname, ' 1 ', buyerphoto, '  ');
    })
    //var searchresults
    var lid = "", removedMLSIDs = [], addedMLSIDs = [], PK_ReqID = "", SaveStage = "";
    $("#AddMLSIDBtn_SchedulePopup").click(function () {
        var Method = "", SearchedMLSID = $("#search_MLSID_Address").val().toString().split('-')[0];
        $.ajax({
            url: "/Customer/SearchFilter/GetFullDetails",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { MLSID: SearchedMLSID },
            success: function (data) {
                if (data.length > 0) {
                    addedMLSIDs.push(data[0].MLSNo)
                    $.each(data, function (i, item) {
                        
                        var PhotosURL = [], TotalImages = [];

                        if (data[i].PHOTOLOCATION != "" && data[i].PHOTOLOCATION != null)
                            var photo = data[i].PHOTOLOCATION.split(',')[0];
                        //if (item.PhotoLocation != null) {
                        //    TotalImages.push(item.PhotoLocation);
                        //    if (TotalImages.length > 0)
                        //        PhotosURL = item.PhotoLocation.split(',');
                        //    else
                        //        PhotosURL = item.PhotoLocation;
                        //}
                        var addr = item.Address + ', ' + item.GeoSecCity + ", " + item.GeoSubdiv + " " + item.GeoPostCd;
                        var ListingDetails = '<div class="col-sm-12" style="padding:0 0 0 0;margin-top:10px" id="' + item.MLSNo + '">'
                               + '<div class="col-sm-10" id="" style="padding:0;border:1px solid #ff5d26;border-radius:5px;height:70px;box-shadow: #d6d3d3 1px 4px 9px 2px;">'
                               + '<div class="col-sm-2" style="height:68px;width:100px;line-height:15px;border-radius: 4px 0 0 4px;background: url(' + photo + '); background-size: 100% 100%;"></div>'
                               + '<div class="col-sm-8" style="line-height:2;padding:10px;"><table><tr><td style="padding-left:10px;color:gray">MLS#' + item.MLSNo + '</td></tr>'
                              + '<tr><td style="padding-left:10px;color:gray">' + item.Address + ', ' + item.GeoSecCity + ", " + item.GeoSubdiv + " " + item.GeoPostCd + '</td></tr></table></div></div>'
                              + '<div class="col-sm-1" style="border-radius:5px;border:1px solid #ff5d26;height:70px;text-align: center;margin-left: 10px;width: 15%;box-shadow: #d6d3d3 1px 4px 9px 2px;">'
                              + '<div class="col-sm-12" style="padding:25px;"><a href="#" onclick="removeListing(' + item.MLSNo + ',\'' +addr + '\')" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListingPopup" data-toggle="modal">Remove</a>'
                               + '</div></div></div>'
                        $("#SchedulePopup_Listingsdiv").append(ListingDetails);
                        $("#search_MLSID_Address").val('')
                    })
                }
                else {
                    $("#errorMessageforMLSID").text('No Listing found on your search. Try Again!')
                    $("#search_MLSID_Address").focus()
                }
            },
        });
        // $("#errorMessageforMLSID").text('Please Enter Valid MLSID with prefix of #')
    })//Function to Add MLSIsd to Showing
    $(function () {
        $("#search_MLSID_Address").autocomplete({
            source: function (request, response) {
                if (request.term.indexOf('#') > -1)
                    //alert('#')
                    Method = "AgentSearchMLSIDGet?MLSID=";
                else
                    Method = "AgentSearchAddressGet?Address=";
                $.ajax({
                    url: '/Agent/AgentShowings/AddListingBySearch',
                    data: { SearchEle: request.term, Method: Method },
                    dataType: "json",
                    type: "GET",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {

                        if (data.length <= 0) {
                            $("#errorMessageforMLSID").text('No Listings Found')
                            $("#search_MLSID_Address").focus();
                        }
                        else {
                            $("#errorMessageforMLSID").text('')
                            response($.map(data, function (item) {
                                return { label: item.MLSNO + "-" + item.ADDRESS, value: item.MLSNO + "-" + item.ADDRESS };
                            }))
                        }
                    },
                    error: function (response) {
                        //alert(response.responseText);
                    },
                    failure: function (response) {
                        //alert(response.responseText);
                    }
                });
            },
            select: function (e, i) {
                // alert(i.item.value);
            },
            minLength: 2
        });
    });//Auto Complete Schedule Popup fr Add MLSID to Scheduled List
    function removeListing(id, address) {
        lid = id;
        $("#removinglistingaddress").text(address);
       
    }//Function to Remove  MLSID from Schedule popup and storem them in Array to remove perminantly after Save and Continue
    $("#RemoveListingYesBtn").click(function () {
        removedMLSIDs.push(lid);
        $(".scrolls_divs div").parent().find("#" + lid).addClass("displaynone");
        $("#RemoveListingPopup").modal('hide');
    });//RemoveListingYesBtn click event for Confiramtion of Remove
    $("#SaveContinueBtn_ScheduledPopup").click(function () {
        var sc_date, sc_fromtime, sc_totime;
        if ($("#choosenDate").val() != "") {
            sc_date = $("#choosenDate").val().split(',')[0];
            sc_fromtime = $("#choosenDate").val().split(',')[1].split('to')[0].trim();
            sc_totime = $("#choosenDate").val().split(',')[1].split('to')[1].trim();
        }
        else {
            sc_date = $("#requestedDateTime").val().split(',')[1];
            sc_fromtime = $("#requestedDateTime").val().split(',')[2].split('to')[0].trim();
            sc_totime = $("#requestedDateTime").val().split(',')[2].split('to')[1].trim();
        }
        var ScheduleObject1 = [PK_ReqID, removedMLSIDs.join(','), addedMLSIDs.join(','), sc_date, sc_fromtime, sc_totime, $("#dewelltimeval").text()];
        //  alert(ScheduleObject1)
        $.ajax({
            url: "/Agent/AgentShowings/ShceduleTimingsForRequest",
            type: "POST",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(ScheduleObject1),
            success: function (res) {
                if (res = "Success") {
                    GetAgentListings(buyerid, Status);
                    //getAgentBuyers('Requested');
                    getScheduledListingsin_ConfirmPopup(PK_ReqID)
                    //getAgentBuyers('Requested');
                    $("#ScheduleShowings_Popup").modal('hide');
                    //Getting Data in Confirm Map Showing Popup
                    // $("#Confirm_MapShowingPopup").modal('show');
                    removedMLSIDs = [], addedMLSIDs = [];
                }
                else {
                    alert("Error :" + res);
                }
            },
        });
    });//Save and continue Btn Functionality in Schedule Popup
    //Function to Bind Listings with Scheduled Time in Confirm  & Map showing Popup
    var var_location = "", map = "", mymarkers = [], icon, MarkersOrder = [];
    function getScheduledListingsin_ConfirmPopup(PkeyRequestId) {
        var photo;
        $.ajax({
            url: "/Agent/AgentShowings/GetInProcessListings_Popup2",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { PkeyRequestId: PkeyRequestId },
            success: function (data) {
                if (data.length > 0) {
                    initialMapLoad();
                    $.each(data, function (i, item) {
                        $("#sourcelistings").empty();
                        buyerid = data[0].BuyerID;
                        buyerfname = data[0].BuyerFirstName;
                        buyerlname = data[0].BuyerLastName;
                        buyerphoneno = data[0].BuyerPhoneNo;
                        buyerphoto = '/img/addphotopic.png';
                        $("#buyerName_ConfirmPopup").text(item.BuyerFirstName + ' ' + data[0].BuyerLastName)
                        if (data[0].BuyerImage != null && data[0].BuyerImage != '') {
                            buyerphoto = data[0].BuyerImage;
                            $("#buyerPhoto_ConfirmPopup").attr('src', data[0].BuyerImage)
                        }
                        $("#fromtime_ConfirmPopup").text(data[0].Schedule_FromTime.split(' ')[0]);
                        $("#timeformat_ConfirmPopup").text(data[0].Schedule_FromTime.split(' ')[1]);
                        $("#scheduled_date_ConfirmPopup").text(data[0].Schedule_Date);
                        $("#dewelltime_ConfirmPopup").text(data[0].AgentDwellTime);
                        $.each(data[i].AllListt, function (j, exp) {
                            
                            //  MarkersOrder.push(data[i].AllListt[j].GeoLat + ',' + data[i].AllListt[j].GeoLong)
                            photo = "/img/NoImage.png";
                            if (data[i].AllListt[j].PRP_IMAGES != "" && data[i].AllListt[j].PRP_IMAGES != null && data[i].AllListt[j].PRP_IMAGES != ",")
                            {
                                if (data[i].AllListt[j].PRP_IMAGES.indexOf(',')>-1)
                                    photo = data[i].AllListt[j].PRP_IMAGES.split(',')[0];
                                else {
                                    photo = data[i].AllListt[j].PRP_IMAGES;
                                }
                            }
                            else {
                                photo = "/img/NoImage.png";
                            }
                            var CompleredData = '<div class="col-sm-12" id="' + data[i].AllListt[j].MLSID + '" data-index="' + data[i].AllListt[j].GeoLat + ',' + data[i].AllListt[j].GeoLong + '" style="padding:5px;"><div class="col-sm-2" style="cursor:pointer;background-color:#ff5d26;width:13.5%;line-height:45px;text-align:center;border: 1px solid #ff5d26;border-radius: 5px;margin-right: 5px;padding:0" onclick="return SelectFirstList(\'' + data[i].AllListt[j].MLSID + '\',\'' + data[i].AllListt[j].PRP_ADDRESS + '\',\'' + photo + '\')"><label style="color:#fff;cursor:pointer;">Select</label></div>'
                              + '<div class="col-sm-10"  id="' + i + '" style="padding:0;border:1px solid #ff5d26;border-radius:5px;height:70px">'
                              + '<div class="col-sm-2" style="height:68px;width:100px;line-height:15px;border-radius: 4px 0 0 4px;background: url(' + photo + '); background-size: 100% 100%;"></div>'
                              + '<div class="col-sm-8" style="padding:10px"><table><tr><td style="color:gray;font-size:13px;">MLS#' + data[i].AllListt[j].MLSID + '</td></tr>'
                              + '<tr><td style="color:gray;font-size:13px;"><label class="">' + data[i].AllListt[j].PRP_ADDRESS + '</label></td></tr></table></div></div></div>';
                            $('#sourcelistings').append(CompleredData);
                            var_location = new google.maps.LatLng(data[i].AllListt[0].GeoLat, data[i].AllListt[0].GeoLong);
                            //var marker = new google.maps.Marker({
                            //    position: new google.maps.LatLng(data[i].AllListt[j].GeoLat, data[i].AllListt[j].GeoLong),
                            //    map: map,
                            //    icon: icon,
                            //   // anchor: new google.maps.Point(6, 12),
                            //    optimized: false,
                            //    label: "",
                            //    // title: item.MLSId,
                            //    id: data[i].AllListt[j].MLSID
                            //});
                            var marker = new MarkerWithLabel({
                                position: new google.maps.LatLng(data[i].AllListt[j].GeoLat, data[i].AllListt[j].GeoLong),
                                map: map,
                                labelContent: "",
                                labelAnchor: new google.maps.Point(5, 25),
                                labelClass: "labels", // the CSS class for the label
                                labelInBackground: false,
                                icon: icon,
                                id: data[i].AllListt[j].MLSID
                            });
                            mymarkers.push(marker);
                        });
                       
                        if (data[i].StartPoint != "") {
                           //alert(data[i].StartPoint)
                            $("#dummydiv").hide();
                            $("#destination_div").show();
                            $.each(data[i].AllListt, function (j, exp) {
                                if (data[i].StartPoint == data[i].AllListt[j].MLSID) {
                                    photo = "/img/NoImage.png";
                                    if (data[i].AllListt[j].PRP_IMAGES != "" && data[i].AllListt[j].PRP_IMAGES != null && data[i].AllListt[j].PRP_IMAGES != ",") {
                                        if (data[i].AllListt[j].PRP_IMAGES.indexOf(',') > -1)
                                            photo = data[i].AllListt[j].PRP_IMAGES.split(',')[0];
                                        else {
                                            photo = data[i].AllListt[j].PRP_IMAGES;
                                        }
                                    }
                                    else {
                                        photo = "/img/NoImage.png";
                                    }
                                    SelectFirstList(data[i].AllListt[j].MLSID, data[i].AllListt[j].PRP_ADDRESS, photo)
                                }
                            })
                        }//condotion to bind previous saved data if Start point is exist only
                        else {
                            $("#dummydiv").show();
                            $("#destination_div").hide();
                        }
                    })
                    $("#Confirm_MapShowingPopup").modal('show');
                }
            }
        });
    }//Get Listings in Confirm Popup based on PKeyREquested Id after Save&Exit in Step-1
    function initialMapLoad() {
        icon = {
            url: '/img/green_marker.png',
            //labelOrigin: new google.maps.Point(0, 15)
        };
        var_location = new google.maps.LatLng(19.0606917, 72.83624970000005);
        var mapOptions = {
            center: var_location,
            zoom: 8,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        map = new google.maps.Map($("#map_in_popup")[0], mapOptions);
    }//Initialinzing Map in Popup
    $('#Confirm_MapShowingPopup').on('shown.bs.modal', function () {
        google.maps.event.trigger(map, "resize");
        map.setCenter(var_location);
    });  //Event To Trigger MapLoad on popup open time
 
    //////////////////////
    originpoint = "", startpointMLSID = "";
    function SelectFirstList(lid, address, photo) {
        $("#save_exit_btn_ConfirmPopup").removeClass('btndisble').addClass('prev_btn');
        $('#save_exit_btn_ConfirmPopup').prop("disabled", false);
        $("#create_route_btn_ConfirmPopup").removeClass('btndisble').addClass('btnenable');
        // $("#create_route_btn_ConfirmPopup").addClass('btnenble')
        $('#create_route_btn_ConfirmPopup').prop("disabled", false);

        MarkersOrder = [];
        for (var k = 0; k < mymarkers.length; k++) {
            MarkersOrder.push(mymarkers[k].getPosition().lat() + ',' + mymarkers[k].getPosition().lng())
        }
        origin = $(".sourcediv div").parent().find("#" + lid).data('index')
        startpointMLSID = lid;
        //alert('origin ' + origin)
        //alert('Before  remove origing '+MarkersOrder)
        if ($.inArray(origin, MarkersOrder) > '-1') {
            MarkersOrder.splice($.inArray(origin, MarkersOrder), 1);
        }
        else {
            MarkersOrder.push(origin)
        }
        // $("#dewelltime_ConfirmPopup").text(MarkersOrder)
        //alert('Afeter removing oringin ' + MarkersOrder.join('----'))

        //  alert($(".sourcediv div").parent().get("#" + lid))
        $(".sourcediv div").parent().removeClass("displaynone");
        $(".sourcediv div").parent().find("#" + lid).addClass("displaynone");
        $("#dummydiv").hide();
        $("#firstMLSID_ConfirmPopup").text('MLS#' + lid)
        $("#firstAddress_ConfirmPopup").text(address)
        $('#firstListingPhoto_ConfirmPopup').css({ 'background-image': 'url(' + photo + ')' })
        $("#destination_div").show();
        for (var j = 0; j < mymarkers.length; j++) {
            if (mymarkers[j].get("id") == lid) {
                //mymarkers[j] = new MarkerWithLabel({
                //    icon: '/img/safety_icon.png'
                //});
                mymarkers[j].setIcon("/img/orange_dot_marker.png");
                //var label = mymarkers[j].getLabel();
                // label.color = "white";
                // mymarkers[j].setLabel(label);
                mymarkers[j].set('labelContent', '1');
                //mymarkers[j].setLable("1")
            }

            else {
                mymarkers[j].set('labelContent', '');
                mymarkers[j].setIcon("/img/green_marker.png");
            }
            //mymarkers[j] = new MarkerWithLabel({
            //    icon: '/img/green_marker.png'
            //});

        }
        // marker.setIcon("https://cdn3.iconfinder.com/data/icons/musthave/24/Stock%20Index%20Down.png");
    }//Function to Choose/Select 1st(Origin) Listig in Confirm Popup
    function bindPendingLists(data) {
        $('#buyerdivinlistings').empty();
        $('#buyerdivinlistings').append(mybuyer);
        var d1 = "", d2 = "", pkey = "";
        $.each(data, function (i, item) {
            var listings = "";
            var dates = '<span style="color:white;position:relative;top:5px; font-size:12px">&nbsp;' + data[i].AgentScheduleDate + '<label style="color:rgb(255, 159, 128)"></span>';
            var d = '<div class="col-sm-10" style="height:30px;background-color:#686868"><span style="top: 5px; color: rgb(255, 159, 128); position: relative;">Pending For: </span>' + dates + '</div>'
                + '<div class="col-sm-2" style="text-align:center;line-height:30px;background-color:#ff5d26;color:#fff;"><a href="#" style="text-decoration:none;" id="divs" onclick="return ManageListings_in_PendingTab(\'' + data[i].pk + '\',\'' + data[i].SaveStage + '\')">Manage</div>';
            $.each(data[i].AllListt, function (j, exp) {
                if (j == 0)
                    $('#buyerdivinlistings').append(d);
                if (j == data[i].AllListt.length - 1)
                    var startdiv = '<div class="col-sm-12" style="padding: 15px;">'
                else
                    var startdiv = '<div class="col-sm-12" style="padding: 15px;border-bottom: 2px solid #ff5d26;">'
                var imagepin = "", price = "";
                var bedrooms, bathrooms, sqftAcres;
                //var PhotosURL = [], TotalImages = [];
                //if (data[i].AllListt[j].PRP_IMAGES != null) {
                //    TotalImages.push(data[i].AllListt[j].PRP_IMAGES);
                //    if (TotalImages.length > 0)
                //        PhotosURL = data[i].AllListt[j].PRP_IMAGES.split(',');
                //    else
                //        PhotosURL = data[i].AllListt[j].PRP_IMAGES;
                //}
                var BtnPrevImgId = "Prev" + data[i].AllListt[j].MLSID;
                var BtnNextImgId = "Next" + data[i].AllListt[j].MLSID;
                var PrpImagesArray = []
                var DivImgId = "div_" + data[i].AllListt[j].MLSID;
                var PhotosURL = [], TotalImages = [];
                PrpImagesArray = [];
                if (data[i].AllListt[j].PRP_IMAGES != null && data[i].AllListt[j].PRP_IMAGES != 'null' && data[i].AllListt[j].PRP_IMAGES != '' && data[i].AllListt[j].PRP_IMAGES != ',') {
                    var c = data[i].AllListt[j].PHOTO_COUNT;
                    PrpImagesArray = data[i].AllListt[j].PRP_IMAGES.split(',');
                    TotalImages.push(data[i].AllListt[j].PRP_IMAGES);
                    if (TotalImages.length > 0)
                        PhotosURL = data[i].AllListt[j].PRP_IMAGES.split(',');
                    else
                        PhotosURL = data[i].AllListt[j].PRP_IMAGES;
                }
                else {
                    PhotosURL[0] = '/img/NoImage.png';
                }
                if (TotalImages.length > 0) {
                    photosdiv = '<div class="col-sm-2" style="height: 90px; position: relative; background-image: url(' + PhotosURL[0] + '); background-size: 100% 100%;" id="' + DivImgId + '">'
                                     + '<div class="col-sm-12" style="margin-top: 18%;padding: 7px;"><a href="#"><img src="/img/SliderBackArrow.png" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "-1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" width="21" height="29" alt="" style="margin-left: -20%;" id="' + BtnPrevImgId + '" hidden="hidden"/></a>'
                                     + '<a href="#"><img src="/img/SliderNextArrow.png" width="21" height="29" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" alt="" style="float: right;margin-right: -20%;" id="' + BtnNextImgId + '"   /></a></div></div>';
                }
                else {
                    photosdiv = '<div class="col-sm-2" style="height: 90px; position: relative; background-image: url(' + PhotosURL[0] + '); background-size: 100% 100%;" id="' + DivImgId + '">'
                                    + '<div class="col-sm-12" style="margin-top: 18%;padding: 7px;"><a href="#"><img src="/img/SliderBackArrow.png" onclick="PrpImageSlider(\'' + i + '\',\'' + "-1" + '\',\'' + DivImgId + '\',\'' + data[i].AllListt[j].MLSID + '\')" width="21" height="29" alt="" style="margin-left: -20%;" id="' + BtnPrevImgId + '" hidden="hidden"/></a>'
                                    + '<a href="#"><img src="/img/SliderNextArrow.png" width="21" height="29" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" alt="" style="float: right;margin-right: -20%;" id="' + BtnNextImgId + '" hidden="hidden"/></a></div></div>';
                }
                if (data[i].AllListt[j].Class == "Rental") {
                    price = "$ " + (data[i].AllListt[j].PRP_PRICE + "").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,") + "/mo";
                    if (data[i].AllListt[j].Is_Viewd == "YES")
                        imagepin = '<img src="/img/viewed_graypin.png" height="20" style="position:relative; top:-2px" />'
                    else
                        imagepin = '<img src="/img/gray_legendMenu.png" height="20" style="position:relative; top:-2px" />'
                }
                else {
                    price = "$ " + (data[i].AllListt[j].PRP_PRICE + "").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,");
                    if (data[i].AllListt[j].Status == "Active") {
                        if (data[i].AllListt[j].Is_Viewd == "YES")
                            imagepin = '<img src="/img/viewed_greenpin.png" height="20" style="position:relative; top:-2px" />'
                        else
                            imagepin = '<img src="/img/Green_legend_Menu.png" height="20" style="position:relative; top:-2px" />'
                    }
                    else if (data[i].AllListt[j].Status == "Pending") {
                        if (data[i].AllListt[j].Is_Viewd == "YES")
                            imagepin = '<img src="/img/yellow_legendMenu.png" height="20" style="position:relative; top:-2px;margin-left: -3px;" />'
                        else
                            imagepin = '<img src="/img/viewed_yellowpin.png" height="20" style="position:relative; top:-2px" />'
                    }
                }
                if (data[i].AllListt[j].Class == "Lots/Land") {
                    sqftAcres = data[i].AllListt[j].SQFT + ' acres';
                    bedrooms = "--";
                    bathrooms = "--";
                }
                else {
                    bedrooms = data[i].AllListt[j].BEDROOMS;
                    bathrooms = data[i].AllListt[j].BATHROOMS;
                    sqftAcres = data[i].AllListt[j].SQFT + ' sqft';
                }
                var callmade_dv = '<div class="col-sm-8 tooltiptailred" style="text-align:center;background-color:red;color:#fff;border-radius:0 0 5px 5px;height:25px;padding-top:5px">No</div>';
                var confirmed_div = '<div class="col-sm-8 tooltiptailred" style="background-color:red;color:#fff;border-radius:0 0 5px 5px;height:25px;padding-top:5px">No</div>';
                if (data[i].AllListt[j].Is_CallMade == "True") {
                    callmade_dv = '<div class="col-sm-8 tooltiptailgreen" style="text-align:center;background-color:green;color:#fff;border-radius:0 0 5px 5px;height:25px;padding-top:5px">Yes</div>';
                }
                if (data[i].AllListt[j].Is_Confirmed == "True") {
                    confirmed_div = '<div class="col-sm-8 tooltiptailgreen" style="background-color:green;color:#fff;border-radius:0 0 5px 5px;height:25px;padding-top:5px">Yes</div>';
                }
                var addr11 = data[i].AllListt[j].PRP_ADDRESS.split(',')[1];
                var addr12 = (data[i].AllListt[j].PRP_ADDRESS.split(',')[2] != undefined) ? "," + data[i].AllListt[j].PRP_ADDRESS.split(',')[2] : "";
                //'<div class="col-sm-12" style="padding: 15px;border-bottom: 2px solid #ff5d26;">'
                var PendingRequests = startdiv + photosdiv
                                    + '<div class="col-sm-3" style="padding-left:25px;top:5px;"><table style="line-height:15px;border-right: 1px solid lightgray;width:100%">'
                                    + '<tr><td style="">' + imagepin + '<span id="Rate" style="color:#ff5d26;font-size:16px; font-weight:bold; position:relative; "><span style="position: relative;padding-left:5px">' + price + '</span></span></td></tr>'
                                    + '<tr><td style="padding-top:10px"><span id="AddLineOne" style="font-weight:bold">' + data[i].AllListt[j].PRP_ADDRESS.split(',')[0] + '</span></td></tr><tr><td style=""><span style="font-size:12px; font-weight:bold">' + addr11 + '' + addr12 + '</span></td></tr></tr>'
                                    + '<tr><td style="padding-top:5px"><span id="MLSID" style="font-size:12px; font-weight:normal; color:grey">MLS#' + data[i].AllListt[j].MLSID + '</span></td></tr></table></div>'
                                     + '<div class="col-sm-2"><table style="top: 15px; position: relative;">'
                                    + '<tr><td><span style="color:#ff5d26;font-weight:bold">' + bedrooms + '</span><span>  Bedrooms</span></td></tr>'
                                    + '<tr><td><span style="color:#ff5d26;font-weight:bold">' + bathrooms + '</span><span>  Bathrooms</span></td></tr>'
                                    + '<tr><td style="color:#ff5d26;font-weight:bold"><span>' + sqftAcres + '</span><span></span></td></tr>'
                                    + '</table></div>'
                                    + '<div class="col-sm-2" style="left:25px;top:11px"><div class="col-sm-8"  class="" style="padding:0;text-align:center;height:25px;border-radius:5px 5px 0 0; background-color:#dad9d9;">Call Made</div>'
                                    + callmade_dv + '</div>'
                                    + '<div class="col-sm-2" style="text-align:center;top:11px"><div class="col-sm-8"  class="" style="padding:0;height:25px;border-radius:5px 5px 0 0; background-color:#dad9d9;">Confirmed</div>'
                                    + confirmed_div + '</div>'
                                      + '<div class="col-sm-1"><img class="sideArrow" style="top:28px;float: right; position: relative; height:26px;cursor:pointer;" src="/img/lit_icon_btn.png" onclick="AgentFullDetailsView(\'' + AgentId + '\', \'' + data[i].AllListt[j].MLSID + '\')"></div>'
                                      + '</div>';
                $('#buyerdivinlistings').append(PendingRequests);
            });
        });
    }//Function to Bind Pending Lists after Completing Step -1 Save from Schedule Popup
    function ManageListings_in_PendingTab(RequestId, SaveStage) {
        PK_ReqID = RequestId, SaveStage = SaveStage;
        if (SaveStage == "1") {
            $("#dummydiv").show();
            $("#destination_div").hide();
            //$('#PreviusBtn_ConfirmPopup')[0].click();
            getScheduledListingsin_ConfirmPopup(RequestId)
        }
        else if (SaveStage == "2") {
            $("#dummydiv").hide();
            $("#destination_div").show();
            getScheduledListingsin_ConfirmPopup(RequestId)
        }
        else if (SaveStage == "3") {
            $("#dummydiv").hide();
            $("#destination_div").show();
            bindScheduledListings_in_RoutingPopup();
        }
    }//Manage Button Functionality based on Last SavedStage(showing Popups by Last Save)
    $('#PreviusBtn_ConfirmPopup').click(function () {
        $('#Confirm_MapShowingPopup').modal('hide')
        $.ajax({
            url: "/Agent/AgentShowings/GetInProcessListings_Popup2",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { PkeyRequestId: PK_ReqID },
            success: function (data) {
                bindListings_From_ConfirmPopup_PreviusBtn(data);
                $('#ScheduleShowings_Popup').modal('show')
            }
        });
    })//Previus Buttom Functionality in Confirm  Popup to Schedule Popup
    function bindListings_From_ConfirmPopup_PreviusBtn(data) {
        $("#SchedulePopup_Listingsdiv").empty();
        $.each(data, function (i, item) {
            var PhotosURL = [], TotalImages = [];
            buyerfname = data[i].BuyerFirstName;
            buyerlname = data[i].BuyerLastName;
            buyerphoneno = data[i].BuyerPhoneNo;
            buyerphoto = '/img/addphotopic.png';
            $("#buyerName_schedulePopup").text(data[i].BuyerFirstName + ' ' + data[i].BuyerLastName);
            if (data[i].BuyerImage != null && data[i].BuyerImage != '') {
                buyerphoto = data[i].BuyerImage;
                $("#buyerPhoto_schedulePopup").attr('src', data[i].BuyerImage)
            }
            $('#requestedDateTime').find('option').remove().end();
            var d1 = convertDate(data[i].Schedule_Date)
            var d2 = d1 + data[i].Schedule_FromTime + " to " + data[i].Schedule_ToTime;
            $('#requestedDateTime').append($("<option></option>").attr("value", d2).text(d2));
            //alert(convertDate(data[i].Schedule_Date))
            $('#dewelltimeval').text(data[i].AgentDwellTime);
            $('#slider').slider('value', data[i].AgentDwellTime);
            $("#requestedDateTime").selectpicker("refresh");
            $("#SaveContinueBtn_ScheduledPopup").addClass('btnenable')
            $('#SaveContinueBtn_ScheduledPopup').prop("disabled", false);
            $('#selecteddatediv').hide();
            $('#chooseCustomDateBtn').show();
            $.each(data[i].AllListt, function (j, exp) {
                if (data[i].AllListt[j].PRP_IMAGES != null) {
                    TotalImages.push(data[i].AllListt[j].PRP_IMAGES);
                    if (TotalImages.length > 0)
                        PhotosURL = data[i].AllListt[j].PRP_IMAGES.split(',');
                    else
                        PhotosURL = data[i].AllListt[j].PRP_IMAGES;
                }
                var ListingDetails = '<div class="col-sm-12" style="padding:0 0 0 0;margin-top:10px" id="' + data[i].AllListt[j].MLSID + '">'
                                  + '<div class="col-sm-10" id="" style="padding:0;border:1px solid #ff5d26;border-radius:5px;height:70px;box-shadow: #d6d3d3 1px 4px 9px 2px;">'
                                  + '<div class="col-sm-2" style="height:68px;width:100px;line-height:15px;border-radius: 4px 0 0 4px;background: url(' + PhotosURL[0] + '); background-size: 100% 100%;"></div>'
                                  + '<div class="col-sm-8" style="line-height:2;padding:10px;"><table><tr><td style="padding-left:10px;color:gray">MLS#' + data[i].AllListt[j].MLSID + '</td></tr>'
                                 + '<tr><td style="padding-left:10px;color:gray">' + data[i].AllListt[j].PRP_ADDRESS + '</td></tr></table></div></div>'
                                 + '<div class="col-sm-1" style="border-radius:5px;border:1px solid #ff5d26;height:70px;text-align: center;margin-left: 10px;width: 15%;box-shadow: #d6d3d3 1px 4px 9px 2px;">'
                                 + '<div class="col-sm-12" style="padding:25px;"><a href="#" onclick="removeListing(\'' + data[i].AllListt[j].MLSID + '\',\'' + data[i].AllListt[j].PRP_ADDRESS + '\')" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListingPopup" data-toggle="modal">Remove</a>'
                                  + '</div></div></div>'
                $("#SchedulePopup_Listingsdiv").append(ListingDetails);
            });
        });
    }//Bind Listings in Schedule Popup when Clicked Previous Button in Confirm Popup
    function convertDate(d) {
        var day = d.split(',')[0]
        //Saturday, Jan. 6, 2018",
        var months = {
            Jan: "01",
            Feb: "02",
            Mar: "03",
            Apr: "04",
            May: "05",
            Jun: "06",
            Jul: "07",
            Aug: "08",
            Sep: "09",
            Oct: "10",
            Nov: "11",
            Dec: "12"
        }
        var m = months[d.split(' ')[1].split('.')[0]];
        var date = m + "/" + d.split(' ')[2].split(',')[0] + "/" + d.split(' ')[3];
        //alert(d.split(' ')[1].split('.')[0]+"----"+m)
        return day + ", " + date + ", ";
    }//Fucntion to Convert Date to the Requested format for Dropdwon in Scedule Popup
    function saveStartPointin_ConfirmPopup() {
        $.ajax({
            url: "/Agent/AgentShowings/SaveStartPoint_ConfirmPopup",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { PK_RequestShowingID: PK_ReqID, StartingPoint: startpointMLSID },
            success: function (data) {
                if (data == "Success") {
                    GetAgentListings(buyerid, "Pending");
                    //$('#Confirm_MapShowingPopup').modal('hide')
                }
            },
        });
    }
    $("#save_exit_btn_ConfirmPopup").click(function () {
        // alert(startpointMLSID + "---" + PK_ReqID)
        saveStartPointin_ConfirmPopup();
        $('#Confirm_MapShowingPopup').modal('hide');
    });//Event to Save Start point when Save&Exit Clicked in Confirm Popup
    $("#PreviusBtn_RoutingPopupp").click(function () {
        $('#RoutingPopup').modal('hide')
        getScheduledListingsin_ConfirmPopup(PK_ReqID);
    });
    $("#create_route_btn_ConfirmPopup").click(function () {
        saveStartPointin_ConfirmPopup();
        $('#Confirm_MapShowingPopup').modal('hide');
        setTimeout(bindRoutesIn_RoutingPopup, 1000);
        // bindRoutesIn_RoutingPopup();
    });
    var map_in_Routing, Var_Location_Routing;
    function initialMapLoad_RoutingPopup() {
        icon = {
            url: '/img/green_marker.png',
            anchor: new google.maps.Point(40, 32)
        };

        Var_Location_Routing = new google.maps.LatLng(19.0606917, 72.83624970000005);
        var mapOptions = {
            center: Var_Location_Routing,
            zoom: 8,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        map_in_Routing = new google.maps.Map($("#map_in_RoutingPopup")[0], mapOptions);

    }//Initialinzing Map in Popup
    $('#RoutingPopup').on('shown.bs.modal', function () {
        google.maps.event.trigger(map_in_Routing, "resize");
        map_in_Routing.setCenter(var_location);
    });  //Event To Trigger MapLoad on popup open time
    var routeMarkers = [];
    var route_Dest_Addresses = [], sourceAddress = "";
    var Sceduled_Data_List = [];
    function bindRoutesIn_RoutingPopup() {
        var photo;
        routeAddresses = [], sourceAddress = "", routeMarkers = [], Sceduled_Data_List = []
        $.ajax({
            url: "/Agent/AgentShowings/GetInProcessListings_Popup2",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { PkeyRequestId: PK_ReqID },
            success: function (data) {
                if (data.length > 0) {
                    route_Dest_Addresses = [];
                    var arrivaltime, mins, hours, form;
                    var setAppointmnetfromTime, setAppointmnettoTime;
                    var firstListing = "";
                    initialMapLoad_RoutingPopup();
                    $('#RoutedListings_div').empty();
                    $.each(data, function (i, item) {
                        var m = 2;
                        buyerid = data[0].BuyerID;
                        buyerfname = data[0].BuyerFirstName;
                        buyerlname = data[0].BuyerLastName;
                        buyerphoneno = data[0].BuyerPhoneNo;
                        buyerphoto = '/img/addphotopic.png';
                        $("#buyerName_RoutingPopup").text(item.BuyerFirstName + ' ' + data[0].BuyerLastName)
                        if (data[0].BuyerImage != null && data[0].BuyerImage != '') {
                            buyerphoto = data[0].BuyerImage;
                            $("#buyerPhoto_RoutingPopup").attr('src', data[0].BuyerImage)
                        }
                        $("#fromtime_RoutingPopup").text(data[0].Schedule_FromTime.split(' ')[0]);
                        $("#timeformat_RoutingPopup").text(data[0].Schedule_FromTime.split(' ')[1]);
                        $("#scheduled_date_RoutingPopup").text(data[0].Schedule_Date);
                        $("#dewelltime_RoutingPopup").text(data[0].AgentDwellTime);
                        $.each(data[i].AllListt, function (j, exp) {
                            //  MarkersOrder.push(data[i].AllListt[j].GeoLat + ',' + data[i].AllListt[j].GeoLong)
                          
                            var_location = new google.maps.LatLng(data[i].AllListt[0].GeoLat, data[i].AllListt[0].GeoLong);
                            Var_Location_Routing = var_location;
                            if (data[i].StartPoint == data[i].AllListt[j].MLSID) {

                                icon = {
                                    url: '/img/safety_icon.png',
                                };
                                var marker = new MarkerWithLabel({
                                    position: new google.maps.LatLng(data[i].AllListt[j].GeoLat, data[i].AllListt[j].GeoLong),
                                    map: map_in_Routing,
                                    labelContent: "1",
                                    labelAnchor: new google.maps.Point(5, 25),
                                    labelClass: "labels", // the CSS class for the label
                                    labelInBackground: false,
                                    icon: icon,
                                    id: data[i].AllListt[j].MLSID,
                                    title: data[i].AllListt[j].PRP_ADDRESS
                                });
                            }
                            else {

                                icon = {
                                    url: '/img/safety_icon.png',
                                };
                                var marker = new MarkerWithLabel({
                                    position: new google.maps.LatLng(data[i].AllListt[j].GeoLat, data[i].AllListt[j].GeoLong),
                                    map: map_in_Routing,
                                    labelContent: "" + m,
                                    labelAnchor: new google.maps.Point(5, 25),
                                    labelClass: "labels", // the CSS class for the label
                                    labelInBackground: false,
                                    icon: icon,
                                    id: data[i].AllListt[j].MLSID,
                                    title: data[i].AllListt[j].PRP_ADDRESS
                                });
                                m = m + 1;
                            }

                            routeMarkers.push(marker);
                            if (data[i].StartPoint == data[i].AllListt[j].MLSID) {
                                sourceAddress = data[i].AllListt[j].PRP_ADDRESS;
                            }
                            route_Dest_Addresses.push(data[i].AllListt[j].PRP_ADDRESS)
                        });
                    })//Loop to Generate Directions
                    setTimeout(CalculateTime_DrawRoute, 500);
                    $.each(data, function (i, item) {
                        $.each(data[i].AllListt, function (j, exp) {
                            if (data[i].StartPoint == data[i].AllListt[j].MLSID) {
                                photo = "/img/NoImage.png";
                                if (data[i].AllListt[j].PRP_IMAGES != "" && data[i].AllListt[j].PRP_IMAGES != null) {
                                    if (data[i].AllListt[j].PRP_IMAGES.indexOf(',') > -1)
                                        photo = data[i].AllListt[j].PRP_IMAGES.split(',')[0];
                                    else
                                        photo = data[i].AllListt[j].PRP_IMAGES;
                                }
                                else {
                                    photo = "/img/NoImage.png";
                                }

                                arrivaltime = data[i].Schedule_FromTime;
                                mins = data[i].Schedule_FromTime.split(' ')[0].split(':')[1];
                                hours = data[i].Schedule_FromTime.split(' ')[0].split(':')[0];
                                form = data[i].Schedule_FromTime.split(' ')[1];

                                if (mins < 15) {
                                    mins = 00;
                                } else if (mins < 30) {
                                    mins = 15;
                                } else if (mins < 45) {
                                    mins = 30;
                                } else {
                                    mins = 45;
                                }
                                setAppointmnetfromTime = hours + ":" + (mins < 10 ? '0' + mins : mins) + " " + form;
                                if (hours < 12) {
                                    if (parseInt(hours) + 1 >= 12)
                                        form = form == "AM" ? 'PM' : "AM";
                                    setAppointmnettoTime = (parseInt(hours) + 1) + ":" + (mins < 10 ? '0' + mins : mins) + " " + form;
                                }
                                else if (hours == 12) {
                                    setAppointmnettoTime = "01" + ":" + (mins < 10 ? '0' + mins : mins) + " " + form;
                                }
                                //else {
                                //    if (hours != 12) {
                                //        if (form == 'AM')
                                //            form = 'PM'
                                //        else
                                //            form = 'AM'     
                                //    }
                                   
                                //    setAppointmnettoTime = 01 + ":" + (mins < 10 ? '0' + mins : mins) + " " + form;
                                //}
                               // arrivaltime = setAppointmnetfromTime;
                                var iscallmadecheckbox = '<input type="checkbox" class="orange" id="' + data[i].AllListt[j].MLSID + 'callmade" style="height:20px;width:30px;" onclick="return checkIsCallMade(\'' + data[i].AllListt[j].MLSID + '\')"/>';
                                var isconfirmedcheckbox = '<input type="checkbox" class="orange" style="height:20px;width:30px;" id="' + data[i].AllListt[j].MLSID + 'confirm" onclick="return checkIsConfirm(\'' + data[i].AllListt[j].MLSID + '\')"/>';
                                if (data[i].AllListt[j].IsCallMade == "true") {
                                    iscallmadecheckbox = '<input type="checkbox" class="orange" id="' + data[i].AllListt[j].MLSID + 'callmade" style="height:20px;width:30px;" onclick="return checkIsCallMade(\'' + data[i].AllListt[j].MLSID + '\')" checked/>';
                                }
                                if (data[i].AllListt[j].IsConform == "true") {
                                    isconfirmedcheckbox = '<input type="checkbox" class="orange" style="height:20px;width:30px;" id="' + data[i].AllListt[j].MLSID + 'confirm" onclick="return checkIsConfirm(\'' + data[i].AllListt[j].MLSID + '\')" checked/>';
                                }
                                //overflow: hidden;white-space: nowrap;text-overflow: ellipsis;
                                firstListing = '<div id="' + data[i].AllListt[j].MLSID + '"><div class="col-sm-12 routing_Listings"  style="text-align:right;font-weight:bold"><label class="labelorange">Routed Arrival Time:</label>'
                                                   + ' <span style="margin-left:10px;">' + arrivaltime + '</span></div>'
                                                   + '<div clas="col-sm-12"><div class="col-sm-1" style="line-height:50px;text-align:center"><span class="badge" style="font-size:18px;border-radius:15px;padding:6px 11px;background-color:#ff5d26;color:#fff">1</span> </div>'
                                                   + '<div class="col-sm-11"><div class="col-sm-3" style="height:70px;line-height:15px;border-radius: 4px 0 0 4px;background: url(' + photo + '); background-size: 100% 100%;"></div>'
                                                   + '<div class="col-sm-9" style="border:1px solid #ff5d26;height:70px;padding:10px"><div style="margin-top:5px">MLS#' + data[i].AllListt[j].MLSID + '</div>'
                                                   + '<div class="textlimit" style="margin-top: 5px;">' + data[i].AllListt[j].PRP_ADDRESS + '</div></div>'
                                                   + '<div class="col-sm-3" style="display:none;border:1px solid #ff5d26;line-height: 50px;text-align: center;border-radius: 0 4px 4px 0;cursor:pointer">'
                                                   + '<a href="#" onclick="removeListing_RoutingPopup(' + data[i].AllListt[j].MLSID + ')" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListing_RoutingPopup" data-toggle="modal">Remove</a></div></div></div>'
                                                   + '<div class="col-sm-1">&nbsp;</div><div class="col-sm-10" style="background-color:lightgray;font-weight:bold;margin-left:17px;border-radius: 0 0 5px 5px;height: 25px;padding-top:3px">'
                                                   + 'Set Appointment time for:&nbsp;&nbsp;<img src="/img/watchh.png" style="margin-bottom:0" />&nbsp;<label id="fromtime_RoutingPopup" style="font-weight:bold">' + setAppointmnetfromTime + '</label>'
                                                   + '&nbsp;<lable class="labelorange">to</lable>&nbsp;<label id="totime_RoutingPopup" style="font-weight:bold">' + setAppointmnettoTime + '</label></div>'
                                                   + '<div class="col-sm-12" style="text-align:center;padding:10px">' + iscallmadecheckbox + '<label>Call Made</label>&nbsp;&nbsp;'
                                                   + isconfirmedcheckbox + '<label>Confirm</label></div>'
                                                   + '<div class="col-sm-1">&nbsp;</div>'
                                                   + '<div onclick="Showing_Shedule_Instructions(\'' + data[i].AllListt[j].MLSID + '\',\'' + data[i].AllListt[j].PRP_ADDRESS + '\',\'' + photo + '\',\'' + setAppointmnetfromTime + '\',\'' + setAppointmnettoTime + '\',\'' + data[i].AllListt[j].Instructions + '\',\'' + data[i].AllListt[j].WhoToContact + '\')" class="col-sm-10" style="margin-bottom: 10px;background-color:#ff5d26;color:#fff;font-size:15px;margin-left:15px;border-radius: 5px;height: 30px;padding-top:5px;text-align:center;cursor:pointer">'
                                                   + ' Schedule this Showing</div></div>';
                                Sceduled_Data_List.push({
                                    MLSID: data[i].AllListt[j].MLSID,
                                    ROUTED_TIME: arrivaltime,
                                    START_TIME: setAppointmnetfromTime,
                                    END_TIME: setAppointmnettoTime,
                                    IS_CALLMADE: false,
                                    IS_CONFIRMED: false,
                                })
                            }
                            setAppointmnetfromTime = arrivaltime;
                            //$('#RoutedListings_div').prepend(firstListing);
                        });
                    });//Loop to Bind First Listing(Source)
                    $.each(data, function (i, item) {
                        var k = 0, m = 2;
                        $.each(data[i].AllListt, function (j, ext) {
                            setTimeout(function () {
                                photo = "/img/NoImage.png";
                                if (data[i].AllListt[j].PRP_IMAGES != "" && data[i].AllListt[j].PRP_IMAGES != null) {
                                    if (data[i].AllListt[j].PRP_IMAGES.indexOf(',') > -1)
                                        photo = data[i].AllListt[j].PRP_IMAGES.split(',')[0];
                                    else
                                        photo = data[i].AllListt[j].PRP_IMAGES;
                                }
                                else {
                                    photo = "/img/NoImage.png";
                                }
                                if (data[i].StartPoint != data[i].AllListt[j].MLSID) {
                                    mins = setAppointmnetfromTime.split(' ')[0].split(':')[1];
                                    hours = setAppointmnetfromTime.split(' ')[0].split(':')[0];
                                    form = setAppointmnetfromTime.split(' ')[1];
                                    var newmins = parseInt(mins) + parseInt(data[i].AgentDwellTime) + parseInt(traveltimes[k]);
                                    var hm = timeConvert(newmins);
                                    hours = (parseInt(hours) + parseInt(hm.split('-')[0]));
                                    if (hours >= 12) {
                                        if (arrivaltime.split(' ')[0].split(':')[0]!=12)
                                        form = form == "AM" ? 'PM' : "AM";
                                        hours=hours - 12
                                    }
                                    mins = parseInt(hm.split('-')[1]);
                                    var ampmarrival = getTwentyFourHourTime(hours + ':' + mins + ' ' + form);
                                    console.log(ampmarrival)
                                    arrivaltime = new Date('7/10/2013 ' + ampmarrival).toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/, "$1$3");
                                     if (mins < 15) {
                                        mins = 00;
                                    } else if (mins < 30) {
                                        mins = 15;
                                    } else if (mins < 45) {
                                        mins = 30;
                                    } else {
                                        mins = 45;
                                    }
                                     var ampmsetaptfrom = getTwentyFourHourTime(hours + ':' + mins + ' ' + form);
                                     setAppointmnetfromTime = new Date('7/10/2013 ' +ampmsetaptfrom).toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/, "$1$3");
                                    setAppointmnettoTime = '';
                                    hours = parseInt(hours) + 1;
                                    if (hours >= 12) {
                                        if (arrivaltime.split(' ')[0].split(':')[0] != 12)
                                            form = form == "AM" ? 'PM' : "AM";
                                        hours = hours - 12
                                    }
                                    var ampmsetaptto = getTwentyFourHourTime(hours + ':' + mins + ' ' + form);
                                    setAppointmnettoTime = new Date('7/10/2013 ' + ampmsetaptto).toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/, "$1$3");

                                    var iscallmadecheckbox = '<input type="checkbox" class="orange" id="' + data[i].AllListt[j].MLSID + 'callmade" style="height:20px;width:30px;" onclick="return checkIsCallMade(\'' + data[i].AllListt[j].MLSID + '\')"/>';
                                    var isconfirmedcheckbox = '<input type="checkbox" class="orange" style="height:20px;width:30px;" id="' + data[i].AllListt[j].MLSID + 'confirm" onclick="return checkIsConfirm(\'' + data[i].AllListt[j].MLSID + '\')"/>';
                                    if (data[i].AllListt[j].IsCallMade == "true") {
                                        iscallmadecheckbox = '<input type="checkbox" class="orange" id="' + data[i].AllListt[j].MLSID + 'callmade" style="height:20px;width:30px;" onclick="return checkIsCallMade(\'' + data[i].AllListt[j].MLSID + '\')" checked/>';
                                    }
                                    if (data[i].AllListt[j].IsConform == "true") {
                                        isconfirmedcheckbox = '<input type="checkbox" class="orange" style="height:20px;width:30px;" id="' + data[i].AllListt[j].MLSID + 'confirm" onclick="return checkIsConfirm(\'' + data[i].AllListt[j].MLSID + '\')" checked/>';
                                    }
                                    var ListData = '<div id="' + data[i].AllListt[j].MLSID + '"> <div class="col-sm-12 routing_Listings" id="' + data[i].AllListt[j].MLSID + '" style="text-align:right;font-weight:bold"><label class="labelorange">Routed Arrival Time:</label>'
                                                    + ' <span style="margin-left:10px;">' + arrivaltime + '</span></div>'
                                                    + '<div clas="col-sm-12"><div class="col-sm-1" style="line-height:50px;text-align:center"><span class="badge" style="font-size:18px;border-radius:15px;padding:6px 11px;background-color:#B4D200;color:#fff">' + (m) + '</span> </div>'
                                                    + '<div class="col-sm-11"><div class="col-sm-3" style="height:70px;line-height:15px;border-radius: 4px 0 0 4px;background: url(' + photo + '); background-size: 100% 100%;"></div>'
                                                    + '<div class="col-sm-9" style="border:1px solid #ff5d26;height:70px;padding:10px"><div style="margin-top:5px">MLS#' + data[i].AllListt[j].MLSID + '</div>'
                                                    + '<div style="margin-top: 5px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">' + data[i].AllListt[j].PRP_ADDRESS + '</div></div>'
                                                    //+ '<div class="col-sm-3" style="border:1px solid #ff5d26;line-height: 50px;text-align: center;border-radius: 0 4px 4px 0;cursor:pointer">'
                                                    //+ '<a href="#" onclick="removeListing_RoutingPopup(' + data[i].AllListt[j].MLSID + ')" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListing_RoutingPopup" data-toggle="modal">Remove</a></div></div></div>'
                                                    + '<div class="col-sm-12" style="background-color:lightgray;font-weight:bold;margin-left:0;border-radius: 0 0 5px 5px;height: 25px;padding-top:3px">'
                                                    + 'Set Appointment time for:&nbsp;&nbsp;<img src="/img/watchh.png" style="margin-bottom:0" />&nbsp;<label id="fromtime_RoutingPopup" style="font-weight:bold">' + setAppointmnetfromTime + '</label>'
                                                    + '&nbsp;<lable class="labelorange">to</lable>&nbsp;<label id="totime_RoutingPopup" style="font-weight:bold">' + setAppointmnettoTime + '</label></div>'
                                                    + '<div class="col-sm-12" style="text-align:center;padding:10px">' + iscallmadecheckbox + '<label>Call Made</label>&nbsp;&nbsp;'
                                                    + isconfirmedcheckbox + '<label>Confirm</label></div>'
                                                    //+ '<div class="col-sm-1">&nbsp;</div>'
                                                    + '<div onclick="Showing_Shedule_Instructions(\'' + data[i].AllListt[j].MLSID + '\',\'' + data[i].AllListt[j].PRP_ADDRESS + '\',\'' + photo + '\',\'' + setAppointmnetfromTime + '\',\'' + setAppointmnettoTime + '\',\'' + data[i].AllListt[j].Instructions + '\',\'' + data[i].AllListt[j].WhoToContact + '\')" class="col-sm-12" style="margin-bottom: 10px;background-color:#ff5d26;color:#fff;font-size:15px;margin-left:0px;border-radius: 5px;height: 30px;padding-top:5px;text-align:center;cursor:pointer">'
                                                    + ' Shedule this Showing</div></div>';
                                    $('#RoutedListings_div').append(ListData);
                                    k++; m++;
                                    Sceduled_Data_List.push({
                                        MLSID: data[i].AllListt[j].MLSID,
                                        ROUTED_TIME: arrivaltime,
                                        START_TIME: setAppointmnetfromTime,
                                        END_TIME: setAppointmnettoTime,
                                        IS_CALLMADE: false,
                                        IS_CONFIRMED: false,
                                    })
                                }
                               setAppointmnetfromTime = arrivaltime;
                            }, 3000)

                        })
                    });//Loop to destinations and calculate Routing Times and SCheduled Timings
                    $('#RoutedListings_div').prepend(firstListing);
                    //alert(routeAddresses.length)
                    //Routes();
                    $("#RoutingPopup").modal('show');
                    // setTimeout(getSceduledData, 2100);
                }
            }
        });
    }//Method to bind pending listings in routing poppup
    function getTwentyFourHourTime(amPmString) {
        var d = new Date("1/1/2013 " + amPmString);
        return d.getHours() + ':' + d.getMinutes();
    }
    function bindScheduledListings_in_RoutingPopup() {
        var photo;
        routeAddresses = [], sourceAddress = "", routeMarkers = [], Sceduled_Data_List = []
        $.ajax({
            url: "/Agent/AgentShowings/GetInProcessListings_Popup2",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { PkeyRequestId: PK_ReqID },
            success: function (data) {
                if (data.length > 0) {
                    var arrivaltime, mins, hours, form;
                    var setAppointmnetfromTime, setAppointmnettoTime;
                    var firstListing = "";
                    initialMapLoad_RoutingPopup();
                    $('#RoutedListings_div').empty();
                    $.each(data, function (i, item) {
                        var m = 2;
                        buyerid = data[0].BuyerID;
                        buyerfname = data[0].BuyerFirstName;
                        buyerlname = data[0].BuyerLastName;
                        buyerphoneno = data[0].BuyerPhoneNo;
                        buyerphoto = '/img/addphotopic.png';
                        $("#buyerName_RoutingPopup").text(item.BuyerFirstName + ' ' + data[0].BuyerLastName)
                        if (data[0].BuyerImage != null && data[0].BuyerImage != '') {
                            buyerphoto = data[0].BuyerImage;
                            $("#buyerPhoto_RoutingPopup").attr('src', data[0].BuyerImage)
                        }
                        $("#fromtime_RoutingPopup").text(data[0].Schedule_FromTime.split(' ')[0]);
                        $("#timeformat_RoutingPopup").text(data[0].Schedule_FromTime.split(' ')[1]);
                        $("#scheduled_date_RoutingPopup").text(data[0].Schedule_Date);
                        $("#dewelltime_RoutingPopup").text(data[0].AgentDwellTime);
                        $.each(data[i].AllListt, function (j, exp) {
                            //  MarkersOrder.push(data[i].AllListt[j].GeoLat + ',' + data[i].AllListt[j].GeoLong)
                            photo = "/img/NoImage.png";
                            if (data[i].AllListt[j].PRP_IMAGES != "" && data[i].AllListt[j].PRP_IMAGES != null)
                                photo = data[i].AllListt[j].PRP_IMAGES.split(',')[0];
                            var iscallmadecheckbox = '<input type="checkbox" class="orange" id="' + data[i].AllListt[j].MLSID + 'callmade" style="height:20px;width:30px;" onclick="return checkIsCallMade(\'' + data[i].AllListt[j].MLSID + '\')"/>';
                            var isconfirmedcheckbox = '<input type="checkbox" class="orange" style="height:20px;width:30px;" id="' + data[i].AllListt[j].MLSID + 'confirm" onclick="return checkIsConfirm(\'' + data[i].AllListt[j].MLSID + '\')"/>';
                            if (data[i].AllListt[j].IsCallMade == "true") {
                                iscallmadecheckbox = '<input type="checkbox" class="orange" id="' + data[i].AllListt[j].MLSID + 'callmade" style="height:20px;width:30px;" onclick="return checkIsCallMade(\'' + data[i].AllListt[j].MLSID + '\')" checked/>';
                            }
                            if (data[i].AllListt[j].IsConform == "true") {
                                isconfirmedcheckbox = '<input type="checkbox" class="orange" style="height:20px;width:30px;" id="' + data[i].AllListt[j].MLSID + 'confirm" onclick="return checkIsConfirm(\'' + data[i].AllListt[j].MLSID + '\')" checked/>';
                            }
                            if (data[i].StartPoint == data[i].AllListt[j].MLSID) {
                                icon = {
                                    url: '/img/safety_icon.png',
                                };
                                //overflow: hidden;white-space: nowrap;text-overflow: ellipsis;
                                sourceAddress = data[i].AllListt[j].PRP_ADDRESS;
                                //firstListing = '<div id="' + data[i].AllListt[j].MLSID + '"><div class="col-sm-12 routing_Listings"  style="text-align:right;font-weight:bold"><label class="labelorange">Routed Arrival Time:</label>'
                                //                  + ' <span style="margin-left:10px;">' + data[i].AllListt[j].ArrivalTime + '</span></div>'
                                //                  + '<div clas="col-sm-12"><div class="col-sm-1" style="line-height:50px;text-align:center"><span class="badge" style="font-size:18px;border-radius:15px;padding:6px 11px;background-color:#ff5d26;color:#fff">1</span> </div>'
                                //                  + '<div class="col-sm-11"><div class="col-sm-3" style="height:70px;line-height:15px;border-radius: 4px 0 0 4px;background: url(' + photo + '); background-size: 100% 100%;"></div>'
                                //                  + '<div class="col-sm-9" style="border:1px solid #ff5d26;height:70px"><div style="margin-top:5px">MLS#' + data[i].AllListt[j].MLSID + '</div>'
                                //                  + '<div class="textlimit" style="margin-top: 5px;">' + data[i].AllListt[j].PRP_ADDRESS + '</div></div>'
                                //                  //+ '<div class="col-sm-3" style="display:none;border:1px solid #ff5d26;line-height: 50px;text-align: center;border-radius: 0 4px 4px 0;cursor:pointer">'
                                //                  //+ '<a href="#" onclick="removeListing_RoutingPopup(' + data[i].AllListt[j].MLSID + ')" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListing_RoutingPopup" data-toggle="modal">Remove</a></div></div></div>'
                                //                  + '<div class="col-sm-12" style="background-color:lightgray;font-weight:bold;margin-left:0;border-radius: 0 0 5px 5px;height: 25px;padding-top:3px">'
                                //                  + 'Set Appointment time for:&nbsp;&nbsp;<img src="/img/watchh.png" style="margin-bottom:0" />&nbsp;<label id="fromtime_RoutingPopup" style="font-weight:bold">' + data[i].AllListt[j].SetAppointment_From + '</label>'
                                //                  + '&nbsp;<lable class="labelorange">to</lable>&nbsp;<label id="totime_RoutingPopup" style="font-weight:bold">' + data[i].AllListt[j].SetAppointment_To + '</label></div>'
                                //                  + '<div class="col-sm-12" style="text-align:center;padding:10px">' + iscallmadecheckbox + '<label>Call Made</label>&nbsp;&nbsp;'
                                //                  + isconfirmedcheckbox + '<label>Confirm</label></div>'
                                //                  //+ '<div class="col-sm-1">&nbsp;</div>'
                                //                  + '<div onclick="Showing_Shedule_Instructions(\'' + data[i].AllListt[j].MLSID + '\',\'' + data[i].AllListt[j].PRP_ADDRESS + '\',\'' + photo + '\',\'' + data[i].AllListt[j].SetAppointment_From + '\',\'' + data[i].AllListt[j].SetAppointment_To + '\',\'' + data[i].AllListt[j].Instructions + '\',\'' + data[i].AllListt[j].WhoToContact + '\')" class="col-sm-12" style="margin-bottom: 10px;background-color:#ff5d26;color:#fff;font-size:15px;margin-left:0;border-radius: 5px;height: 30px;padding-top:5px;text-align:center;cursor:pointer">'
                                //                  + ' Shedule this Showing</div></div>';
                                firstListing = '<div id="' + data[i].AllListt[j].MLSID + '"><div class="col-sm-12 routing_Listings"  style="text-align:right;font-weight:bold"><label class="labelorange">Routed Arrival Time:</label>'
                                                + ' <span style="margin-left:10px;">' + data[i].AllListt[j].ArrivalTime + '</span></div>'
                                                + '<div clas="col-sm-12"><div class="col-sm-1" style="line-height:50px;text-align:center"><span class="badge" style="font-size:18px;border-radius:15px;padding:6px 11px;background-color:#ff5d26;color:#fff">1</span> </div>'
                                                + '<div class="col-sm-11"><div class="col-sm-3" style="height:70px;line-height:15px;border-radius: 4px 0 0 4px;background: url(' + photo + '); background-size: 100% 100%;"></div>'
                                                + '<div class="col-sm-9" style="border:1px solid #ff5d26;height:70px;padding:10px"><div style="margin-top:5px">MLS#' + data[i].AllListt[j].MLSID + '</div>'
                                                + '<div class="textlimit" style="margin-top: 5px;">' + data[i].AllListt[j].PRP_ADDRESS + '</div></div>'
                                                //+ '<div class="col-sm-3" style="display:none;border:1px solid #ff5d26;line-height: 50px;text-align: center;border-radius: 0 4px 4px 0;cursor:pointer">'
                                                //+ '<a href="#" onclick="removeListing_RoutingPopup(' + data[i].AllListt[j].MLSID + ')" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListing_RoutingPopup" data-toggle="modal">Remove</a></div></div></div>'
                                                + '<div class="col-sm-12" style="background-color:lightgray;font-weight:bold;margin-left:0;border-radius: 0 0 5px 5px;height: 25px;padding-top:3px">'
                                                + 'Set Appointment time for:&nbsp;&nbsp;<img src="/img/watchh.png" style="margin-bottom:0" />&nbsp;<label id="fromtime_RoutingPopup" style="font-weight:bold">' + data[i].AllListt[j].SetAppointment_From + '</label>'
                                                + '&nbsp;<lable class="labelorange">to</lable>&nbsp;<label id="totime_RoutingPopup" style="font-weight:bold">' + data[i].AllListt[j].SetAppointment_To + '</label></div>'
                                                + '<div class="col-sm-12" style="text-align:center;padding:10px">' + iscallmadecheckbox + '<label>Call Made</label>&nbsp;&nbsp;'
                                                + isconfirmedcheckbox + '<label>Confirm</label></div>'
                                                //+ '<div class="col-sm-1">&nbsp;</div>'
                                                + '<div onclick="Showing_Shedule_Instructions(\'' + data[i].AllListt[j].MLSID + '\',\'' + data[i].AllListt[j].PRP_ADDRESS + '\',\'' + photo + '\',\'' + data[i].AllListt[j].SetAppointment_From + '\',\'' + data[i].AllListt[j].SetAppointment_To + '\',\'' + data[i].AllListt[j].Instructions + '\',\'' + data[i].AllListt[j].WhoToContact + '\')" class="col-sm-12" style="margin-bottom: 10px;background-color:#ff5d26;color:#fff;font-size:15px;margin-left:0px;border-radius: 5px;height: 30px;padding-top:5px;text-align:center;cursor:pointer">'
                                                + ' Schedule this Showing</div></div>';
                                var marker = new MarkerWithLabel({
                                    position: new google.maps.LatLng(data[i].AllListt[j].GeoLat, data[i].AllListt[j].GeoLong),
                                    map: map_in_Routing,
                                    labelContent: '1',
                                    labelAnchor: new google.maps.Point(5, 25),
                                    labelClass: "labels", // the CSS class for the label
                                    labelInBackground: false,
                                    icon: icon,
                                    id: data[i].AllListt[j].MLSID,
                                    title: data[i].AllListt[j].PRP_ADDRESS
                                });
                                routeMarkers.push(marker);
                            }
                            else {
                                //var ListData = '<div id="' + data[i].AllListt[j].MLSID + '"> <div class="col-sm-12 routing_Listings" id="' + data[i].AllListt[j].MLSID + '" style="text-align:right;font-weight:bold"><label class="labelorange">Routed Arrival Time:</label>'
                                //                 + ' <span style="margin-left:10px;">' + data[i].AllListt[j].ArrivalTime + '</span></div>'
                                //                 + '<div clas="col-sm-12"><div class="col-sm-1" style="line-height:50px;text-align:center"><span class="badge" style="font-size:18px;border-radius:15px;padding:5px 9px;background-color:#ff5d26;color:#fff">' + (m) + '</span> </div>'
                                //                 + '<div class="col-sm-11"><div class="col-sm-3" style="height:70px;line-height:15px;border-radius: 4px 0 0 4px;background: url(' + photo + '); background-size: 100% 100%;"></div>'
                                //                 + '<div class="col-sm-6" style="border:1px solid #ff5d26;height:70px;"><div style="margin-top:5px">MLS#' + data[i].AllListt[j].MLSID + '</div>'
                                //                 + '<div style="margin-top: 5px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">' + data[i].AllListt[j].PRP_ADDRESS + '</div></div>'
                                //                 //+ '<div class="col-sm-3" style="border:1px solid #ff5d26;line-height: 50px;text-align: center;border-radius: 0 4px 4px 0;cursor:pointer">'
                                //                 //+ '<a href="#" onclick="removeListing_RoutingPopup(' + data[i].AllListt[j].MLSID + ')" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListing_RoutingPopup" data-toggle="modal">Remove</a></div></div></div>'
                                //                 + '<div class="col-sm-12" style="background-color:lightgray;font-weight:bold;margin-left:0;border-radius: 0 0 5px 5px;height: 25px;padding-top:3px">'
                                //                 + 'Set Appointment time for:&nbsp;&nbsp;<img src="/img/watchh.png" style="margin-bottom:0" />&nbsp;<label id="fromtime_RoutingPopup" style="font-weight:bold">' + data[i].AllListt[j].SetAppointment_From + '</label>'
                                //                 + '&nbsp;<lable class="labelorange">to</lable>&nbsp;<label id="totime_RoutingPopup" style="font-weight:bold">' + data[i].AllListt[j].SetAppointment_To + '</label></div>'
                                //                 + '<div class="col-sm-12" style="text-align:center;padding:10px">' + iscallmadecheckbox + '<label>Call Made</label>&nbsp;&nbsp;'
                                //                 + isconfirmedcheckbox + '<label>Confirm</label></div>'
                                //                 //+ '<div class="col-sm-1">&nbsp;</div>'
                                //                 + '<div onclick="Showing_Shedule_Instructions(\'' + data[i].AllListt[j].MLSID + '\',\'' + data[i].AllListt[j].PRP_ADDRESS + '\',\'' + photo + '\',\'' + data[i].AllListt[j].SetAppointment_From + '\',\'' + data[i].AllListt[j].SetAppointment_To + '\',\'' + data[i].AllListt[j].Instructions + '\',\'' + data[i].AllListt[j].WhoToContact + '\')" class="col-sm-12" style="margin-bottom: 10px;background-color:#ff5d26;color:#fff;font-size:15px;margin-left:0;border-radius: 5px;height: 30px;padding-top:5px;text-align:center;cursor:pointer">'
                                //                 + ' Shedule this Showing</div></div>';
                                var ListData = '<div id="' + data[i].AllListt[j].MLSID + '"> <div class="col-sm-12 routing_Listings" id="' + data[i].AllListt[j].MLSID + '" style="text-align:right;font-weight:bold"><label class="labelorange">Routed Arrival Time:</label>'
                                                  + ' <span style="margin-left:10px;">' + data[i].AllListt[j].ArrivalTime + '</span></div>'
                                                  + '<div clas="col-sm-12"><div class="col-sm-1" style="line-height:50px;text-align:center"><span class="badge" style="font-size:18px;border-radius:15px;padding:6px 11px;background-color:#B4D200;color:#fff">' + (m) + '</span> </div>'
                                                  + '<div class="col-sm-11"><div class="col-sm-3" style="height:70px;line-height:15px;border-radius: 4px 0 0 4px;background: url(' + photo + '); background-size: 100% 100%;"></div>'
                                                  + '<div class="col-sm-9" style="border:1px solid #ff5d26;height:70px;padding:10px"><div style="margin-top:5px">MLS#' + data[i].AllListt[j].MLSID + '</div>'
                                                  + '<div style="margin-top: 5px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">' + data[i].AllListt[j].PRP_ADDRESS + '</div></div>'
                                                  //+ '<div class="col-sm-3" style="border:1px solid #ff5d26;line-height: 50px;text-align: center;border-radius: 0 4px 4px 0;cursor:pointer">'
                                                  //+ '<a href="#" onclick="removeListing_RoutingPopup(' + data[i].AllListt[j].MLSID + ')" style="color:#ff5d26;font-size:13px;text-decoration:none" data-target="#RemoveListing_RoutingPopup" data-toggle="modal">Remove</a></div></div></div>'
                                                  + '<div class="col-sm-12" style="background-color:lightgray;font-weight:bold;margin-left:0;border-radius: 0 0 5px 5px;height: 25px;padding-top:3px">'
                                                  + 'Set Appointment time for:&nbsp;&nbsp;<img src="/img/watchh.png" style="margin-bottom:0" />&nbsp;<label id="fromtime_RoutingPopup" style="font-weight:bold">' + data[i].AllListt[j].SetAppointment_From + '</label>'
                                                  + '&nbsp;<lable class="labelorange">to</lable>&nbsp;<label id="totime_RoutingPopup" style="font-weight:bold">' + data[i].AllListt[j].SetAppointment_To + '</label></div>'
                                                  + '<div class="col-sm-12" style="text-align:center;padding:10px">' + iscallmadecheckbox + '<label>Call Made</label>&nbsp;&nbsp;'
                                                  + isconfirmedcheckbox + '<label>Confirm</label></div>'
                                                  //+ '<div class="col-sm-1">&nbsp;</div>'
                                                  + '<div onclick="Showing_Shedule_Instructions(\'' + data[i].AllListt[j].MLSID + '\',\'' + data[i].AllListt[j].PRP_ADDRESS + '\',\'' + photo + '\',\'' + data[i].AllListt[j].SetAppointment_From + '\',\'' + data[i].AllListt[j].SetAppointment_To + '\',\'' + data[i].AllListt[j].Instructions + '\',\'' + data[i].AllListt[j].WhoToContact + '\')" class="col-sm-12" style="margin-bottom: 10px;background-color:#ff5d26;color:#fff;font-size:15px;margin-left:0px;border-radius: 5px;height: 30px;padding-top:5px;text-align:center;cursor:pointer">'
                                                  + ' Shedule this Showing</div></div>';
                                $('#RoutedListings_div').append(ListData);
                                route_Dest_Addresses.push(data[i].AllListt[j].PRP_ADDRESS);
                                icon = {
                                    url: '/img/safety_icon.png',
                                };
                                var marker = new MarkerWithLabel({
                                    position: new google.maps.LatLng(data[i].AllListt[j].GeoLat, data[i].AllListt[j].GeoLong),
                                    map: map_in_Routing,
                                    labelContent: '' + (m),
                                    labelAnchor: new google.maps.Point(5, 25),
                                    labelClass: "labels", // the CSS class for the label
                                    labelInBackground: false,
                                    icon: icon,
                                    id: data[i].AllListt[j].MLSID,
                                    title: data[i].AllListt[j].PRP_ADDRESS
                                });
                                routeMarkers.push(marker);
                                m = parseInt(m) + 1;
                            }

                            var_location = new google.maps.LatLng(data[i].AllListt[0].GeoLat, data[i].AllListt[0].GeoLong);
                            Var_Location_Routing = var_location;

                            Sceduled_Data_List.push({
                                MLSID: data[i].AllListt[j].MLSID,
                                ROUTED_TIME: data[i].AllListt[j].ArrivalTime,
                                START_TIME: data[i].AllListt[j].SetAppointment_From,
                                END_TIME: data[i].AllListt[j].SetAppointment_To,
                                IS_CALLMADE: data[i].AllListt[j].IsCallMade,
                                IS_CONFIRMED: data[i].AllListt[j].IsConform,
                            })

                        });
                    })
                    setTimeout(CalculateTime_DrawRoute, 1000);
                    $('#RoutedListings_div').prepend(firstListing);
                    $("#RoutingPopup").modal('show');
                }
            }
        });
        console.log(Sceduled_Data_List)
    }//Method to bind already scheduled listings in routing popup
    function timeConvert(n) {
        var num = n;
        var hours = (num / 60);
        var rhours = Math.floor(hours);
        var minutes = (hours - rhours) * 60;
        var rminutes = Math.round(minutes);
        return rhours + "-" + rminutes;
    }
    var dest;
    var traveltimes = [];

    function CalculateTime_DrawRoute() {
        var directionsDisplay = new google.maps.DirectionsRenderer({ map: map_in_Routing });
        var directionsService = new google.maps.DirectionsService();
        directionsDisplay.setMap(map_in_Routing);
        source = sourceAddress;
        destination = route_Dest_Addresses[route_Dest_Addresses.length - 1];
        var waypoints = [];
        for (var i = 0; i < route_Dest_Addresses.length - 1; i++) {
            var address = route_Dest_Addresses[i];
            if (address !== "") {
                waypoints.push({
                    location: address,
                    stopover: true
                });
            }
        }
        var request = {
            origin: source,
            destination: destination,
            waypoints: waypoints, //an array of waypoints
            optimizeWaypoints: true, //set to true if you want google to determine the
            // shortest route or false to use the order specified.
            travelMode: google.maps.DirectionsTravelMode.DRIVING
        };
        //alert(source+" --"+destination+"  --  "+waypoints)
        traveltimes = [];
        directionsService.route(request, function (response, status) {
            if (status == google.maps.DirectionsStatus.OK) {
                var distance = 0;
                var minute = 0.00;
                //  $('#RoutedListings_div').empty();
                //alert(response.routes.length)
                //response.routes[0].legs.forEach(function (item, index) {
                //    if (index <= response.routes[0].legs.length - 1) {
                //        distance = distance + parseInt(item.distance.text);
                //        minute = parseFloat(minute) + parseFloat(item.duration.value / 60);
                //        var l = "<table><tr><td>Source</td><td>Destination</td><td>Distance</td><td>Traverll Time</td></tr>";
                //        l = l + '<tr><td>' + source + '</td><td>' + item.end_address + '</td><td>' + distance + ' miles</td><td>' + minute.toFixed(2) + ' Min</td></tr>';
                //        // tbl = document.getElementById("tblResults");
                //        //var row = tbl.insertRow(1);
                //        //var cell = row.insertCell(0);
                //        //cell.innerText = source;
                //        //var cell = row.insertCell(1);
                //        //cell.innerText = item.end_address;
                //        //var cell = row.insertCell(2);
                //        //cell.innerText = distance;
                //        //var cell = row.insertCell(3);
                //        //cell.innerText = minute.toFixed(2) + " min";
                //        $('#RoutedListings_div').append(l);
                //    }
                //});
                var route = response.routes[0];
                // For each route, display summary information.
                for (var i = 1; i < route.legs.length; i++) {
                    //mymarkers[j].set('labelContent', '1');
                    minute =  parseFloat(route.legs[i].duration.value / 60);
                    //var l = "<table><tr><td>Source</td><td>Destination</td><td>Distance</td><td>Traverll Time</td></tr>";
                    //l = l + '<tr><td>' + route.legs[i].start_address + '</td><td>' + route.legs[i].end_address + '</td><td>' + route.legs[i].distance.text + ' miles</td><td>' + minute.toPrecision(2) + '  ' + minute + ' Min</td></tr>';
                    //$('#RoutedListings_div').append(l);
                    traveltimes.push(Number(minute.toPrecision(2)));
                }
                //directionsDisplay.setMap(map_in_Routing);
                directionsDisplay.setDirections(response);
                directionsDisplay.setOptions({ suppressMarkers: true });
            }
            else {
                $("#heading").text("Alert!");
                $("#content_text").text("Google Maps API unable to create directions for selected route.");
                $("#AlertPopup").modal("show");
            }
        })
    }
    function checkIsCallMade(mlsid) {
        //alert(mlsid + "," + $("#" + mlsid + "callmade").is(':checked'))
        //Find index of specific object using findIndex method.
        objIndex = Sceduled_Data_List.findIndex((obj => obj.MLSID == mlsid));
        //Update object's name property.
        Sceduled_Data_List[objIndex].IS_CALLMADE = $("#" + mlsid + "callmade").is(':checked');
        //Log object to console again.
        //console.log(Sceduled_Data_List)
    }
    function checkIsConfirm(mlsid) {
        var count = 0;
        //Find index of specific object using findIndex method.
        objIndex = Sceduled_Data_List.findIndex((obj => obj.MLSID == mlsid));
        //Update object's name property.
        Sceduled_Data_List[objIndex].IS_CONFIRMED = $("#" + mlsid + "confirm").is(':checked');
        //Log object to console again.
        $.map(Sceduled_Data_List, function (ext, l) {
            if (ext.IS_CONFIRMED == "true" || ext.IS_CONFIRMED == "1")
                count = count + 1;
            if (count == Sceduled_Data_List.length) {
                $("#create_route_btn_RoutingPopup").removeClass('btndisble').addClass('btnenable');
                $('#create_route_btn_RoutingPopup').prop("disabled", false);
            }
            else {
                $("#create_route_btn_RoutingPopup").removeClass('btnenable').addClass('btndisble');
                $('#create_route_btn_RoutingPopup').prop("disabled", true);
            }
        });
        //console.log(Sceduled_Data_List)
        //console.log(count + "==" + Sceduled_Data_List.length)
    }
    function Save_Exit_Notify(savetype) {
        var incr = 1;
        //if (savetype == "save_exit")
        //    cont = '/Agent/AgentShowings/SaveListingstoSchedule';
        //else if (savetype = "save_notify")
        //    cont = '/Agent/AgentShowings/SaveListingstoSchedule';
        $.map(Sceduled_Data_List, function (ext, l) {
            setTimeout(function () {

                // alert(Sceduled_Data_List[0].MLSID)
                //var schedule_obj = [PK_ReqID, Sceduled_Data_List[l].MLSID, Sceduled_Data_List[l].ROUTED_TIME, Sceduled_Data_List[l].START_TIME,
                //    Sceduled_Data_List[l].END_TIME, Sceduled_Data_List[l].IS_CALLMADE, Sceduled_Data_List[l].IS_CONFIRMED, ''];
                var schedule_obj = [PK_ReqID, ext.MLSID, ext.ROUTED_TIME, ext.START_TIME,
                    ext.END_TIME, ext.IS_CALLMADE, ext.IS_CONFIRMED, '', savetype];
                //alert(schedule_obj)
                $.ajax({
                    url: "/Agent/AgentShowings/SaveListingstoSchedule",
                    type: "POST",
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify(schedule_obj),
                    success: function (res) {
                        if (res == "Success") {
                            if (incr == Sceduled_Data_List.length) {
                                if (savetype == "save_notify") {
                                    $("#ScheduledSuccessPopup").modal('show');

                                }
                                else {

                                }
                                $('#RoutingPopup').modal('hide');

                            }
                            incr++;

                        }
                        else {
                            alert("Error :" + res);
                        }
                    },
                });
            });

        }, 4000);
    }//Save changed in routing popup and scedhule and notify
    function Showing_Shedule_Instructions(mlsid, address, photo, fromtime, totime, contact, instructions) {
        $("#mlsid_in_Instructions").text("MLS#" + mlsid);
        $("#listing_setappointment_fromtime").text(fromtime);
        $("#listing_setappointment_totime").text(totime);
        $("#listingAddress_in_Instructions").text(address.split(',')[0]);
        $('#listing_image_in_Instructions').css("background-image", "url('" + photo + "')");
        $('#instructions').text(instructions);
        $('#whomtocontact').text(contact);
        $("#ShowingScheduleInstructions_Popup").modal('show');
    }
    $("#OK_ScheduledInctructions_Popup").click(function () {
        getAgentBuyers('Pending');
    })
    var removedListings_RoutingPopup = [], divid = "";
    function removeListing_RoutingPopup(id,address) {
        divid = id;
        removedListings_RoutingPopup.push(divid);
    }
    $("#RemoveListingYesBtn_RoutingPopup").click(function () {
      
        $(".scrolls_divs div").parent().find("#" + divid).addClass("displaynone");
        $("#RemoveListing_RoutingPopup").modal('hide');
        //alert(removedListings_RoutingPopup.join(','))
    });
    ////////////////////////////////
    function bindScheduledLists(data) {
        $('#buyerdivinlistings').empty();
        $('#buyerdivinlistings').append(mybuyer);
        var d1 = "", d2 = "", pkey = "";
        $.each(data, function (i, item) {
            var listings = "";
            var dates = '<span style="color:white;position:relative;top:5px; font-size:12px">&nbsp;' + data[i].AgentScheduleDate + '<label style="color:rgb(255, 159, 128)"></span>';
            var d = '<div class="col-sm-12" style="height:30px;background-color:#686868"><span style="top: 5px; color: rgb(255, 159, 128); position: relative;">Scheduled For: </span>' + dates + '</div>';
            //+ '<div class="col-sm-2" style="text-align:center;line-height:30px;background-color:#ff5d26;color:#fff;"><a href="#" style="text-decoration:none;" id="divs" onclick="return ManageListings_in_PendingTab(\'' + data[i].pk + '\',\'' + data[i].SaveStage + '\')">Manage</div>';
            $.each(data[i].AllListt, function (j, exp) {
                if (j == 0)
                    $('#buyerdivinlistings').append(d);
                if (j == data[i].AllListt.length - 1)
                    var startdiv = '<div class="col-sm-12" style="padding: 15px;">'
                else
                    var startdiv = '<div class="col-sm-12" style="padding: 15px;border-bottom: 2px solid #ff5d26;">'
                var imagepin = "", price = "";
                var bedrooms, bathrooms, sqftAcres;
                var BtnPrevImgId = "Prev" + data[i].AllListt[j].MLSID;
                var BtnNextImgId = "Next" + data[i].AllListt[j].MLSID;
                var PrpImagesArray = []
                var DivImgId = "div_" + data[i].AllListt[j].MLSID;
                var PhotosURL = [], TotalImages = [];
                PrpImagesArray = [];
                if (data[i].AllListt[j].PRP_IMAGES != null) {
                    var c = data[i].AllListt[j].PHOTO_COUNT;
                    PrpImagesArray = data[i].AllListt[j].PRP_IMAGES.split(',');
                    TotalImages.push(data[i].AllListt[j].PRP_IMAGES);
                    if (TotalImages.length > 0)
                        PhotosURL = data[i].AllListt[j].PRP_IMAGES.split(',');
                    else
                        PhotosURL = data[i].AllListt[j].PRP_IMAGES;
                }
                if (data[i].AllListt[j].PHOTO_COUNT > 1) {
                    photosdiv = '<div class="col-sm-12"  style="height: 90px; position: relative; background-image: url(' + PhotosURL[0] + '); background-size: 100% 100%;" id="' + DivImgId + '">'
                                     + '<div class="col-sm-12" style="margin-top: 18%;padding: 7px;"><a href="#"><img src="/img/SliderBackArrow.png" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "-1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" width="21" height="29" alt="" style="margin-left: -20%;" id="' + BtnPrevImgId + '" hidden="hidden"/></a>'
                                     + '<a href="#"><img src="/img/SliderNextArrow.png" width="21" height="29" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" alt="" style="float: right;margin-right: -20%;" id="' + BtnNextImgId + '"   /></a></div></div>';
                }
                else {
                    photosdiv = '<div class="col-sm-12"  style="height: 90px; position: relative; background-image: url(' + PhotosURL[0] + '); background-size: 100% 100%;" id="' + DivImgId + '">'
                                    + '<div class="col-sm-12" style="margin-top: 18%;padding: 7px;"><a href="#"><img src="/img/SliderBackArrow.png" onclick="PrpImageSlider(\'' + i + '\',\'' + "-1" + '\',\'' + DivImgId + '\',\'' + data[i].AllListt[j].MLSID + '\')" width="21" height="29" alt="" style="margin-left: -20%;" id="' + BtnPrevImgId + '" hidden="hidden"/></a>'
                                    + '<a href="#"><img src="/img/SliderNextArrow.png" width="21" height="29" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" alt="" style="float: right;margin-right: -20%;" id="' + BtnNextImgId + '" hidden="hidden"/></a></div></div>';
                }
                if (data[i].AllListt[j].Class == "Rental") {
                    price = "$ " + (data[i].AllListt[j].PRP_PRICE + "").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,") + "/mo";
                    if (data[i].AllListt[j].Is_Viewd == "YES")
                        imagepin = '<img src="/img/viewed_graypin.png" height="20" style="position:relative; top:-2px" />'
                    else
                        imagepin = '<img src="/img/gray_legendMenu.png" height="20" style="position:relative; top:-2px" />'
                }
                else {
                    price = "$ " + (data[i].AllListt[j].PRP_PRICE + "").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,");
                    if (data[i].AllListt[j].Status == "Active") {
                        if (data[i].AllListt[j].Is_Viewd == "YES")
                            imagepin = '<img src="/img/viewed_greenpin.png" height="20" style="position:relative; top:-2px" />'
                        else
                            imagepin = '<img src="/img/Green_legend_Menu.png" height="20" style="position:relative; top:-2px" />'
                    }
                    else if (data[i].AllListt[j].Status == "Pending") {
                        if (data[i].AllListt[j].Is_Viewd == "YES")
                            imagepin = '<img src="/img/yellow_legendMenu.png" height="20" style="position:relative; top:-2px;margin-left: -3px;" />'
                        else
                            imagepin = '<img src="/img/viewed_yellowpin.png" height="20" style="position:relative; top:-2px" />'
                    }
                }
                if (data[i].AllListt[j].Class == "Lots/Land") {
                    sqftAcres = data[i].AllListt[j].SQFT + ' acres';
                    bedrooms = "--";
                    bathrooms = "--";
                }
                else {
                    bedrooms = data[i].AllListt[j].BEDROOMS;
                    bathrooms = data[i].AllListt[j].BATHROOMS;
                    sqftAcres = data[i].AllListt[j].SQFT + ' sqft';
                }
                var addr11 = data[i].AllListt[j].PRP_ADDRESS.split(',')[1];
                var addr12 = (data[i].AllListt[j].PRP_ADDRESS.split(',')[2] != undefined) ? "," + data[i].AllListt[j].PRP_ADDRESS.split(',')[2] : "";
                //<div class="col-sm-12" style="padding: 15px;border-bottom: 2px solid #ff5d26;">
                var SceduledRequests = startdiv + '<div class="col-sm-2" style="padding:0"><div class="col-sm-12" style="background-color:#ff5d26;color:#fff;text-align:center;border-radius:5px 5px 0 0;padding:0">'
                                + '<img src="/img/clock_icon_closer_white.png" style="margin-left: 4px;margin-bottom:0;float:left;height: 14px;margin-top: 2px;" />' + data[i].AllListt[j].SetAppointment_From + ' to ' + data[i].AllListt[j].SetAppointment_To + '</div>' + photosdiv + '</div>'
                                + '<div class="col-sm-3" style="padding-left:25px;top:5px;"><table style="line-height:15px;border-right: 1px solid lightgray;width:100%">'
                                + '<tr><td style="">' + imagepin + '<span id="Rate" style="color:#ff5d26;font-size:16px; font-weight:bold; position:relative; "><span style="position: relative;padding-left:5px">' + price + '</span></span></td></tr>'
                                + '<tr><td style="padding-top:10px"><span id="AddLineOne" style="font-weight:bold">' + data[i].AllListt[j].PRP_ADDRESS.split(',')[0] + '</span></td></tr><tr><td style=""><span style="font-size:12px; font-weight:bold">' + addr11 + '' + addr12 + '</span></td></tr></tr>'
                                + '<tr><td style="padding-top:5px"><span id="MLSID" style="font-size:12px; font-weight:normal; color:grey">MLS#' + data[i].AllListt[j].MLSID + '</span></td></tr></table></div>'
                                 + '<div class="col-sm-3"><table style="top: 15px; position: relative;">'
                                + '<tr><td><span style="color:#ff5d26;font-weight:bold">' + bedrooms + '</span><span>  Bedrooms</span></td></tr>'
                                + '<tr><td><span style="color:#ff5d26;font-weight:bold">' + bathrooms + '</span><span>  Bathrooms</span></td></tr>'
                                + '<tr><td style="color:#ff5d26;font-weight:bold"><span>' + sqftAcres + '</span><span></span></td></tr>'
                                + '</table></div>'
                                + '<div class="col-sm-2" style="top:20px;"><button onclick = "return showDirections(\'' + data[i].AllListt[j].PRP_ADDRESS + '\')" class="btn btn-default btn-mn" style="border:1px solid #ff5d26;color:#ff5d26;">Directions&nbsp;&nbsp;<img src="/img/Directions_icon.png" style="margin-bottom:0"/></div>'
                                  + '<div class="col-sm-2"><img class="sideArrow" style="top:28px;float: right; position: relative; height:26px;cursor:pointer;" src="/img/lit_icon_btn.png" onclick="AgentFullDetailsView(\'' + AgentId + '\', \'' + data[i].AllListt[j].MLSID + '\')"></div>'
                                  + '</div>';
                $('#buyerdivinlistings').append(SceduledRequests);
            });
        });
    }
    function bindCompletedListings(data) {
        $('#buyerdivinlistings').empty();
        $('#buyerdivinlistings').append(mybuyer);
        var d1 = "", d2 = "", pkey = "";
        $.each(data, function (i, item) {
            var listings = "";
            var dates = '<span style="color:white;position:relative;top:5px; font-size:12px">&nbsp;' + data[i].AgentScheduleDate + '<label style="color:rgb(255, 159, 128)"></span>';
            var d = '<div class="col-sm-12" style="height:30px;background-color:#686868"><span style="top: 5px; color: rgb(255, 159, 128); position: relative;">Showings Completed on: </span>' + dates + '</div>';
            //+ '<div class="col-sm-2" style="text-align:center;line-height:30px;background-color:#ff5d26;color:#fff;"><a href="#" style="text-decoration:none;" id="divs" onclick="return ManageListings_in_PendingTab(\'' + data[i].pk + '\',\'' + data[i].SaveStage + '\')">Manage</div>';
            $.each(data[i].AllListt, function (j, exp) {
                if (j == 0)
                    $('#buyerdivinlistings').append(d);
                if (j == data[i].AllListt.length-1)
                    var startdiv = '<div class="col-sm-12" style="padding: 15px;">'
                else
                    var startdiv = '<div class="col-sm-12" style="padding: 15px;border-bottom: 2px solid #ff5d26;">'
                var imagepin = "", price = "";
                var bedrooms, bathrooms, sqftAcres;
                var BtnPrevImgId = "Prev" + data[i].AllListt[j].MLSID;
                var BtnNextImgId = "Next" + data[i].AllListt[j].MLSID;
                var PrpImagesArray = []
                var DivImgId = "div_" + data[i].AllListt[j].MLSID;
                var PhotosURL = [], TotalImages = [];
                PrpImagesArray = [];
                if (data[i].AllListt[j].PRP_IMAGES != null && data[i].AllListt[j].PRP_IMAGES != "," && data[i].AllListt[j].PRP_IMAGES != "") {
                    var c = data[i].AllListt[j].PHOTO_COUNT;
                    PrpImagesArray = data[i].AllListt[j].PRP_IMAGES.split(',');
                    TotalImages.push(data[i].AllListt[j].PRP_IMAGES);
                    if (TotalImages.length > 0)
                        PhotosURL = data[i].AllListt[j].PRP_IMAGES.split(',');
                    else
                        PhotosURL[0] = data[i].AllListt[j].PRP_IMAGES;
                }
                else{
                    PhotosURL[0] = '/img/NoImage.png';
                }
                if (TotalImages.length > 0) {
                    photosdiv = '<div class="col-sm-12"  style="height: 90px; position: relative; background-image: url(' + PhotosURL[0] + '); background-size: 100% 100%;" id="' + DivImgId + '">'
                                     + '<div class="col-sm-12" style="margin-top: 18%;padding: 7px;"><a href="#"><img src="/img/SliderBackArrow.png" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "-1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" width="21" height="29" alt="" style="margin-left: -20%;" id="' + BtnPrevImgId + '" hidden="hidden"/></a>'
                                     + '<a href="#"><img src="/img/SliderNextArrow.png" width="21" height="29" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" alt="" style="float: right;margin-right: -20%;" id="' + BtnNextImgId + '"   /></a></div></div>';
                }
                else {
                    photosdiv = '<div class="col-sm-12"  style="height: 90px; position: relative; background-image: url(' + PhotosURL[0] + '); background-size: 100% 100%;" id="' + DivImgId + '">'
                                    + '<div class="col-sm-12" style="margin-top: 18%;padding: 7px;"><a href="#"><img src="/img/SliderBackArrow.png" onclick="PrpImageSlider(\'' + i + '\',\'' + "-1" + '\',\'' + DivImgId + '\',\'' + data[i].AllListt[j].MLSID + '\')" width="21" height="29" alt="" style="margin-left: -20%;" id="' + BtnPrevImgId + '" hidden="hidden"/></a>'
                                    + '<a href="#"><img src="/img/SliderNextArrow.png" width="21" height="29" onclick="return PrpImageSlider(\'' + imgindex + '\',\'' + "1" + '\',\'' + DivImgId + '\',\'' + PrpImagesArray + '\',\'' + data[i].AllListt[j].MLSID + '\')" alt="" style="float: right;margin-right: -20%;" id="' + BtnNextImgId + '" hidden="hidden"/></a></div></div>';
                }
                if (data[i].AllListt[j].Class == "Rental") {
                    price = "$ " + (data[i].AllListt[j].PRP_PRICE + "").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,") + "/mo";
                    if (data[i].AllListt[j].Is_Viewd == "YES")
                        imagepin = '<img src="/img/viewed_graypin.png" height="20" style="position:relative; top:-2px" />'
                    else
                        imagepin = '<img src="/img/gray_legendMenu.png" height="20" style="position:relative; top:-2px" />'
                }
                else {
                    price = "$ " + (data[i].AllListt[j].PRP_PRICE + "").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,");
                    if (data[i].AllListt[j].Status == "Active") {
                        if (data[i].AllListt[j].Is_Viewd == "YES")
                            imagepin = '<img src="/img/viewed_greenpin.png" height="20" style="position:relative; top:-2px" />'
                        else
                            imagepin = '<img src="/img/Green_legend_Menu.png" height="20" style="position:relative; top:-2px" />'
                    }
                    else if (data[i].AllListt[j].Status == "Pending") {
                        if (data[i].AllListt[j].Is_Viewd == "YES")
                            imagepin = '<img src="/img/yellow_legendMenu.png" height="20" style="position:relative; top:-2px;margin-left: -3px;" />'
                        else
                            imagepin = '<img src="/img/viewed_yellowpin.png" height="20" style="position:relative; top:-2px" />'
                    }
                }
                if (data[i].AllListt[j].Class == "Lots/Land") {
                    sqftAcres = data[i].AllListt[j].SQFT + ' acres';
                    bedrooms = "--";
                    bathrooms = "--";
                }
                else {
                    bedrooms = data[i].AllListt[j].BEDROOMS;
                    bathrooms = data[i].AllListt[j].BATHROOMS;
                    sqftAcres = data[i].AllListt[j].SQFT + ' sqft';
                }
                var feedbackstring = "", fbtext = "", f = "";
                if (data[i].AllListt[j].Have_AgentFeedback == "NO") {
                    feedbackstring = '<div class="col-sm-1"><img src="/img/watchh.png" style="margin-top:7px;" /></div><div class="col-sm-10"><label class="labelorange">Feedback not sent.</label></div>';
                    fbtext = '<a href="#" style="text-decoration:none" onclick="return SendAgentFeedback(\'' + data[i].AllListt[j].MLSID + '\',\'' + data[i].AllListt[j].PRP_ADDRESS + '\',\'' + PhotosURL[0] + '\',\'' + data[i].AllListt[j].PK_RequestShowingID + '\',\'' + data[i].AllListt[j].PK_UserShowingFeedbackID + '\',\'' + data[i].AllListt[j].Have_BuyerFeedback + '\')">Send Feedback</a>';
                    f = ' <div class="col-sm-12" style="line-height:25px;background-color:#fbd9cd;border-radius:3px;bottom:-35px;padding-right:0"><div class="col-sm-8" style="padding:0">' + feedbackstring + '</div>'
                                   + '<div class="col-sm-4" style="padding:0;border-radius:3px;background-color:#ff5d26;color:#fff;text-align:center">'
                                   + '<label id="feedBackLabel">' + fbtext + '</label></div></div></div>';
                }
                else {
                    feedbackstring = '<div class="col-sm-1" style="width:8%"><img src="/img/checkmar_savedPopup.png" style="margin-left: -15px;margin-top:3px;" /></div><div class="col-sm-7" style="padding:0;width:65%"><label class="labelorange">Feedback sent:&nbsp</label>' + data[i].AllListt[j].AgentFeedback_PostDate + '</div>'
                                     + '<div class="col-sm-4" style="padding:0;width:25%"><img src="/img/watchh.png" style="margin-bottom:0;height: 14px;" />&nbsp;' + data[i].AllListt[j].AgentFeedback_PostTime + '</div>';
                    fbtext = '<a href="#" style="text-decoration:none" onclick="return ViewFeedback(\'' + data[i].AllListt[j].PK_AgentShowingFeedbackID + '\',\'' + data[i].AllListt[j].PK_UserShowingFeedbackID + '\',\'' + data[i].AllListt[j].Have_BuyerFeedback + '\',\'Agent\')">View</a>';
                    f = ' <div class="col-sm-12" style="line-height:25px;background-color:#fbd9cd;border-radius:3px;bottom:-35px;padding-right:0"><div class="col-sm-10" style="padding:0">' + feedbackstring + '</div>'
                                  + '<div class="col-sm-2" style="padding:0;border-radius:3px;background-color:#ff5d26;color:#fff;text-align:center">'
                                  + '<label id="feedBackLabel">' + fbtext + '</label></div></div></div>';
                }
               
                var addr11 = data[i].AllListt[j].PRP_ADDRESS.split(',')[1];
                var addr12 = (data[i].AllListt[j].PRP_ADDRESS.split(',')[2] != undefined) ? "," + data[i].AllListt[j].PRP_ADDRESS.split(',')[2] : "";
                var CompletedListings = startdiv+'<div class="col-sm-2" style="padding:0"><div class="col-sm-12" style="background-color:#ff5d26;color:#fff;text-align:center;border-radius:5px 5px 0 0;padding:0">'
                             + '<img src="/img/clock_icon_closer_white.png" style="margin-left: 4px;margin-bottom:0;float:left;height: 14px;margin-top: 2px;" />' + data[i].AllListt[j].SetAppointment_From + ' to ' + data[i].AllListt[j].SetAppointment_To + '</div>' + photosdiv + '</div>'
                           + '<div class="col-sm-3" style="padding-left:25px;top:20px;"><table style="line-height:15px;border-right: 1px solid lightgray;width:100%">'
                           + '<tr><td style="">' + imagepin + '<span id="Rate" style="color:#ff5d26;font-size:16px; font-weight:bold; position:relative; "><span style="position: relative;padding-left:5px">' + price + '</span></span></td></tr>'
                           + '<tr><td style="padding-top:10px"><span id="AddLineOne" style="font-weight:bold">' + data[i].AllListt[j].PRP_ADDRESS.split(',')[0] + '</span></td></tr><tr><td style=""><span style="font-size:12px; font-weight:bold">' + addr11 + '' + addr12 + '</span></td></tr></tr>'
                           + '<tr><td style="padding-top:5px"><span id="MLSID" style="font-size:12px; font-weight:normal; color:grey">MLS#' + data[i].AllListt[j].MLSID + '</span></td></tr></table></div>'
                            + '<div class="col-sm-7"><div class="col-sm-6"><table style="top: 15px; position: relative;">'
                           + '<tr><td><span style="color:#ff5d26;font-weight:bold">' + bedrooms + '</span><span>  Bedrooms</span></td></tr>'
                           + '<tr><td><span style="color:#ff5d26;font-weight:bold">' + bathrooms + '</span><span>  Bathrooms</span></td></tr>'
                           + '<tr><td style="color:#ff5d26;font-weight:bold"><span>' + sqftAcres + '</span><span></span></td></tr>'
                           + '</table></div>'
                           
                             + '<div class="col-sm-6"><img class="sideArrow" style="top:28px;float: right; position: relative; height:26px;cursor:pointer;" src="/img/lit_icon_btn.png" onclick="AgentFullDetailsView(\'' + AgentId + '\', \'' + data[i].AllListt[j].MLSID + '\')"></div>'
                             + f;

                $('#buyerdivinlistings').append(CompletedListings);
            });
        });
    }
    
    $('#AgentPost_Feedback_Popup').on('shown.bs.modal', function () {
        $('.nav-tabs a[href="#agent_feedback_div"]').tab('show');
        $('#buyer_feedback_a').css('background-color', '');
        $('#buyer_feedback_a').css('color', 'black');
        $('#agent_feedback_a').css('background-color', '#ff5d26');
        $('#agent_feedback_a').css('color', '#fff');
    });
  
    function SendAgentFeedback(mlsid, address, mlsphoto, reqid, buyer_fc_pkeyid, have_buyerFB) {
        var addr11 = address.split(',')[1];
        var addr12 = (address.split(',')[2] != undefined) ? "," + address.split(',')[2] : "";
        $('#date_div').hide();
        $('#done_div').hide();
        $('#save_div').show();
        $('#agent_date_div').hide();
        $('#agent_post_feedback_div_data').show();
        $('#agent_view_feedback_div_data').hide();
        $("#FB_Popup_Image").attr('src', mlsphoto);
        $("#FB_Popup_AddressLineOne").text(address.split(',')[0])
        $("#FB_Popup_AddressLineTwo").text(addr11 + "" + addr12)
        $("#FB_Popup_MLSID").text(mlsid);
        $("#hidden_requestshowing_Id").text(reqid);
        havebuyerFeedback = have_buyerFB;
        if (have_buyerFB == "YES") {
            buyer_PK_Reqid = buyer_fc_pkeyid;
                getBuyerFeedback(buyer_fc_pkeyid);
        }
        else {
            $('#buyer_errormessage_div_Feedbackpopup').hide();
            $('#buyers_feedback_div_data').hide();
            $('#buyer_date_div').hide();
        }
        $("#AgentPost_Feedback_Popup").modal('show');
    }
    var havebuyerFeedback = "", haveagentFeedback = "", buyerPref = "", buyer_PK_Reqid;
    function ViewFeedback(agent_fb_pkeyid, buyer_fc_pkeyid, have_buyerFB, typeuser) {
        $('#date_div').show();
        $('#done_div').show();
        $('#save_div').hide();
        $('#agent_post_feedback_div_data').hide();
        $('#agent_view_feedback_div_data').show();
        havebuyerFeedback = have_buyerFB;
        haveagentFeedback = "YES";
        $.ajax({
            url: "/Agent/AgentShowings/AgentShowings_GetFeedback",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { PK_AgentShowingFeedbackID: agent_fb_pkeyid },
            success: function (res) {
                if (res.length > 0) {
                    bindFeedbacksinPopup(res, typeuser)
                }
                else {
                }
            },
            complete: function () {
                if (have_buyerFB == "YES") {
                    buyer_PK_Reqid = buyer_fc_pkeyid;
                    setTimeout(function () {
                        getBuyerFeedback(buyer_fc_pkeyid);
                    }, 1500);
                }
            }
        });
        
    }
    function getBuyerFeedback(buyer_fc_pkeyid) {
        $.ajax({
            url: "/Agent/AgentShowings/BuyerShowings_GetFeedback",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { PK_UserShowingFeedbackID: buyer_fc_pkeyid },
            success: function (res) {
                if (res.length > 0) {
                   //alert(res[0].WouldPreferToSave.toString())
                    buyerPref = res[0].WouldPreferToSave.toString();
                    if (buyerPref == "False") {
                        setTimeout(function () {
                            bindFeedbacksinPopup(res, 'Buyer')
                        }, 1500);
                    }
                    else {
                        $('#buyer_errormessage_div_Feedbackpopup').show();
                        $('#buyers_feedback_div_data').hide();
                    }
                    
                }
                else {
                }
            },
        });
    }
    function bindFeedbacksinPopup(res, typeuser) {
        if (res[0].PRP_IMAGES != null && res[0].PRP_IMAGES != "")
        if (typeuser == "Agent") {
            ResetAgentFeedback();
        }
        else if (typeuser == "Buyer") {
            ResetBuyerFeedback();
        }
        if (res[0].PRP_IMAGES != null && res[0].PRP_IMAGES != "," && res[0].PRP_IMAGES != "") {
            var photo='';
            if (res[0].PRP_IMAGES.indexOf(',') > -1)
                photo = res[0].PRP_IMAGES.split(',')[0];
            else
                photo = res[0].PRP_IMAGES;
        }
        else {
            photo = '/img/NoImage.png';
        }

        $("#FB_Popup_Image").attr('src', photo);
        $("#FB_Popup_AddressLineOne").text(res[0].PRP_ADDRESS.split(',')[0]);
        var addr11 = res[0].PRP_ADDRESS.split(',')[1];
        var addr12 = (res[0].PRP_ADDRESS.split(',')[2] != undefined) ? "," + res[0].PRP_ADDRESS.split(',')[2] : "";
        $("#FB_Popup_AddressLineTwo").text(addr11 + "" + addr12);
        $("#" + typeuser + "_feedback_date").text(res[0].Feedback_PostDate);
        $("#" + typeuser + "_feedback_time").text(res[0].Feedback_PostTime);
        $("#FB_Popup_MLSID").text(res[0].MLSID);
        if (res[0].Comment != "")
            $("#" + typeuser + "_Comments").text(res[0].Comment);
        else
            $("#" + typeuser + "_Comments").text('---');
        if (res[0].Reating > 0) {
            for (var i = 1; i <= res[0].Reating; i++)
                $("#" + typeuser + "_View_ratingImage" + i).attr('src', '/img/star_Full.png')
        }
        if (res[0].Top3 == "True") {
            $("#" + typeuser + "_tom31").removeAttr('hidden');
            $("#" + typeuser + "_tom3_1").css('color', '#FF6937');
        }
        else {
            $("#" + typeuser + "_tom32").removeAttr('hidden');
            $("#" + typeuser + "_tom3_2").css('color', '#FF6937');
        }
        $("#" + typeuser + "_PriceCompare" + res[0].PriceCompare).removeAttr('hidden');
        $("#" + typeuser + "_PriceCompare1_" + res[0].PriceCompare).css('color', '#FF6937');
        $("#" + typeuser + "_Exterior" + res[0].Exterior).removeAttr('hidden');
        $("#" + typeuser + "_Exterior1_" + res[0].Exterior).css('color', '#FF6937');
        $("#" + typeuser + "_Interr" + res[0].Interr).removeAttr('hidden');
        $("#" + typeuser + "_Interr1_" + res[0].Interr).css('color', '#FF6937');
        $("#" + typeuser + "_Landscapping" + res[0].Landscapping).removeAttr('hidden');
        $("#" + typeuser + "_Landscapping1_" + res[0].Landscapping).css('color', '#FF6937');
        $("#" + typeuser + "_ConsidiringOffer" + res[0].Landscapping).removeAttr('hidden');
        $("#" + typeuser + "_ConsidiringOffer1_" + res[0].Landscapping).css('color', '#FF6937');
        $("#" + typeuser + "_FeatureToImprove" + res[0].Landscapping).removeAttr('hidden');
        $("#" + typeuser + "_FeatureToImprove1_" + res[0].Landscapping).css('color', '#FF6937');
        $("#AgentPost_Feedback_Popup").modal('show');
    }
    var ratingcount = "0";
    function rating(ratingid, starid) {
        var ImgSrc = $("#" + starid).attr("src");
        if (ratingid == "1") {
            if (ImgSrc == "/img/Star_empty.png") {
                $("#" + starid).attr("src", "/img/star_Full.png");
                starid = starid.substr(0, starid.length - 1) + '2';
                $("#" + starid).attr("src", "/img/Star_empty.png");
                starid = starid.substr(0, starid.length - 1) + '3';
                $("#" + starid).attr("src", "/img/Star_empty.png");
                ratingcount = "1";
            }
            if (ImgSrc == "/img/star_Full.png") {
                var starid2 = starid.substr(0, starid.length - 1) + '2';
                var starid3 = starid.substr(0, starid.length - 1) + '3';
                if ($("#" + starid2).attr('src') == "/img/star_Full.png" || $("#" + starid3).attr('src') == "/img/star_Full.png") {
                    $("#" + starid).attr("src", "/img/star_Full.png");
                    $("#" + starid2).attr("src", "/img/Star_empty.png");

                    $("#" + starid3).attr("src", "/img/Star_empty.png");
                    ratingcount = "1";
                }
                else {
                    $("#" + starid).attr("src", "/img/Star_empty.png");
                    ratingcount = "0";
                }

            }

        }

        else if (ratingid == "2") {
            if (ImgSrc == "/img/Star_empty.png") {
                $("#" + starid).attr("src", "/img/star_Full.png");
                var starid1 = starid.substr(0, starid.length - 1) + '1';
                $("#" + starid1).attr("src", "/img/star_Full.png");
                ratingcount = "2";
            }
            if (ImgSrc == "/img/star_Full.png") {
                var starid1 = starid.substr(0, starid.length - 1) + '1';
                var starid3 = starid.substr(0, starid.length - 1) + '3';
                if ($("#" + starid3).attr('src') == "/img/star_Full.png") {
                    $("#" + starid).attr("src", "/img/star_Full.png");
                    $("#" + starid3).attr("src", "/img/Star_empty.png");
                    ratingcount = "2";
                }
                else {
                    $("#" + starid).attr("src", "/img/Star_empty.png");
                    ratingcount = "1";
                }

            }

        }
        else if (ratingid == "3") {
            if (ImgSrc == "/img/Star_empty.png") {
                $("#" + starid).attr("src", "/img/star_Full.png");
                starid = starid.substr(0, starid.length - 1) + '2';
                $("#" + starid).attr("src", "/img/star_Full.png");
                starid = starid.substr(0, starid.length - 1) + '1';
                $("#" + starid).attr("src", "/img/star_Full.png");
                ratingcount = "3";
            }
            else {
                $("#" + starid).attr("src", "/img/Star_empty.png");
                ratingcount = "2";
            }

        }
    }
    function bindCompletedLists(data) {
        $('#buyerdivinlistings').empty();
        $('#buyerdivinlistings').append(mybuyer);
        var d1 = "", d2 = "", pkey = "";
        $.each(data, function (i, item) {
            var imagepin = "", price = "";
            var bedrooms, bathrooms, sqftAcres;
            var PhotosURL = [], TotalImages = [];
            if (data[0].PRP_IMAGES != null) {
                TotalImages.push(data[i].PRP_IMAGES);
                if (TotalImages.length > 0)
                    PhotosURL = data[i].PRP_IMAGES.split(',');
                else
                    PhotosURL = data[i].PhotoLocation;
            }
            if (data[i].Class == "Rental") {
                price = "$ " + (data[i].PRP_PRICE + "").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,") + "/mo";
                if (data[i].Is_Viewd == "YES")
                    imagepin = '<img src="/img/viewed_graypin.png" height="20" style="position:relative; top:-2px" />'
                else
                    imagepin = '<img src="/img/gray_legendMenu.png" height="20" style="position:relative; top:-2px" />'

            }
            else {
                price = "$ " + (data[i].PRP_PRICE + "").replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,");
                if (data[i].Status == "Sold") {
                    if (data[i].Is_Viewd == "YES")
                        imagepin = '<img src="/img/viewed_redpin.png" height="20" style="position:relative; top:-2px" />'
                    else
                        imagepin = '<img src="/img/red_legendMenu.png" height="20" style="position:relative; top:-2px" />'
                }
                else if (data[i].Status == "Active") {
                    if (data[i].Is_Viewd == "YES")
                        imagepin = '<img src="/img/viewed_greenpin.png" height="20" style="position:relative; top:-2px" />'
                    else
                        imagepin = '<img src="/img/Green_legend_Menu.png" height="20" style="position:relative; top:-2px" />'
                }
                else if (data[i].Status == "Pending") {
                    if (data[i].Is_Viewd == "YES")
                        imagepin = '<img src="/img/yellow_legendMenu.png" height="20" style="position:relative; top:-2px;margin-left: -3px;" />'
                    else
                        imagepin = '<img src="/img/viewed_yellowpin.png" height="20" style="position:relative; top:-2px" />'
                }
            }
            if (data[i].Class == "Lots/Land") {
                sqftAcres = data[i].SQFT + ' acres';
                bedrooms = "--";
                bathrooms = "--";
            }
            else {
                bedrooms = data[i].BEDROOMS;
                bathrooms = data[i].BATHROOMS;
                sqftAcres = data[i].SQFT + ' sqft';
            }
            var feedbackstring = "", fbtext = "", f = "";
            if (i % 2 == 0) {
                feedbackstring = '<div class="col-sm-1"><img src="/img/watchh.png" style="margin-bottom:0;" /></div><div class="col-sm-10"><label class="labelorange">Feedback not sent.</label></div>';
                fbtext = '<a href="#" style="text-decoration:none" data-target="#View_Feedback_Popup" data-toggle="modal">Send Feedback</a>';
                f = ' <div class="col-sm-12" style="line-height:25px;background-color:#fbd9cd;border-radius:3px;bottom:-35px;padding-right:0"><div class="col-sm-8" style="padding:0">' + feedbackstring + '</div>'
                               + '<div class="col-sm-4" style="padding:0;border-radius:3px;background-color:#ff5d26;color:#fff;text-align:center">'
                               + '<label id="feedBackLabel">' + fbtext + '</label></div></div></div>';
            }
            else {
                feedbackstring = '<div class="col-sm-1" style="width:8%"><img src="/img/checkmar_savedPopup.png" style="margin-left: -15px;margin-bottom:0;" /></div><div class="col-sm-7" style="padding:0;width:67%"><label class="labelorange">Feedback sent:&nbsp</label>Wednesday, December 3, 2017</div><div class="col-sm-4" style="padding:0;width:25%"><img src="/img/watchh.png" style="margin-bottom:0;height: 14px;" />&nbsp;10:50 AM</div>';
                fbtext = '<a href="#" style="text-decoration:none" data-target="#View_Feedback_Popup" data-toggle="modal">View</a>';
                f = ' <div class="col-sm-12" style="line-height:25px;background-color:#fbd9cd;border-radius:3px;bottom:-35px;padding-right:0"><div class="col-sm-10" style="padding:0">' + feedbackstring + '</div>'
                              + '<div class="col-sm-2" style="padding:0;border-radius:3px;background-color:#ff5d26;color:#fff;text-align:center">'
                              + '<label id="feedBackLabel">' + fbtext + '</label></div></div></div>';
            }
            var PendingRequests = '<div class="col-sm-12" style="padding: 15px;border-bottom: 2px solid #ff5d26;"><div class="col-sm-2" style="padding:0"><div class="col-sm-12" style="background-color:#ff5d26;color:#fff;text-align:center;border-radius:5px 5px 0 0;padding:0">'
                                + '<img src="/img/clock_icon_closer_white.png" style="margin-left: 4px;margin-bottom:0;float:left;height: 14px;margin-top: 2px;" />10.00 AM to 11.00 AM</div><div class="col-sm-12"  style="height: 90px; position: relative; background-image: url(' + PhotosURL[0] + '); background-size: 100% 100%;"></div></div>'
                              + '<div class="col-sm-3" style="padding-left:25px;top:20px;"><table style="line-height:15px;border-right: 1px solid lightgray;width:100%">'
                              + '<tr><td style="">' + imagepin + '<span id="Rate" style="color:#ff5d26;font-size:16px; font-weight:bold; position:relative; "><span style="position: relative;padding-left:5px">' + price + '</span></span></td></tr>'
                              + '<tr><td style="padding-top:10px"><span id="AddLineOne" style="font-weight:bold">' + data[i].PRP_ADDRESS.split(',')[0] + '</span></td></tr><tr><td style=""><span style="font-size:12px; font-weight:bold">' + data[i].PRP_ADDRESS.split(',')[1] + ', ' + data[i].PRP_ADDRESS.split(',')[2] + '</span></td></tr></tr>'
                              + '<tr><td style="padding-top:5px"><span id="MLSID" style="font-size:12px; font-weight:normal; color:grey">MLS#' + data[i].MLSID + '</span></td></tr></table></div>'
                               + '<div class="col-sm-7"><div class="col-sm-6"><table style="top: 15px; position: relative;">'
                              + '<tr><td><span style="color:#ff5d26;font-weight:bold">' + bedrooms + '</span><span>  Bedrooms</span></td></tr>'
                              + '<tr><td><span style="color:#ff5d26;font-weight:bold">' + bathrooms + '</span><span>  Bathrooms</span></td></tr>'
                              + '<tr><td style="color:#ff5d26;font-weight:bold"><span>' + sqftAcres + '</span><span></span></td></tr>'
                              + '</table></div>'
                              + '<div class="col-sm-3" style="top:20px;"><img src="/img/bell_icon.png" style="margin-bottom:0"/></div>'
                                + '<div class="col-sm-3"><img class="sideArrow" style="top:28px;float: right; position: relative; height:26px;" src="/img/lit_icon_btn.png"></div>'
                                + f;

            if (d1 == "" && d2 == "") {
                var d = '<div class="col-sm-12" style="height:30px;background-color:#686868"><span style="top: 5px; color: rgb(255, 159, 128); position: relative;">Showings Completed on: </span><span style="color:white;position:relative;top:5px; font-size:12px">&nbsp;' + data[i].UserChoice1 + '<label style="color:rgb(255, 159, 128)">&nbsp;or&nbsp;</label>' + data[i].UserChoice2 + '</span></div>';
                d1 = data[i].UserChoice1; d2 = data[i].UserChoice2;
                $('#buyerdivinlistings').append(d + PendingRequests);
            }
            else {
                var d = '<div class="col-sm-12" style="height:30px;background-color:#686868"><span style="top: 5px; color: rgb(255, 159, 128); position: relative;">Showings Completed on: </span><span style="color:white;position:relative;top:5px; font-size:12px">&nbsp;' + data[i].UserChoice1 + '<label style="color:rgb(255, 159, 128)">&nbsp;or&nbsp;</label>' + data[i].UserChoice2 + '</span></div>';
                if (d1 == data[i].UserChoice1 && d2 == data[i].UserChoice2) {
                    $('#buyerdivinlistings').append(PendingRequests);
                    d1 = data[i].UserChoice1; d2 = data[i].UserChoice2;
                }
                else {
                    $('#buyerdivinlistings').append(d + PendingRequests);
                }
            }

        });
    }
    function sourceListings() {
        for (var i = 0; i < 5; i++) {
            var CompleredData = '<div class="col-sm-12" id="' + i + '" style="padding:5px;"><div class="col-sm-2" style="cursor:pointer;background-color:#ff5d26;width:13.5%;line-height:45px;text-align:center;border: 1px solid #ff5d26;border-radius: 5px;margin-right: 5px;padding:0" onclick="return SelectFirstList(' + i + ')"><label style="color:#fff;cursor:pointer;">Select</label></div>'
                + '<div class="col-sm-10"  id="' + i + '" style="padding:0;border:1px solid #ff5d26;border-radius:5px;height:70px">'
                + '<div class="col-sm-2" style="height:68px;width:100px;line-height:15px;border-radius: 4px 0 0 4px;background: url(../../../../img/NoImage.png); background-size: 100% 100%;"></div>'
                + '<div class="col-sm-8" style="padding:10px"><table><tr><td style="color:gray">MLS#' + i + '</td></tr>'
                + '<tr><td style="color:gray">10 Braeburn Drive, Greenville,Sc 20369</td></tr></table></div></div></div>';
            $('#sourcelistings').append(CompleredData);
        }
    }
    function PhoneDetails(phone, fname, lname) {
        $("#PhoneCallModel").modal('show');
        $("#span_name_phonecall").text(fname + " " + lname)
        $("#customer_phone_label").text(phone)
    }
    function getDirections() {
        $.ajax({
            url: "/Agent/AgentShowings/GetDirectionssss",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: "",
            success: function (data) {
            }
        });
    }
    $("#buyer_feedback_tab").click(function () {
        $('#buyer_feedback_a').css('background-color', '#ff5d26');
        $('#buyer_feedback_a').css('color', '#fff');
        $('#agent_feedback_a').css('background-color', '');
        $('#agent_feedback_a').css('color', 'black');
        if (havebuyerFeedback == "YES") {
            if (buyerPref == "False") {
                $('#buyer_errormessage_div_Feedbackpopup').hide();
                $('#buyers_feedback_div_data').show();
            }
            else {
                $('#buyer_errormessage_div_Feedbackpopup').show();
                $('#buyers_feedback_div_data').hide();
            }
             $('#buyer_date_div').show();
             $('#agent_date_div').hide();
        }
        //else {
        //    $('#buyer_date_div').hide();
        //    $('#agent_date_div').hide();
        //}
        //$('#errormessage_div_Feedbackpopup').hide();
        //$('#buyer_feedback_div_data').show();
        $('#done_div').show();
        $('#save_div').hide();
    });
    $("#agent_feedback_tab").click(function () {
        $('#buyer_feedback_a').css('background-color', '');
        $('#buyer_feedback_a').css('color', 'black');
        $('#agent_feedback_a').css('background-color', '#ff5d26');
        $('#agent_feedback_a').css('color', '#fff');
        if (haveagentFeedback == "YES") {
            $('#buyer_date_div').hide();
            $('#agent_date_div').show();
            $('#done_div').show();
            $('#save_div').hide();
        }
        else {
            $('#buyer_date_div').hide();
            $('#agent_date_div').hide();
            $('#done_div').hide();
            $('#save_div').show();
        }
        //if (agent_fb_pkeyid == "YES") {
        //    $('#date_div').show();
        //}
        //else {
        //    $('#date_div').hide();
        //}
        
        //$('#errormessage_div_Feedbackpopup').show();
        //$('#buyer_feedback_div_data').hide();
        //$('#agentcomments').show();
        //$('#buyercomments_div').hide();
    });
    $("#check_prefer").change(function () {
        if ($(this).is(':checked')) {
            $('#agent_post_feedback_div_data').hide();
        }
        else {
            $('#agent_post_feedback_div_data').show();
        }
    });
    $("#btn_Post_Feedback").click(function () {
        var feedbackObj = [
            AgentId,
        $("#hidden_requestshowing_Id").text(),
        $("#FB_Popup_MLSID").text(),
         $("#Showings_feddback_comments").val(),
       $('input[name=HoemRating]:checked').val(),
         ratingcount,
       $('input[name=PriceCompare]:checked').val(),
       $('input[name=Exterior]:checked').val(),
       $('input[name=Interior]:checked').val(),
       $('input[name=Land_Scaping]:checked').val(),
       $('input[name=Offer]:checked').val(),
       $('input[name=Features]:checked').val(),
       $('check_prefer').is(':checked'),
        ];
       // alert(feedbackObj)
        $.ajax({
            url: "/Agent/AgentShowings/AgentPostFeedback",
            type: "POST",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(feedbackObj),
            success: function (res) {
                if (res == "Success") {
                    $("#AgentPost_Feedback_Popup").modal('hide');
                    $("#ThankyouAlertPopup_Feedback").modal("show");
                }
                else {
                    alert("Error :" + res);
                }
            },
        });
    });
    $("#thanksalertOKbtn").click(function () {
        GetAgentListings(buyerid, 'Completed');
    })
    //function to rest the Feedback popup buttons
    function ResetAgentFeedback() {
        $("#FB_Popup_Image").attr('src', '/img/NoImage.png');
        $("#FB_Popup_AddressLineOne").text('');
        $("#FB_Popup_AddressLineTwo").text('');
        $("#FB_Popup_MLSID").text("MLS#");
        $("#Agent_feedback_date").text('');
        $("#Agent_feedback_time").text('');
        for (var i = 0; i < 4; i++) {
            $("#Agent_tom3" + i).prop('hidden', 'hidden');
            $("#Agent_View_ratingImage" + i).attr('src', '/img/Star_empty.png');
            $("#Agent_PriceCompare" + i).prop('hidden', 'hidden');
            $("#Agent_PriceCompare1_" + i).css('color', 'black');
            $("#Agent_Exterior" + i).prop('hidden', 'hidden');
            $("#Agent_Exterior1_" + i).css('color', 'black');
            $("#Agent_Interr" + i).prop('hidden', 'hidden');
            $("#Agent_Interr1_" + i).css('color', 'black');
            $("#Agent_Landscapping" + i).prop('hidden', 'hidden');
            $("#Agent_Landscapping1_" + i).css('color', 'black');
            $("#Agent_ConsidiringOffer" + i).prop('hidden', 'hidden');
            $("#Agent_ConsidiringOffer1_" + i).css('color', 'black');
            $("#Agent_FeatureToImprove" + i).prop('hidden', 'hidden');
            $("#Agent_FeatureToImprove1_" + i).css('color', 'black');
        }
    }
    function ResetBuyerFeedback() {
        $("#FB_Popup_Image").attr('src', '/img/NoImage.png');
        $("#FB_Popup_AddressLineOne").text('');
        $("#FB_Popup_AddressLineTwo").text('');
        $("#FB_Popup_MLSID").text("MLS#");
        $("#Buyer_feedback_date").text('');
        $("#Buyer_feedback_time").text('');
        for (var i = 0; i < 4; i++) {
            $("#Buyer_tom3" + i).prop('hidden', 'hidden');
            $("#Buyer_View_ratingImage" + i).attr('src', '/img/Star_empty.png');
            $("#Buyer_PriceCompare" + i).prop('hidden', 'hidden');
            $("#Buyer_PriceCompare1_" + i).css('color', 'black');
            $("#Buyer_Exterior" + i).prop('hidden', 'hidden');
            $("#Buyer_Exterior1_" + i).css('color', 'black');
            $("#Buyer_Interr" + i).prop('hidden', 'hidden');
            $("#Buyer_Interr1_" + i).css('color', 'black');
            $("#Buyer_Landscapping" + i).prop('hidden', 'hidden');
            $("#Buyer_Landscapping1_" + i).css('color', 'black');
            $("#Buyer_ConsidiringOffer" + i).prop('hidden', 'hidden');
            $("#Buyer_ConsidiringOffer1_" + i).css('color', 'black');
            $("#Buyer_FeatureToImprove" + i).prop('hidden', 'hidden');
            $("#Buyer_FeatureToImprove1_" + i).css('color', 'black');
        }
    }
    function editComments() {
        var $div = $('#Buyer_Comments');
        var isEditable = $('#Buyer_Comments').is('.editable');
        $('#Buyer_Comments').prop('contenteditable', !isEditable).toggleClass('editable')
        $('#Buyer_Comments').addClass('commentsdiv')
        $("#editDiv").addClass('editdivclass')
        $("#saveDiv").css("pointer-events", "auto");
    }
    function saveComments() {
        var $div = $('#Buyer_Comments');
        var isEditable = $('#Buyer_Comments').is('.editable');
        $('#Buyer_Comments').prop('contenteditable', !isEditable).toggleClass('editable')
        $('#Buyer_Comments').removeClass('commentsdiv');
        $("#editDiv").removeClass('editdivclass');
        $("#saveDiv").css("pointer-events", "none");
        //alert(buyer_PK_Reqid + "      " + $("#Buyer_Comments").text())
        $.ajax({
            url: "/Agent/AgentShowings/AgentEdit_SaveBuyerComments",
            type: "GET",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: { buyer_FBPkey: buyer_PK_Reqid, edited_Comments: $("#Buyer_Comments").text() },
            success: function (res) {
                if (res == "Success") {
                    $("#CommentsSaved_Popup").modal('show');
                   // GetAgentListings(buyerid, 'Completed');
                }
                else {
                    alert("Error :" + res);
                }
            },
        });
    }
    $("#commentsSavedOKbtn").click(function () {
        GetAgentListings(buyerid, 'Completed');
    })
    //Function to get Directions to Listing from your location
    function showDirections(addr) {
        var street = "https://www.google.com/maps/dir/?api=1&destination=" + addr + "&travelmode=drving";
        window.open(street, '_blank');
    }
</script>
